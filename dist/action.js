const _0x321370=_0x10c5;(function(_0x2bd19d,_0x454216){const _0x49f5d3=_0x10c5,_0x59e912=_0x2bd19d();while(!![]){try{const _0x2d5132=parseInt(_0x49f5d3(0x132))/0x1*(-parseInt(_0x49f5d3(0x2ae))/0x2)+-parseInt(_0x49f5d3(0x1a7))/0x3+-parseInt(_0x49f5d3(0x135))/0x4*(-parseInt(_0x49f5d3(0xd1))/0x5)+parseInt(_0x49f5d3(0x290))/0x6+parseInt(_0x49f5d3(0x15e))/0x7*(-parseInt(_0x49f5d3(0xbc))/0x8)+parseInt(_0x49f5d3(0x2ab))/0x9*(-parseInt(_0x49f5d3(0x104))/0xa)+parseInt(_0x49f5d3(0x257))/0xb*(parseInt(_0x49f5d3(0x160))/0xc);if(_0x2d5132===_0x454216)break;else _0x59e912['push'](_0x59e912['shift']());}catch(_0x1582d5){_0x59e912['push'](_0x59e912['shift']());}}}(_0x2ff9,0xe6c4e));const _0x27f6d8=(function(){let _0x29f98d=!![];return function(_0x44ef9a,_0x4fe40a){const _0x27dcb8=_0x29f98d?function(){if(_0x4fe40a){const _0x4fc44b=_0x4fe40a['apply'](_0x44ef9a,arguments);return _0x4fe40a=null,_0x4fc44b;}}:function(){};return _0x29f98d=![],_0x27dcb8;};}()),_0x405282=_0x27f6d8(this,function(){const _0x422098=_0x10c5;return _0x405282['toString']()[_0x422098(0x2b2)]('(((.+)+)+)+$')[_0x422098(0x1d4)]()['constructor'](_0x405282)['search']('(((.+)+)+)+$');});_0x405282();let imagePreviewCanvas=document['getElementById'](_0x321370(0x1f6)),imagePreviewCtx=imagePreviewCanvas?imagePreviewCanvas[_0x321370(0x13d)]('2d'):null,originalPreviewCanvas=document[_0x321370(0x1af)](_0x321370(0xee)),originalPreviewCtx=originalPreviewCanvas?originalPreviewCanvas[_0x321370(0x13d)]('2d'):null,flipHorizontalPreviewCanvas=document[_0x321370(0x1af)](_0x321370(0x11e)),flipHorizontalPreviewCtx=flipHorizontalPreviewCanvas?flipHorizontalPreviewCanvas[_0x321370(0x13d)]('2d'):null,flipVerticalPreviewCanvas=document[_0x321370(0x1af)](_0x321370(0x10a)),flipVerticalPreviewCtx=flipVerticalPreviewCanvas?flipVerticalPreviewCanvas[_0x321370(0x13d)]('2d'):null,flipBothPreviewCanvas=document[_0x321370(0x1af)](_0x321370(0xdc)),flipBothPreviewCtx=flipBothPreviewCanvas?flipBothPreviewCanvas['getContext']('2d'):null,moduleInfo=document[_0x321370(0x1af)](_0x321370(0x277)),isImageModuleRangeMoving=![],cropStartX=0x0,cropStartY=0x0,isCropping=![],cropLeft=0x0,cropTop=0x0,cropWidth=0x0,cropHeight=0x0,currentImage=null,currentImageId=null,previewImage=null,previewImageId=null,imageManager=null,zoomLevel=0x1,zoomCenterX=0x0,zoomCenterY=0x0,previewZoomLevel=0x1,showPreviewWithMouse=![],selectedTransformation=_0x321370(0xf8),mouseXOnCanvas=0x0,mouseYOnCanvas=0x0,resizeMode=null,initialLeft=0x0,initialTop=0x0,initialWidth=0x0,initialHeight=0x0,currentProject=null,currentSprite=null,currentAnim=null,currentFrame=null,currentFrameIndex=0x0,selectedModuleIndex=-0x1,selectedModuleIndices=[],isDragging=![],dragStartX=0x0,dragStartY=0x0,isMarqueeSelecting=![],marqueeStartX=0x0,marqueeStartY=0x0,marqueeEndX=0x0,marqueeEndY=0x0,editMode=_0x321370(0x1c1),selectedImageModule=-0x1,isCtrlPressed=![],isPlaying=![],animationSpeed=0x64,lastFrameTime=0x0,animationFrameId=null,selectedImageModules=[],dragStartModuleStates=[],currentTab=_0x321370(0x116),isMultiDragging=![],copiedModuleInfo=null,copiedModuleInfos=null,showGrid=!![];const gridSize=0x14,gridColor='#e0e0e0';let m_imageOriginPos={'x':0x0,'y':0x0};CommandManager[_0x321370(0x24d)]=new CommandManager();function resizeCanvas(){const _0x5e2f11=_0x321370,_0x360645=canvas[_0x5e2f11(0x29f)],_0x3f906d=_0x360645['clientWidth'],_0x2859d3=_0x360645['clientHeight'];canvas[_0x5e2f11(0x155)]=_0x3f906d,canvas[_0x5e2f11(0x246)]=_0x2859d3;}let imageModuleOriginPos={'x':0x0,'y':0x0};function debugCanvasState(){const _0x3948ce=_0x321370;console[_0x3948ce(0x2a2)]('====\x20Canvas状态检查\x20===='),console[_0x3948ce(0x2a2)](_0x3948ce(0x1ce),currentSprite?'存在':_0x3948ce(0x262)),console[_0x3948ce(0x2a2)](_0x3948ce(0x1de),currentImageId),console[_0x3948ce(0x2a2)](_0x3948ce(0x106),currentImage?currentImage['src']||_0x3948ce(0x1e6):_0x3948ce(0x262)),console[_0x3948ce(0x2a2)](_0x3948ce(0x206),imagePreviewCanvas?'存在':_0x3948ce(0x262)),console['log'](_0x3948ce(0x154),imagePreviewCtx?'存在':'不存在');const _0x5b4e2e=document[_0x3948ce(0x1af)]('image-dropdown');console[_0x3948ce(0x2a2)](_0x3948ce(0x174),_0x5b4e2e?'存在':_0x3948ce(0x262));const _0xe265b5=document[_0x3948ce(0x1af)](_0x3948ce(0x1f6));console[_0x3948ce(0x2a2)](_0x3948ce(0x1fd),_0xe265b5?'存在':_0x3948ce(0x262)),_0xe265b5&&console[_0x3948ce(0x2a2)]('canvas尺寸:',_0xe265b5[_0x3948ce(0x155)]+'x'+_0xe265b5[_0x3948ce(0x246)]),currentSprite&&currentSprite[_0x3948ce(0x264)]&&(console[_0x3948ce(0x2a2)]('sprite中的图片数量:',currentSprite[_0x3948ce(0x264)][_0x3948ce(0x145)]),currentSprite[_0x3948ce(0x264)][_0x3948ce(0x145)]>0x0&&console[_0x3948ce(0x2a2)](_0x3948ce(0x224),currentSprite[_0x3948ce(0x264)][0x0][_0x3948ce(0x251)]+_0x3948ce(0x25a)+currentSprite[_0x3948ce(0x264)][0x0]['id']+')')),console[_0x3948ce(0x2a2)](_0x3948ce(0x10b));}function clearClickPreviewTransform(){const _0x112932=_0x321370,_0x463999=document['querySelectorAll'](_0x112932(0xf4));_0x463999[_0x112932(0x118)](_0x13c87e=>_0x13c87e[_0x112932(0xe5)]['border']=_0x112932(0x230));}function renderImagePreview(_0x2f7364=-0x1){const _0x5b590c=_0x321370;_0x2f7364!==-0x1&&console[_0x5b590c(0x2a2)](_0x5b590c(0x296),_0x2f7364);if(!previewImage||!imagePreviewCanvas||!imagePreviewCtx){console[_0x5b590c(0x1b1)](_0x5b590c(0x17b));return;}const _0x4972ad=imagePreviewCanvas['parentElement'];!imagePreviewCanvas[_0x5b590c(0x238)][_0x5b590c(0x1ae)]&&(imagePreviewCanvas[_0x5b590c(0x155)]=_0x4972ad[_0x5b590c(0x15c)]-0x14,imagePreviewCanvas[_0x5b590c(0x246)]=0x12c,imagePreviewCanvas[_0x5b590c(0x238)][_0x5b590c(0x1ae)]='true');imagePreviewCtx['clearRect'](0x0,0x0,imagePreviewCanvas[_0x5b590c(0x155)],imagePreviewCanvas[_0x5b590c(0x246)]),imagePreviewCanvas['style']['border']=_0x5b590c(0x1e4),imagePreviewCanvas[_0x5b590c(0xe5)][_0x5b590c(0x1b0)]=_0x5b590c(0x27d),imagePreviewCanvas['style']['backgroundColor']='#f0f0f0',imagePreviewCanvas['style'][_0x5b590c(0x1cb)]=_0x5b590c(0x21b),imagePreviewCanvas[_0x5b590c(0xe5)][_0x5b590c(0x194)]=_0x5b590c(0x12b),imagePreviewCanvas[_0x5b590c(0xe5)]['opacity']='1';const _0x549c19=(imagePreviewCanvas[_0x5b590c(0x155)]-previewImage[_0x5b590c(0x155)]*previewZoomLevel)/0x2,_0x3198bf=0x14,_0x169994=previewImage[_0x5b590c(0x155)]*previewZoomLevel,_0x2028f0=previewImage[_0x5b590c(0x246)]*previewZoomLevel;imagePreviewCtx['drawImage'](previewImage,0x0,0x0,previewImage['width'],previewImage[_0x5b590c(0x246)],_0x549c19,_0x3198bf,_0x169994,_0x2028f0);if(currentSprite&&previewImageId){const _0x20e934=currentSprite['getImage'](previewImageId);if(_0x20e934){if(_0x20e934[_0x5b590c(0x1cc)])_0x20e934[_0x5b590c(0x1cc)][_0x5b590c(0x118)]((_0xbf0731,_0x12fb23)=>{const _0x2b0b8f=_0x5b590c;imagePreviewCtx[_0x2b0b8f(0x1a4)]=_0x12fb23===selectedImageModule?_0x2b0b8f(0x19d):_0x2b0b8f(0x1fe),imagePreviewCtx['lineWidth']=_0x12fb23===selectedImageModule?0x3:0x2,imagePreviewCtx[_0x2b0b8f(0xea)](_0x549c19+_0xbf0731['x']*previewZoomLevel,_0x3198bf+_0xbf0731['y']*previewZoomLevel,_0xbf0731[_0x2b0b8f(0x155)]*previewZoomLevel,_0xbf0731[_0x2b0b8f(0x246)]*previewZoomLevel),imagePreviewCtx[_0x2b0b8f(0xc4)]='rgba(255,\x20255,\x20255,\x200.9)',imagePreviewCtx['fillRect'](_0x549c19+_0xbf0731['x']*previewZoomLevel,_0x3198bf+_0xbf0731['y']*previewZoomLevel,0x14,0x14),imagePreviewCtx[_0x2b0b8f(0xc4)]=_0x2b0b8f(0x108),imagePreviewCtx[_0x2b0b8f(0x12f)]=_0x2b0b8f(0x10c),imagePreviewCtx['fillText'](''+(_0x12fb23+0x1),_0x549c19+_0xbf0731['x']*previewZoomLevel+0x5,_0x3198bf+_0xbf0731['y']*previewZoomLevel+0x10);});else{}}else{}}else{}notification('图片选择！');}function notification(_0x27140b){const _0x3f8160=_0x321370,_0x3ee1af=document[_0x3f8160(0x255)]('div');_0x3ee1af[_0x3f8160(0x146)]=_0x27140b,_0x3ee1af[_0x3f8160(0xe5)]['cssText']=_0x3f8160(0x105),document[_0x3f8160(0x235)][_0x3f8160(0x1ff)](_0x3ee1af),setTimeout(()=>{const _0x42e5ff=_0x3f8160;_0x3ee1af[_0x42e5ff(0x1dd)]();},0xbb8);}function handlePreviewCanvasClick(_0x4a57ab){const _0x319d1b=_0x321370;if(!currentSprite||!previewImage)return;const _0x21f077=imagePreviewCanvas[_0x319d1b(0xd8)](),_0x433f7e=_0x4a57ab[_0x319d1b(0x1f9)]-_0x21f077['left'],_0x46facf=_0x4a57ab['clientY']-_0x21f077[_0x319d1b(0xe1)],_0x1d58dd=currentSprite['getImage'](previewImageId);if(!_0x1d58dd||!_0x1d58dd[_0x319d1b(0x1cc)])return;const _0x25a306=(imagePreviewCanvas['width']-previewImage[_0x319d1b(0x155)]*previewZoomLevel)/0x2,_0x45b1f7=0x14;let _0x143365=-0x1;for(let _0x5225b1=_0x1d58dd[_0x319d1b(0x1cc)]['length']-0x1;_0x5225b1>=0x0;_0x5225b1--){const _0x988d09=_0x1d58dd['modulesList'][_0x5225b1],_0x56be05=_0x25a306+_0x988d09['x']*previewZoomLevel,_0x618f66=_0x45b1f7+_0x988d09['y']*previewZoomLevel,_0x5be971=_0x988d09[_0x319d1b(0x155)]*previewZoomLevel,_0x3e388a=_0x988d09['height']*previewZoomLevel;if(_0x433f7e>=_0x56be05&&_0x433f7e<=_0x56be05+_0x5be971&&_0x46facf>=_0x618f66&&_0x46facf<=_0x618f66+_0x3e388a){_0x143365=_0x5225b1;break;}}_0x143365!==-0x1?(selectedImageModule=_0x143365,showPreviewWithMouse=!![],document[_0x319d1b(0x1af)](_0x319d1b(0x278))['style'][_0x319d1b(0x1b0)]=_0x319d1b(0x289),renderTransformationPreviews(_0x1d58dd,_0x143365)):(selectedImageModule=-0x1,showPreviewWithMouse=![],document[_0x319d1b(0x1af)](_0x319d1b(0x278))['style']['display']='none'),renderImagePreview();}function updateMousePosition(_0x3504bb){const _0x4d1e67=_0x321370,_0x2b5adc=imagePreviewCanvas[_0x4d1e67(0xd8)](),_0x3038e1=imagePreviewCanvas[_0x4d1e67(0x155)]/_0x2b5adc[_0x4d1e67(0x155)];mouseXOnCanvas=(_0x3504bb[_0x4d1e67(0x1f9)]-_0x2b5adc[_0x4d1e67(0x283)])*_0x3038e1,mouseYOnCanvas=(_0x3504bb[_0x4d1e67(0x28f)]-_0x2b5adc[_0x4d1e67(0xe1)])*_0x3038e1;}function renderTransformationPreviews(_0x54446f,_0x56dc1c){const _0x13f341=_0x321370;if(!_0x54446f||!_0x54446f[_0x13f341(0x1e8)]||_0x56dc1c<0x0||_0x56dc1c>=_0x54446f[_0x13f341(0x1cc)][_0x13f341(0x145)])return;const _0x451a7d=_0x54446f[_0x13f341(0x1cc)][_0x56dc1c],_0x33830a=Math[_0x13f341(0x1e9)](0x3c/_0x451a7d[_0x13f341(0x155)],0x3c/_0x451a7d[_0x13f341(0x246)]),_0x4711d9=_0x451a7d[_0x13f341(0x155)]*_0x33830a,_0x40af94=_0x451a7d[_0x13f341(0x246)]*_0x33830a;originalPreviewCtx&&originalPreviewCtx[_0x13f341(0x25b)](0x0,0x0,0x3c,0x3c);flipHorizontalPreviewCtx&&flipHorizontalPreviewCtx[_0x13f341(0x25b)](0x0,0x0,0x3c,0x3c);flipVerticalPreviewCtx&&flipVerticalPreviewCtx[_0x13f341(0x25b)](0x0,0x0,0x3c,0x3c);flipBothPreviewCtx&&flipBothPreviewCtx[_0x13f341(0x25b)](0x0,0x0,0x3c,0x3c);const _0x1efbbd=(0x3c-_0x4711d9)/0x2,_0x5a1e13=(0x3c-_0x40af94)/0x2;originalPreviewCtx&&originalPreviewCtx[_0x13f341(0x14f)](_0x54446f['image'],_0x451a7d['x'],_0x451a7d['y'],_0x451a7d[_0x13f341(0x155)],_0x451a7d['height'],_0x1efbbd,_0x5a1e13,_0x4711d9,_0x40af94),flipHorizontalPreviewCtx&&(flipHorizontalPreviewCtx[_0x13f341(0x10d)](),flipHorizontalPreviewCtx[_0x13f341(0x21e)](0x3c,0x0),flipHorizontalPreviewCtx[_0x13f341(0x27e)](-0x1,0x1),flipHorizontalPreviewCtx[_0x13f341(0x14f)](_0x54446f['image'],_0x451a7d['x'],_0x451a7d['y'],_0x451a7d[_0x13f341(0x155)],_0x451a7d[_0x13f341(0x246)],_0x1efbbd,_0x5a1e13,_0x4711d9,_0x40af94),flipHorizontalPreviewCtx[_0x13f341(0x1d5)]()),flipVerticalPreviewCtx&&(flipVerticalPreviewCtx[_0x13f341(0x10d)](),flipVerticalPreviewCtx[_0x13f341(0x21e)](0x0,0x3c),flipVerticalPreviewCtx[_0x13f341(0x27e)](0x1,-0x1),flipVerticalPreviewCtx['drawImage'](_0x54446f[_0x13f341(0x1e8)],_0x451a7d['x'],_0x451a7d['y'],_0x451a7d[_0x13f341(0x155)],_0x451a7d['height'],_0x1efbbd,_0x5a1e13,_0x4711d9,_0x40af94),flipVerticalPreviewCtx[_0x13f341(0x1d5)]()),flipBothPreviewCtx&&(flipBothPreviewCtx[_0x13f341(0x10d)](),flipBothPreviewCtx[_0x13f341(0x21e)](0x3c,0x3c),flipBothPreviewCtx[_0x13f341(0x27e)](-0x1,-0x1),flipBothPreviewCtx[_0x13f341(0x14f)](_0x54446f[_0x13f341(0x1e8)],_0x451a7d['x'],_0x451a7d['y'],_0x451a7d['width'],_0x451a7d[_0x13f341(0x246)],_0x1efbbd,_0x5a1e13,_0x4711d9,_0x40af94),flipBothPreviewCtx[_0x13f341(0x1d5)]());}function addModuleToFrame(_0x227e84){const _0xc8e96c=_0x321370;if(isEditingExpressionRect)return;console['log'](_0xc8e96c(0x27c),!currentFrame),console[_0xc8e96c(0x2a2)](_0xc8e96c(0x1de),previewImageId),console[_0xc8e96c(0x2a2)](_0xc8e96c(0x165),selectedImageModule);if(!currentFrame||!currentSprite||!previewImageId||selectedImageModule===-0x1)return;const [_0x1739f4,_0x5c91d8]=getCurrentXY(_0x227e84);console[_0xc8e96c(0x2a2)](_0xc8e96c(0x1b7),_0x1739f4,_0x5c91d8);const _0x2a8f79=currentSprite['getImage'](previewImageId);if(!_0x2a8f79||!_0x2a8f79[_0xc8e96c(0x1cc)]||selectedImageModule>=_0x2a8f79[_0xc8e96c(0x1cc)][_0xc8e96c(0x145)])return;const _0x4a6b4e=new Module(previewImageId,selectedImageModule),_0x3ac808=new FrameModule(_0x4a6b4e,_0x1739f4,_0x5c91d8);if(selectedTransformation===_0xc8e96c(0x178))_0x3ac808['flag']=0x1;else{if(selectedTransformation===_0xc8e96c(0x24f))_0x3ac808['flag']=0x2;else selectedTransformation===_0xc8e96c(0x16a)&&(_0x3ac808[_0xc8e96c(0x23b)]=0x3);}currentFrame[_0xc8e96c(0x23d)](_0x3ac808),showPreviewWithMouse=![],clearClickPreviewTransform(),renderCanvas();}function drawMouseFollowPreview(_0x5295e1){const _0x5510d1=_0x321370;if(currentTab!==_0x5510d1(0x116)||!showPreviewWithMouse||!currentSprite||!previewImageId||selectedImageModule===-0x1)return;const _0x1be0f4=currentSprite[_0x5510d1(0x182)](previewImageId);if(!_0x1be0f4||!_0x1be0f4['image']||selectedImageModule>=_0x1be0f4['modulesList'][_0x5510d1(0x145)]){console[_0x5510d1(0x2a2)](_0x5510d1(0x11d));return;}const _0x47fd1f=_0x1be0f4[_0x5510d1(0x1cc)][selectedImageModule];_0x5295e1[_0x5510d1(0x10d)](),_0x5295e1[_0x5510d1(0x21e)](mouseXOnCanvas,mouseYOnCanvas);if(selectedTransformation===_0x5510d1(0x178))_0x5295e1[_0x5510d1(0x27e)](-0x1,0x1);else selectedTransformation===_0x5510d1(0x24f)&&_0x5295e1[_0x5510d1(0x27e)](0x1,-0x1);_0x5295e1[_0x5510d1(0x20c)]=0.7,_0x5295e1[_0x5510d1(0x14f)](_0x1be0f4[_0x5510d1(0x1e8)],_0x47fd1f['x'],_0x47fd1f['y'],_0x47fd1f['width'],_0x47fd1f['height'],0x0,0x0,_0x47fd1f[_0x5510d1(0x155)],_0x47fd1f['height']),_0x5295e1[_0x5510d1(0x1d5)]();}function drawCurrentImage(){const _0x5ae732=_0x321370;if(!currentImage)return;imageCtx[_0x5ae732(0x25b)](0x0,0x0,imageCanvas[_0x5ae732(0x155)],imageCanvas['height']);const _0x2201cf=(imageCanvas[_0x5ae732(0x155)]-currentImage['width']*zoomLevel)/0x2,_0x1fa2ad=(imageCanvas['height']-currentImage[_0x5ae732(0x246)]*zoomLevel)/0x2,_0x4e3d50=currentImage[_0x5ae732(0x155)]*zoomLevel,_0x1bd3f4=currentImage[_0x5ae732(0x246)]*zoomLevel;zoomCenterX=imageCanvas[_0x5ae732(0x155)]/0x2,zoomCenterY=imageCanvas[_0x5ae732(0x246)]/0x2,imageModuleOriginPos['x']=imageCanvas[_0x5ae732(0x155)]/0x2,imageModuleOriginPos['y']=imageCanvas[_0x5ae732(0x246)]/0x2;if(showGrid){imageCtx[_0x5ae732(0x1a4)]=gridColor,imageCtx[_0x5ae732(0x140)]=0x1,imageCtx[_0x5ae732(0x24a)]();for(let _0x6173b0=0x0;_0x6173b0<=imageCanvas[_0x5ae732(0x155)];_0x6173b0+=gridSize){imageCtx[_0x5ae732(0x109)](_0x6173b0,0x0),imageCtx[_0x5ae732(0x25c)](_0x6173b0,imageCanvas[_0x5ae732(0x246)]);}imageCtx[_0x5ae732(0x241)](),imageCtx['beginPath']();for(let _0x23913c=0x0;_0x23913c<=imageCanvas['height'];_0x23913c+=gridSize){imageCtx['moveTo'](0x0,_0x23913c),imageCtx['lineTo'](imageCanvas['width'],_0x23913c);}imageCtx['stroke']();}imageCtx['strokeStyle']=_0x5ae732(0xbd),imageCtx[_0x5ae732(0x140)]=0x1,imageCtx[_0x5ae732(0x167)]([0x5,0x5]),imageCtx[_0x5ae732(0x24a)](),imageCtx[_0x5ae732(0x109)](0x0,imageModuleOriginPos['y']),imageCtx[_0x5ae732(0x25c)](imageCanvas[_0x5ae732(0x155)],imageModuleOriginPos['y']),imageCtx[_0x5ae732(0x241)](),imageCtx[_0x5ae732(0x24a)](),imageCtx[_0x5ae732(0x109)](imageModuleOriginPos['x'],0x0),imageCtx[_0x5ae732(0x25c)](imageModuleOriginPos['x'],imageCanvas[_0x5ae732(0x246)]),imageCtx[_0x5ae732(0x241)](),imageCtx[_0x5ae732(0x167)]([]),imageCtx[_0x5ae732(0x1a4)]=_0x5ae732(0x1f1),imageCtx[_0x5ae732(0x140)]=0x1,imageCtx[_0x5ae732(0x24a)](),imageCtx['moveTo'](imageModuleOriginPos['x']-0x8,imageModuleOriginPos['y']),imageCtx[_0x5ae732(0x25c)](imageModuleOriginPos['x']+0x8,imageModuleOriginPos['y']),imageCtx[_0x5ae732(0x109)](imageModuleOriginPos['x'],imageModuleOriginPos['y']-0x8),imageCtx[_0x5ae732(0x25c)](imageModuleOriginPos['x'],imageModuleOriginPos['y']+0x8),imageCtx['stroke'](),imageCtx[_0x5ae732(0x14f)](currentImage,0x0,0x0,currentImage['width'],currentImage[_0x5ae732(0x246)],_0x2201cf,_0x1fa2ad,_0x4e3d50,_0x1bd3f4),drawSelectedModules();if(editMode===_0x5ae732(0x1c1)){if(isCropping&&cropWidth>0x0&&cropHeight>0x0){const _0x2c18f8=_0x2201cf+cropLeft*zoomLevel,_0x9d9948=_0x1fa2ad+cropTop*zoomLevel,_0x171f51=cropWidth*zoomLevel,_0x59f669=cropHeight*zoomLevel;imageCtx['strokeStyle']=_0x5ae732(0x240),imageCtx[_0x5ae732(0x140)]=0x2,imageCtx[_0x5ae732(0xea)](_0x2c18f8,_0x9d9948,_0x171f51,_0x59f669),imageCtx[_0x5ae732(0xc4)]='rgba(0,\x20128,\x20255,\x200.1)',imageCtx[_0x5ae732(0x172)](_0x2c18f8,_0x9d9948,_0x171f51,_0x59f669),drawCropHandles(_0x2c18f8,_0x9d9948,_0x171f51,_0x59f669);}}else{if(editMode==='edit'){const _0x5c047c=currentSprite[_0x5ae732(0x182)](currentImageId);_0x5c047c&&_0x5c047c[_0x5ae732(0x1cc)]&&_0x5c047c['modulesList']['forEach']((_0x3d6542,_0xd673ab)=>{const _0x154e4a=_0x5ae732,_0x224ac2=_0x2201cf+_0x3d6542['x']*zoomLevel,_0x1b36b6=_0x1fa2ad+_0x3d6542['y']*zoomLevel,_0x2c9480=_0x3d6542[_0x154e4a(0x155)]*zoomLevel,_0x36378a=_0x3d6542['height']*zoomLevel;_0xd673ab===selectedImageModule?(imageCtx[_0x154e4a(0x1a4)]=_0x154e4a(0x1a3),imageCtx[_0x154e4a(0x140)]=0x2,imageCtx[_0x154e4a(0xea)](_0x224ac2,_0x1b36b6,_0x2c9480,_0x36378a),imageCtx[_0x154e4a(0xc4)]='rgba(0,\x20255,\x200,\x200.1)',imageCtx[_0x154e4a(0x172)](_0x224ac2,_0x1b36b6,_0x2c9480,_0x36378a),drawCropHandles(_0x224ac2,_0x1b36b6,_0x2c9480,_0x36378a)):(imageCtx[_0x154e4a(0x1a4)]=_0x154e4a(0x220),imageCtx[_0x154e4a(0x140)]=0x1,imageCtx[_0x154e4a(0xea)](_0x224ac2,_0x1b36b6,_0x2c9480,_0x36378a));});}}drawMouseFollowPreview(imageCtx);}function drawCropHandles(_0x1e2c13,_0x1c36b4,_0x4d852d,_0x36f5b6){const _0x3f459f=_0x321370,_0x3af4fb=0x6,_0x565048=_0x3f459f(0xbf);imageCtx[_0x3f459f(0xc4)]=_0x565048,imageCtx[_0x3f459f(0x172)](_0x1e2c13-_0x3af4fb/0x2,_0x1c36b4-_0x3af4fb/0x2,_0x3af4fb,_0x3af4fb),imageCtx[_0x3f459f(0x172)](_0x1e2c13+_0x4d852d-_0x3af4fb/0x2,_0x1c36b4-_0x3af4fb/0x2,_0x3af4fb,_0x3af4fb),imageCtx['fillRect'](_0x1e2c13-_0x3af4fb/0x2,_0x1c36b4+_0x36f5b6-_0x3af4fb/0x2,_0x3af4fb,_0x3af4fb),imageCtx['fillRect'](_0x1e2c13+_0x4d852d-_0x3af4fb/0x2,_0x1c36b4+_0x36f5b6-_0x3af4fb/0x2,_0x3af4fb,_0x3af4fb),imageCtx[_0x3f459f(0x172)](_0x1e2c13-_0x3af4fb/0x2,_0x1c36b4+_0x36f5b6/0x2-_0x3af4fb/0x2,_0x3af4fb,_0x3af4fb),imageCtx[_0x3f459f(0x172)](_0x1e2c13+_0x4d852d-_0x3af4fb/0x2,_0x1c36b4+_0x36f5b6/0x2-_0x3af4fb/0x2,_0x3af4fb,_0x3af4fb),imageCtx[_0x3f459f(0x172)](_0x1e2c13+_0x4d852d/0x2-_0x3af4fb/0x2,_0x1c36b4-_0x3af4fb/0x2,_0x3af4fb,_0x3af4fb),imageCtx[_0x3f459f(0x172)](_0x1e2c13+_0x4d852d/0x2-_0x3af4fb/0x2,_0x1c36b4+_0x36f5b6-_0x3af4fb/0x2,_0x3af4fb,_0x3af4fb);}function handleZoomIn(){const _0x46f737=_0x321370;zoomLevel=Math[_0x46f737(0x1e9)](zoomLevel+0.1,0x5),updateZoomLevel(),currentTab==='animation'?renderCanvas():drawCurrentImage();}function handleZoomOut(){const _0x1caa26=_0x321370;zoomLevel=Math[_0x1caa26(0x227)](zoomLevel-0.1,0.1),updateZoomLevel(),currentTab===_0x1caa26(0x116)?renderCanvas():drawCurrentImage();}function handleZoomReset(){zoomLevel=0x1,updateZoomLevel(),!isDraggingOrigin&&updateImageOriginPos(),currentTab==='animation'?renderCanvas():drawCurrentImage();}function updateImageOriginPos(){const _0x15c507=_0x321370;m_imageOriginPos['x']=canvas[_0x15c507(0x155)]/0x2,m_imageOriginPos['y']=canvas[_0x15c507(0x246)]/0x2;}let isSpacePressed=![],isDraggingOrigin=![],originDragStartX=0x0,originDragStartY=0x0,originDragScreenX=0x0,originDragScreenY=0x0,originDragStartPosX=0x0,originDragStartPosY=0x0,moduleDragStartX=0x0,moduleDragStartY=0x0;function showMousePosition(_0x156090){const _0x2ceed1=_0x321370,_0x429adb=canvas['getBoundingClientRect'](),_0x5cd67d=canvas['width']/_0x429adb[_0x2ceed1(0x155)],_0x145ff3=(_0x156090[_0x2ceed1(0x1f9)]-_0x429adb[_0x2ceed1(0x283)])*_0x5cd67d,_0x459da1=(_0x156090[_0x2ceed1(0x28f)]-_0x429adb[_0x2ceed1(0xe1)])*_0x5cd67d,_0x1096c9=Math[_0x2ceed1(0x2af)]((_0x145ff3-m_imageOriginPos['x'])/zoomLevel),_0x93d5f=Math[_0x2ceed1(0x2af)]((m_imageOriginPos['y']-_0x459da1)/zoomLevel);document[_0x2ceed1(0x1af)](_0x2ceed1(0x201))[_0x2ceed1(0x146)]=_0x2ceed1(0xfd)+Math[_0x2ceed1(0x2af)](_0x145ff3)+',\x20'+Math[_0x2ceed1(0x2af)](_0x459da1)+_0x2ceed1(0x209)+_0x1096c9+',\x20'+_0x93d5f+')';}function updateZoomLevel(){const _0x4e06d7=_0x321370;document[_0x4e06d7(0x1af)](_0x4e06d7(0x197))[_0x4e06d7(0x146)]=Math[_0x4e06d7(0x2af)](zoomLevel*0x64)+'%',document[_0x4e06d7(0x1af)](_0x4e06d7(0xcc))[_0x4e06d7(0x146)]=Math[_0x4e06d7(0x2af)](zoomLevel*0x64)+'%';}function handleMouseWheel(_0x3d47cf){const _0x2d9ad5=_0x321370;_0x3d47cf[_0x2d9ad5(0xc1)](),_0x3d47cf[_0x2d9ad5(0x138)]<0x0?zoomLevel=Math['min'](zoomLevel+0.05,0x5):zoomLevel=Math[_0x2d9ad5(0x227)](zoomLevel-0.05,0.1),updateZoomLevel(),console[_0x2d9ad5(0x2a2)]('currentTab=',currentTab),currentTab===_0x2d9ad5(0x116)?renderCanvas():drawCurrentImage();}function drawSelectedModules(){const _0x2b8f82=_0x321370;if(!currentImage||!currentSprite||!currentImageId)return;const _0x585683=currentSprite['getImage'](currentImageId);if(!_0x585683)return;const _0x1021dc=document['getElementById']('show-all-modules')[_0x2b8f82(0x249)],_0x314ca9=(imageCanvas['width']-currentImage[_0x2b8f82(0x155)]*zoomLevel)/0x2,_0x49fc82=(imageCanvas[_0x2b8f82(0x246)]-currentImage[_0x2b8f82(0x246)]*zoomLevel)/0x2;_0x1021dc&&_0x585683[_0x2b8f82(0x1cc)][_0x2b8f82(0x118)]((_0x101364,_0x3641e9)=>{const _0x526ca1=_0x2b8f82;_0x3641e9>=0x0&&_0x3641e9<_0x585683[_0x526ca1(0x1cc)][_0x526ca1(0x145)]&&(imageCtx[_0x526ca1(0x1a4)]=_0x526ca1(0x1fe),imageCtx[_0x526ca1(0x140)]=0x2,imageCtx[_0x526ca1(0xea)](_0x314ca9+_0x101364['x']*zoomLevel,_0x49fc82+_0x101364['y']*zoomLevel,_0x101364['width']*zoomLevel,_0x101364[_0x526ca1(0x246)]*zoomLevel),imageCtx[_0x526ca1(0xc4)]=_0x526ca1(0x19d),imageCtx[_0x526ca1(0x12f)]=_0x526ca1(0xed),imageCtx['fillText'](''+(_0x3641e9+0x1),_0x314ca9+_0x101364['x']*zoomLevel+0x2,_0x49fc82+_0x101364['y']*zoomLevel+0xe));});const _0x3401fb=selectedImageModule!==-0x1?[selectedImageModule]:selectedImageModules;_0x585683['modulesList'][_0x2b8f82(0x118)]((_0x50258b,_0x5cb103)=>{const _0x2b8b47=_0x2b8f82;_0x5cb103>=0x0&&_0x5cb103<_0x585683[_0x2b8b47(0x1cc)][_0x2b8b47(0x145)]&&_0x3401fb[_0x2b8b47(0x144)](_0x5cb103)&&(imageCtx['strokeStyle']=_0x2b8b47(0x19d),imageCtx[_0x2b8b47(0x140)]=0x2,imageCtx[_0x2b8b47(0xea)](_0x314ca9+_0x50258b['x']*zoomLevel,_0x49fc82+_0x50258b['y']*zoomLevel,_0x50258b[_0x2b8b47(0x155)]*zoomLevel,_0x50258b[_0x2b8b47(0x246)]*zoomLevel),imageCtx[_0x2b8b47(0xc4)]=_0x2b8b47(0x19d),imageCtx[_0x2b8b47(0x12f)]=_0x2b8b47(0xed),imageCtx[_0x2b8b47(0xd0)](''+(_0x5cb103+0x1),_0x314ca9+_0x50258b['x']*zoomLevel+0x2,_0x49fc82+_0x50258b['y']*zoomLevel+0xe));});}function switchTab(_0x4a718c){const _0x486604=_0x321370;document[_0x486604(0x1af)](_0x486604(0x204))[_0x486604(0x25e)][_0x486604(0x1dd)](_0x486604(0x1c4)),document[_0x486604(0x1af)](_0x486604(0x1c9))['classList'][_0x486604(0x1dd)](_0x486604(0x1c4)),document[_0x486604(0x1af)](_0x486604(0x124))['classList']['remove'](_0x486604(0x1c4)),document[_0x486604(0x1af)](_0x486604(0x1be))[_0x486604(0x25e)][_0x486604(0x1dd)](_0x486604(0x1c4)),document[_0x486604(0x1af)]('tab-'+_0x4a718c)[_0x486604(0x25e)][_0x486604(0xff)]('active'),document[_0x486604(0x1af)]('content-'+_0x4a718c)[_0x486604(0x25e)][_0x486604(0xff)](_0x486604(0x1c4)),currentTab=_0x4a718c;if(_0x4a718c===_0x486604(0x116)){selectedImageModule=-0x1,selectedImageModules=[],expressionResizeControlPoint=-0x1;const _0x47a26f=document['getElementById'](_0x486604(0x164));_0x47a26f&&_0x47a26f[_0x486604(0x25e)][_0x486604(0x1dd)]('active');const _0x3d0bb9=document['getElementById'](_0x486604(0x1bb));_0x3d0bb9&&_0x3d0bb9[_0x486604(0x25e)]['remove'](_0x486604(0x1c4)),editMode=_0x486604(0x1c1),isCropping=![],renderCanvas(0x1),updateExpressionCheckboxState(),document['getElementById'](_0x486604(0x1f5))[_0x486604(0xe5)][_0x486604(0x1b0)]=_0x486604(0x289),document[_0x486604(0x1af)](_0x486604(0xef))['style'][_0x486604(0x1b0)]=_0x486604(0x230),document[_0x486604(0x1af)](_0x486604(0x151))['style'][_0x486604(0x1b0)]=_0x486604(0x230),console[_0x486604(0x2a2)](_0x486604(0x150)),!imagePreviewCanvas&&(console[_0x486604(0x2a2)](_0x486604(0x19c)),imagePreviewCanvas=document[_0x486604(0x1af)](_0x486604(0x1f6)),imagePreviewCanvas?(imagePreviewCtx=imagePreviewCanvas['getContext']('2d'),console[_0x486604(0x2a2)]('Successfully\x20initialized\x20canvas\x20and\x20context')):console[_0x486604(0x1b1)](_0x486604(0xe3))),populateImageDropdown(),console['log'](_0x486604(0x20a)),console[_0x486604(0x2a2)]({'hasCurrentImage':!!currentImage,'hasCanvas':!!imagePreviewCanvas}),currentImage&&imagePreviewCanvas?(console[_0x486604(0x2a2)](_0x486604(0x183)),renderImagePreview()):console[_0x486604(0x2a2)](_0x486604(0x279));}else{if(_0x4a718c==='image'){updateExpressionCheckboxState();if(!currentImage&&currentSprite&&currentSprite[_0x486604(0x264)][_0x486604(0x145)]>0x0){const _0x1a1cc9=currentSprite['m_imageList'][0x0];currentImage=_0x1a1cc9['image'],currentImageId=_0x1a1cc9['id'],imageCanvas[_0x486604(0x155)]=currentImage['width'],imageCanvas[_0x486604(0x246)]=currentImage[_0x486604(0x246)],zoomLevel=0x1,updateZoomLevel();}renderModulesList(),drawCurrentImage(),renderImagesList(),document[_0x486604(0x1af)]('control-panel')[_0x486604(0xe5)]['display']=_0x486604(0x230),document['getElementById'](_0x486604(0x151))[_0x486604(0xe5)][_0x486604(0x1b0)]='flex';}}}function populateImageDropdown(){const _0x199e59=_0x321370;console[_0x199e59(0x2a2)](_0x199e59(0x28a));const _0x2d3bba=document[_0x199e59(0x1af)]('image-dropdown');if(!_0x2d3bba){console[_0x199e59(0x1b1)](_0x199e59(0x22d));return;}_0x2d3bba[_0x199e59(0x24b)]='<option\x20value=\x22\x22>请选择图片</option>';if(!currentSprite){console[_0x199e59(0x1b1)](_0x199e59(0x256));return;}if(currentSprite[_0x199e59(0x264)]['length']===0x0){console[_0x199e59(0x2a2)]('No\x20images\x20available\x20in\x20currentSprite');return;}console[_0x199e59(0x2a2)](_0x199e59(0xe6),currentSprite[_0x199e59(0x264)][_0x199e59(0x145)],_0x199e59(0x14d)),currentSprite[_0x199e59(0x264)]['forEach'](_0x236b15=>{const _0x23f238=_0x199e59,_0xbb477=document[_0x23f238(0x255)]('option');_0xbb477[_0x23f238(0x11b)]=_0x236b15['id'],_0xbb477[_0x23f238(0x146)]=_0x236b15[_0x23f238(0x251)],_0x2d3bba[_0x23f238(0x1ff)](_0xbb477);});if(currentImageId){console[_0x199e59(0x2a2)](_0x199e59(0x280),currentImageId),_0x2d3bba[_0x199e59(0x11b)]=currentImageId;if(!currentImage){console['log'](_0x199e59(0x1a0));const _0x1542f3=currentSprite[_0x199e59(0x182)](parseInt(currentImageId));_0x1542f3?(console[_0x199e59(0x2a2)](_0x199e59(0x1f0),_0x1542f3[_0x199e59(0x251)]),currentImage=_0x1542f3[_0x199e59(0x1e8)],previewImage=_0x1542f3[_0x199e59(0x1e8)],console[_0x199e59(0x2a2)]('Set\x20currentImage\x20and\x20previewImage:',currentImage?currentImage['src']:_0x199e59(0x25d))):console[_0x199e59(0x1b1)]('Image\x20item\x20not\x20found\x20for\x20id:',currentImageId);}!imagePreviewCanvas&&(console[_0x199e59(0x2a2)](_0x199e59(0x17c)),imagePreviewCanvas=document[_0x199e59(0x1af)](_0x199e59(0x1f6)),imagePreviewCanvas?(imagePreviewCtx=imagePreviewCanvas['getContext']('2d'),console['log'](_0x199e59(0x18a))):console[_0x199e59(0x1b1)](_0x199e59(0xe3))),console[_0x199e59(0x2a2)]('About\x20to\x20call\x20renderImagePreview\x20from\x20populateImageDropdown'),renderImagePreview();}}function renderImagesList(){const _0x17c96c=_0x321370,_0x1048ca=document[_0x17c96c(0x1af)](_0x17c96c(0x284));_0x1048ca[_0x17c96c(0x24b)]='';if(!currentSprite||currentSprite['m_imageList'][_0x17c96c(0x145)]===0x0){_0x1048ca[_0x17c96c(0x24b)]='<div\x20class=\x22empty-message\x22>暂无加载的图片</div>';return;}currentSprite[_0x17c96c(0x264)]['forEach'](_0x34da96=>{const _0x332c3c=_0x17c96c,_0x21ad30=document[_0x332c3c(0x255)](_0x332c3c(0x2ac));_0x21ad30[_0x332c3c(0x171)]='image-name-item'+(currentImageId===_0x34da96['id']?'\x20selected':''),_0x21ad30[_0x332c3c(0xe5)]['cssText']=_0x332c3c(0x281)+(currentImageId===_0x34da96['id']?_0x332c3c(0x22c):_0x332c3c(0x248))+_0x332c3c(0x236);const _0x535a9e=document['createElement'](_0x332c3c(0x2ac));_0x535a9e[_0x332c3c(0xe5)][_0x332c3c(0x1b0)]=_0x332c3c(0x289),_0x535a9e['style'][_0x332c3c(0x217)]=_0x332c3c(0x179),_0x535a9e[_0x332c3c(0xe5)][_0x332c3c(0x26a)]=_0x332c3c(0x199),_0x21ad30[_0x332c3c(0x1ff)](_0x535a9e);const _0x362d47=document[_0x332c3c(0x1d7)](_0x34da96[_0x332c3c(0x251)]);_0x535a9e[_0x332c3c(0x1ff)](_0x362d47);const _0x444e6f=document['createElement']('div');_0x444e6f['style'][_0x332c3c(0x1b0)]=_0x332c3c(0x289),_0x444e6f[_0x332c3c(0xe5)][_0x332c3c(0xde)]='3px',_0x535a9e[_0x332c3c(0x1ff)](_0x444e6f);const _0x3c7170=document[_0x332c3c(0x255)](_0x332c3c(0x270));_0x3c7170['textContent']='删除',_0x3c7170[_0x332c3c(0xe5)][_0x332c3c(0x1c8)]='2px\x205px',_0x3c7170[_0x332c3c(0xe5)][_0x332c3c(0xd7)]=_0x332c3c(0x1ca),_0x3c7170[_0x332c3c(0xe5)][_0x332c3c(0x2b0)]=_0x332c3c(0x243),_0x3c7170[_0x332c3c(0xe5)][_0x332c3c(0x2ad)]=_0x332c3c(0x1d2),_0x3c7170[_0x332c3c(0xe5)]['border']=_0x332c3c(0x230),_0x3c7170[_0x332c3c(0xe5)]['borderRadius']='2px',_0x3c7170[_0x332c3c(0xe5)][_0x332c3c(0x203)]=_0x332c3c(0x168),_0x3c7170[_0x332c3c(0x29a)](_0x332c3c(0x1a5),_0x34bb4a=>{_0x34bb4a['stopPropagation'](),deleteImage(_0x34da96);}),_0x444e6f[_0x332c3c(0x1ff)](_0x3c7170);const _0x35b16a=document[_0x332c3c(0x255)](_0x332c3c(0x270));_0x35b16a['textContent']='替换',_0x35b16a[_0x332c3c(0xe5)]['padding']=_0x332c3c(0xba),_0x35b16a[_0x332c3c(0xe5)]['fontSize']=_0x332c3c(0x1ca),_0x35b16a[_0x332c3c(0xe5)]['backgroundColor']='#4ecdc4',_0x35b16a[_0x332c3c(0xe5)][_0x332c3c(0x2ad)]=_0x332c3c(0x1d2),_0x35b16a[_0x332c3c(0xe5)][_0x332c3c(0x180)]=_0x332c3c(0x230),_0x35b16a[_0x332c3c(0xe5)]['borderRadius']=_0x332c3c(0x1dc),_0x35b16a[_0x332c3c(0xe5)][_0x332c3c(0x203)]=_0x332c3c(0x168),_0x35b16a[_0x332c3c(0x29a)](_0x332c3c(0x1a5),_0x401759=>{const _0x5f0373=_0x332c3c;_0x401759[_0x5f0373(0x1cd)](),replaceImage(_0x34da96);}),_0x444e6f[_0x332c3c(0x1ff)](_0x35b16a),_0x21ad30[_0x332c3c(0x29a)](_0x332c3c(0x1a5),()=>{const _0x105826=_0x332c3c;currentImage=_0x34da96[_0x105826(0x1e8)],currentImageId=_0x34da96['id'],imageCanvas['width']=currentImage[_0x105826(0x155)],imageCanvas[_0x105826(0x246)]=currentImage['height'],zoomLevel=0x1,updateZoomLevel(),drawCurrentImage(),renderModulesList(),renderImagesList();}),_0x1048ca['appendChild'](_0x21ad30);});}function renderAnimationImagesList(){}function renderAnimationModulesList(_0xa95979){const _0x29ea6e=_0x321370,_0x55a855=document[_0x29ea6e(0x1af)](_0x29ea6e(0x26f));_0x55a855[_0x29ea6e(0x24b)]='',document[_0x29ea6e(0x1af)]('selected-image-title')[_0x29ea6e(0x146)]=_0xa95979[_0x29ea6e(0x251)]+_0x29ea6e(0x196);if(!_0xa95979[_0x29ea6e(0x1cc)]||_0xa95979[_0x29ea6e(0x1cc)][_0x29ea6e(0x145)]===0x0){_0x55a855[_0x29ea6e(0x24b)]='<div\x20class=\x22empty-message\x22>该图片暂无模块</div>';return;}_0xa95979['modulesList']['forEach']((_0x4fc270,_0x12f6d3)=>{const _0x35cde9=_0x29ea6e,_0x38e3b3=document[_0x35cde9(0x255)](_0x35cde9(0x2ac));_0x38e3b3[_0x35cde9(0x171)]=_0x35cde9(0x259),_0x38e3b3['style']['cssText']=_0x35cde9(0x148);const _0x4ea5ed=document[_0x35cde9(0x255)]('canvas'),_0x57258a=_0x4ea5ed['getContext']('2d'),_0x1e2858=Math[_0x35cde9(0x1e9)](0x46/_0x4fc270[_0x35cde9(0x155)],0x46/_0x4fc270[_0x35cde9(0x246)]),_0x2bfccb=_0x4fc270[_0x35cde9(0x155)]*_0x1e2858,_0x1ab146=_0x4fc270[_0x35cde9(0x246)]*_0x1e2858;_0x57258a[_0x35cde9(0x14f)](_0xa95979[_0x35cde9(0x1e8)],_0x4fc270['x'],_0x4fc270['y'],_0x4fc270[_0x35cde9(0x155)],_0x4fc270['height'],(0x46-_0x2bfccb)/0x2,(0x46-_0x1ab146)/0x2,_0x2bfccb,_0x1ab146),_0x38e3b3[_0x35cde9(0x1ff)](_0x4ea5ed);const _0xd91760=document[_0x35cde9(0x255)](_0x35cde9(0x2ac));_0xd91760[_0x35cde9(0xe5)][_0x35cde9(0x107)]=_0x35cde9(0x292),_0xd91760[_0x35cde9(0xe5)][_0x35cde9(0x1a9)]=_0x35cde9(0x1dc),_0xd91760[_0x35cde9(0xe5)][_0x35cde9(0x244)]=_0x35cde9(0x1dc),_0xd91760[_0x35cde9(0xe5)][_0x35cde9(0xd7)]=_0x35cde9(0x190),_0xd91760[_0x35cde9(0xe5)][_0x35cde9(0x2b0)]='rgba(255,\x20255,\x20255,\x200.8)',_0xd91760[_0x35cde9(0xe5)][_0x35cde9(0x1c8)]=_0x35cde9(0x14b),_0xd91760[_0x35cde9(0xe5)][_0x35cde9(0x12e)]=_0x35cde9(0x1dc),_0xd91760[_0x35cde9(0x146)]=''+(_0x12f6d3+0x1),_0x38e3b3['appendChild'](_0xd91760),_0x38e3b3[_0x35cde9(0x29a)]('click',()=>{const _0x386e1c=_0x35cde9;if(!currentFrame){alert(_0x386e1c(0x16b));return;}const _0x496194=new Module(_0xa95979['id'],_0x12f6d3),_0x5e8d20=new FrameModule(_0x496194,0x0,0x0,0x0);CommandManager[_0x386e1c(0x24d)][_0x386e1c(0x1ac)](new AddFmCommand(currentFrame,_0x5e8d20)),renderCanvas(0x2);}),_0x55a855[_0x35cde9(0x1ff)](_0x38e3b3);});}function _0x2ff9(){const _0x32b58a=['B25KCM9W','zMXHzW','wdOG','ywrKtw9KDwXL','EM9VBs1PBG','Aw1Hz2vz','yMX1zq','C3rYB2TL','ChvYCgXL','i2zMnMi2yG','CMLNAhq','Bw9KDwXLCY1SAxn0','AgvPz2H0','B3zLCIbJB250CM9SihbVAw50','i2yWzJbMma','y2HLy2TLza','yMvNAw5qyxrO','Aw5Uzxjive1m','5BEY6ycj5OUP5yY65z+FoIa','Aw5ZDgfUy2u','C3bHBG','zMXPCc12zxj0AwnHBa','B25JAgfUz2u','BMfTzq','5yQO5l2Cmq','BufUAw1mAxn0','CgXHEs1HBMLTyxrPB24','y3jLyxrLrwXLBwvUDa','q2fUBM90ihbVChvSyxrLigrYB3bKB3DUoIbJDxjYzw50u3bYAxrLigLZig51BgW','mti0mJaWmdfYAuTguuO','C29YDa','yw5PBwf0Aw9Ulw1VzhvSzs1PDgvT','icHPzdOG','y2XLyxjszwn0','BgLUzvrV','BNvSBa','y2XHC3nmAxn0','A2v5zg93BG','yw5PBu5HBwu','Bw9KDwXLlwL0zw0','5lIn5A2y5zYO','BM8Y','Bv9PBwfNzuXPC3q','u3bHy2u','mtzWEa','6k+35ywi5Qgg6ycj5lIa5lIQ5QIH5z2x','5Rc05BMZ57+76l2S5yMnoG','zhjHz2DHyMXL','ANvZDgLMEunVBNrLBNq','5zU+54Mh5zYO55s75BId5lIk55Qe57Uy5yI25l2n572U77YA','y2fUDMfZu2nHBgu6','6k+35ywi6ycj5OUP5lIa5lIQ6kEs6iMY','Aw1Hz2vvCMXZ','yw5PBwf0Aw9Ulw1VzhvSzxmTBgLZDa','yNv0Dg9U','6iEZ5Bcr6zYa6kAb5l+D55wz5lIa5BIN','CMDIysGWlcaWlcaWlcaWlJuP','yw5NBgu','yM90Dg9TlxjPz2H0','te9hoIa','5QIH5z2x5BEY5Asn5yI277Ym5y+V5lUL6lEO57k+54g157ky6ls0','Bw9KDwXLlwLUzM8','DhjHBNnMB3jTyxrPB24TChjLDMLLDW','u2TPChbPBMCGCMvUzgvYsw1Hz2vqCMv2Awv3oIbTAxnZAw5NihjLCxvPCMvKigvSzw1LBNrZ','Bv9ZChjPDgvmAxn0','Dw5KBW','y3vYCMvUDezYyw1LoG','yMXVy2S','C2nHBgu','zgf0yvrYyw5ZzMvY','u2v0DgLUzYbKzwzHDwX0ihnLBgvJDgvKigLTywDLoG','cIaGicaGicaGicaGicaGicaGicaGCgfKzgLUzZOGnxb4ideWChG7cIaGicaGicaGicaGicaGicaGicaGBwfYz2LUoIaYChGGmdSkicaGicaGicaGicaGicaGicaGicbJDxjZB3i6ihbVAw50zxi7cIaGicaGicaGicaGicaGicaGicaGyMfJA2DYB3vUzc1JB2XVCJOG','zgjSy2XPy2SX','BgvMDa','Aw1Hz2vZlwXPC3q','zMLSDgvY','BMv3lxnWCML0zs1TB2rHBa','Dg9WlxjPz2H0','zMLSzq','zMXLEa','Cg9WDwXHDgvjBwfNzurYB3bKB3DUignHBgXLza','B25KCMfNzw5K','yw5PBs1Hy3rPB25Z','ywrKlwfUAw0','5RkH5PYj5y+V55sO55Qe5zU+54Mh5QIH5z2x77Ym6k+35ywi5y675zU+54Mh57Yw6l6rDgfI5yIB5BU65QIH5z2x','y2XPzw50wq','otu2mda4ofvNANfjwG','Cg9ZAxrPB246igzPEgvKoYb0B3a6ideWChG7ihjPz2H0oIaXmhb4oYb6lwLUzgv4oIaXmdaXoYbWywrKAw5NoIa4ChG7igjHy2TNCM91BMqTy29SB3i6icnMzJzInMi7ignVBg9YoIb3AgL0ztSGyM9YzgvYoIbUB25LoYbIB3jKzxiTCMfKAxvZoIa0ChG7ign1CNnVCJOGCg9PBNrLCJS','ywjZB2X1Dgu','zNjVBq','BM90AwzPy2f0Aw9U','y3vYCMvUDc1HBMLTlw5HBwu','CMvUzgvYsw1Hz2vqCMv2Awv3','y2fUy2vSlwnYzwf0zs1ZChjPDgu','BNDZzs1YzxnPEMu','ksdLJP/LM77LT6BKUiROP5iO','ywrKrxzLBNrmAxn0zw5LCG','DgLTzwXPBMu','Aw1Hz2vnB2r1Bgvjza','6ycj5OUP5lIa5lIQ5yQO5l2C5BYa5AEl57Yw6l6r','EM9VBs1YzxnLDa','CgfYzw50rwXLBwvUDa','AgfUzgXLrNjHBwveCMfNtgvHDMuOzxzLBNqP','ywzYyw1LtgLZDa','Bg9N','y2fUy2vSlxvWBg9Hza','yxrHBJi','BgLUzuHLAwDODa','DgfIlwv4ChjLC3nPB24TBgLZDa','Cg9ZAxrPB246igzPEgvKoYbIB3r0B206ida7igXLzNq6ida7ihDPzhrOoIaXmdaLoYbOzwLNAhq6ide1mhb4oYbIywnRz3jVDw5KlwnVBg9YoIaJmdaWoYbJB2XVCJOGi2zMzJSGB3zLCMzSB3CTEtOGyxv0BZSGzM9UDc1ZAxPLoIaXmNb4oYb6lwLUzgv4oIaXmdaWoYbIB3jKzxiTDg9WoIaYChGGC29SAwqGiZmZmZS','tM8GAw1Hz2vjzcbVCIbJDxjYzw50u3bYAxrLig5VDcbHDMfPBgfIBgu','DhjPBq','CgfYC2u','mti4mte0muLMAxLfBq','zgL2','y29SB3i','mZmZndy5nMLiBwjYEq','CM91BMq','yMfJA2DYB3vUzenVBg9Y','5RkH5PYj5y+V5PkT5Ps+55Qe5yQO55s7','C2vHCMnO','DhLWzq','C3bYAxrLlw5HBwu','y29WEs1TB2r1Bgu','wtOG','zgvIDwCTAw5MBW','C2HVDY1LEhbYzxnZAw9U','mNb4idvWEa','Aw1Hz2uTBw91C2uTCg9ZAxrPB24','oda2mZC2oeDdEhboqG','iZK5oq','mJbWEa','iZaWnJzJyW','y3jLyxrLlxnWCML0zq','ChjLDMvUDerLzMf1Bhq','5PEG5yQO55s7','C3vIC3rYAw5N','zMLSBfn0EwXL','A2v5','rgvSzxrL','ywX0s2v5','B2XKq29UC29SzuXVzW','6k+36l6t5ywL5PAW55Qe5yQO55s75zcn56EWoG','ios4QUAOOEwDL++8JowpR+s7PEI3QoEYVUEbTEEYMoI0Ta','ic0G5y+m5yE75yY65z+F56gU6k6K','yw5PBwf0Aw9UlxPVB20TBgv2zwW','CMvKBW','Dgv4DefSAwDU','Bw91C2vTB3zL','zMLSBfrLEhq','nda4nJy1CMrzBwns','q29UDhjVBeXLzNq','zgjSy2XPy2S','y29Kzq','6k+L5zU+54Mh5zYO5lUL5lIl5yQO5l2C5BIN5lIT6kkR5l2/55sO77YAcG','s2v5rNjHBwvtDgf0zq','zM9UDfnPEMu','z2v0qM91BMrPBMDdBgLLBNrszwn0','mJvWEa','Bwf0y2HLCW','Dgv4DejHC2vSAw5L','zMXPCc1IB3rOlxbYzxzPzxC','yw5PBs1Hy3rPB24TyNrU','z2fW','zwzMzwn0qwXSB3DLza','y3jLyxrLlwfUAw0','Dg9W','6k+36l6t5ywL6kEs6iMY5zcn56EW','Aw1Hz2uTChjLDMLLDY1Jyw52yxmGzwXLBwvUDcbUB3qGzM91BMq','B25KCMfNB3zLCG','C3r5Bgu','qwrKAw5N','y3rYBeTLEq','y29UDgfPBNm','56gU5A6A6kAb5yIG6zMK6ycj5lIT55Qe5QIH5z2x5zcx77YF5Q2K5Pon5l2C5PEG5Rov5OgI5Asn44cc','C3rYB2TLuMvJDa','BwLKzgXL','CMvTB3zLsw1Hz2u','mtjWEcbbCMLHBa','B3jPz2LUywWTChjLDMLLDW','zxHWCMvZC2LVBI1SAxn0lxnLy3rPB24','CMfUzg9T','ywrKlwzYyw1LlwvUza','Aw1N','yM90Dg9TlwXLzNq','lNrYyw5ZzM9YBwf0Aw9UlwL0zw0','yw5PBs1Uyw1L','Bw91C2vSzwf2zq','CMvZzxqTEM9VBs1IDg4','B3jPz2LUywW','5l+D5A2y5QIH5z2x77Ym5BM25RIY5P+t','zhjHDW','Aw1Hz2vjza','Dhj1zq','6BYG5Qch5l2n572UoIdNU53LR7KO','zxHWCMvZC2LVBI1PDgvTia','ywrK','A2v5Dxa','yxbWBhK','5yEg5Ash5PEl6l2S','yw5PBwf0Aw9UlxPVB20TB3v0','mteWre1ds1LI','Cg9ZAxrPB246igzPEgvKoYb0B3a6ideWjtSGBgvMDdOGntaLoYb0CMfUC2zVCM06ihrYyw5ZBgf0zsGTntaLlcaTntaLktSGyMfJA2DYB3vUzc1JB2XVCJOGiZrdquy1mdSGy29SB3i6ihDOAxrLoYbWywrKAw5NoIaXmhb4oYbIB3jKzxiTCMfKAxvZoIa0ChG7ihOTAw5KzxG6ideWmde7','y3vYCMvUDeLTywDLoG','Cg9ZAxrPB24','CMDIysGWlcaWlcaWlcaWlJKP','Bw92zvrV','zMXPCc12zxj0AwnHBc1WCMv2Awv3','pt09pt09pt09pt09pt09pt09pt09pt09','mtrWEcbbCMLHBa','C2f2zq','mtbWEcaYmhb4','B25KCMfNBgvHDMu','twv0yuXLzNq','C3bLzwqTCMfUz2u','ywjZ','y29UzMLYBs11CgXVywq','zMXVB3i','CgfZDguTBw9KDwXL','yw5PBwf0Aw9U','Aw1Hz2vpCMLzoG','zM9YrwfJAa','B25KCMfNzw50zxi','zgvIDwC','DMfSDwu','ChvZAa','BNvSBo+8JcbJyw4GBM90ihjLDMLLDW','zMXPCc1OB3jPEM9UDgfSlxbYzxzPzxC','Bw9KDwXL','6kEs6iMYmq','icJNRkWG','C2v0qxr0CMLIDxrL','zxHWCMvZC2LVBI1SAxn0lwnVBNrHAw5LCG','y29UDgvUDc1HBMLTyxrPB24','6k+35ywi6ycj5OUP5lIa5lIQ5yQO5l2C','zML4zwq','zxHWCMvZC2LVBI1NCMLK','B2XKq29UC29SzvDHCM4','qxjYB3DeB3DU','sw1Hz2uGzhjVCgrVD24Gy2HHBMDLzcb0BZO','DMLZAwjSzq','C2HPzNrlzxK','lEwKJEwiTG','yM9YzgvYuMfKAxvZ','zM9UDa','C3bSAwnL','mtrWEa','mw5WuKDHEq','EM9VBs1PBI1IDg4','re9nq29UDgvUDeXVywrLza','nZzjz3rSugO','ywrKu3bYAxrL','Bw92zs1TB2r1BguTDxa','zgvSDgfz','BM93','C3jJ','iow4PYKk','5RkH5PYj5yQG6l295yIW6kgO5Oof5PwW5O2U','z2v0q29UDgv4Da','y3jVCfjHBMDLoG','C3bYAxrLlwXPC3q','BgLUzvDPzhrO','iZmZmW','nhb4','DhjHBNnPDgLVBG','Aw5JBhvKzxm','BgvUz3rO','Dgv4DenVBNrLBNq','zgvIDwCTBg9NCW','cIaGicaGicaGicaGicaGicaGicaGzgLZCgXHEtOGAw5SAw5LlwjSB2nRoWOGicaGicaGicaGicaGicaGicaGihDPzhrOoIa4mhb4oWOGicaGicaGicaGicaGicaGicaGigHLAwDODdOGodbWEdSkicaGicaGicaGicaGicaGicaGicbTyxjNAw46idvWEdSkicaGicaGicaGicaGicaGicaGicbWywrKAw5NoIa1ChG7cIaGicaGicaGicaGicaGicaGicaGyM9YzgvYoIaXChGGC29SAwqGi2rKzdSkicaGicaGicaGicaGicaGicaGicbJDxjZB3i6ihbVAw50zxi7cIaGicaGicaGicaGicaGicaGicaGDgv4Dc1HBgLNBJOGy2vUDgvYoWOGicaGicaGicaGicaGicaGicaGihbVC2L0Aw9UoIbYzwXHDgL2ztSkicaGicaGicaGicaGicaGia','ic0G5PEG5BIN','zMLUza','mxb4idnWEa','y2HHBMDL','Aw1Hz2vZihrVigrYB3bKB3DU','igfJDgL2zq','zhjHD0LTywDL','sw5PDgLHBgL6Aw5NigLTywDLihbYzxzPzxCGzwXLBwvUDhmGAw4GC3DPDgnOvgfIkgfUAw1HDgLVBIK','Aw1Hz2uTy29UDhjVBc1Zzwn0Aw9U','mcbHDxrVidvWEa','6k+36l6t5ywL5yQO5l2C5zcn56EW','Aw1Hz2vqCMv2Awv3q3r4oG','D2LKDgG','6zQq6jEp572r5Qc8','ChGGqxjPywW','Bw9KDwXLsw5KzxG','BMvZDY1YzxnPEMu','qxjYB3DsAwDODa','ksdLJP/LM74O','y2XPzw50v2LKDgG','zM1mAxn0','n3n1BKLSDG','iZrdquy1ma','mJrZs29YvuS','CMvUzgvYq2fUDMfZoG','DgLTzwXPBMuTzNjHBwu','5BY65yI25RIY5P+t6Ake6kEi','y3jVCc1TB2r1Bgu','C2vSzwn0zwrjBwfNzu1VzhvSztO','zxjYB3i','C2v0tgLUzurHC2G','Cg9PBNrLCG','q3vYCMvUDcbZChjPDguGzxHPC3rZlcbNzxr0Aw5NigLTywDLihDPDgGGAwq6','zMXPCc1IB3rO','6k+35ywi6ycj5OUP5lIa5lIQ5BIN','zxCTCMvZAxPL','BxvSDhKGzhjHzYbZDgfYDa','zxHWCMvZC2LVBI1PBwfNzq','DgfIlwfUAw1HDgLVBI1JB250CM9S','AgLKzgvU','y2XHC3noyw1L','zMLSBfjLy3q','CMvZAxPL','Aw1Hz2uTzhjVCgrVD27LHypNTka6','ic0G5BIN','AgfUzgXLrNjHBwveCMfNrw5Kkgv2zw50kq','Dg9Nz2XLlwDYAwq','zMXPCc1OB3jPEM9UDgfS','y2vUDgvY','zgf0ys1PBMrLEa','q2fUBM90ihjLBMrLCIbWCMv2Awv3oIbTAxnZAw5NihjLCxvPCMvKigvSzw1LBNrZ','sw5PDgLHBgL6Aw5NigLTywDLuhjLDMLLD0nHBNzHCW','nJbWEa','yxjJ','Bw9KDwXLlxDPzhrO','yM9YzgvY','B2zMC2v0wq','z2v0sw1Hz2u','q2fSBgLUzYbYzw5KzxjjBwfNzvbYzxzPzxCGzNjVBsbZD2L0y2Huywi','5Rc05BMZ57+76l2S5zcooG','Bwv0yuTLEq','q3rYBa','5BIN5BEY5ywl6zQg','zgLZywjSzwq','zxzLBNqUChjLDMvUDerLzMf1BhqOkq','u3vJy2vZC2z1BgX5igLUAxrPywXPEMvKignHBNzHCYbHBMqGy29UDgv4Da','i2zMzG','5BEY5Asn5yI2ia','A2v5zNjHBwu','C3rYAw5NAwz5','lNrPBwvSAw5LlwzYyw1L','mtjWEa','55YF5yop57sGAw1Hz2vdyw52yxmUD2LKDgG6','6k+35ywi5lIk5lYG5zU+54Mh5BM25yIB5BU66iEZ5Bcr5lIa5lIQ5QIH5z2x','BwfSzq','DMLZAwjPBgL0Eq','C2nYB2XSsgvPz2H0','ioEAHoAOOEwDLW','EM9VBs1SzxzLBa','sw1Hz2uGAxrLBsbUB3qGzM91BMqGzM9YigLKoG','C3bHy2uTyMv0D2vLBG','z3jHyMjPBMC','yw5PBwf0Aw9UlxPVB20TCMvZzxq','tg9VA2LUzYbMB3iGAw1Hz2uTChjLDMLLDY1Jyw52yxmGzwXLBwvUDa','CMDIysGYntuSidaSidaSidaUocK','yw5PBs1SAxn0','m3b4','y3vYCMvUDeLTywDLig5VDcbZzxqSihrYEwLUzYb0BYbNzxqGzNjVBsbZChjPDgu','5O6N5yI254k5','EM9VBs1VDxq','z3jLzw4','C3rYB2TLu3r5Bgu','y2XPy2S','z2v0qxr0CMLIDxrL','nJu0mJa3uNLIrMvx','Ag9YAxPVBNrHBc1TAxjYB3i','yM90Dg9T','Aw1Hz2vZ','5Rc05BMZ6zwC5yop54Q25Ocb5y+y5PU05lI6oG','ywrKq29TBwfUza','56gU5A6A6kAb5yIG6zMK6l+z5lIQ5QIH5z2x5zcx77YF','Aw5PDgLHBgL6zwq','z2v0rwXLBwvUDej5swq','zgLZCgXHEq','D2fYBG','5BEY57ky6ls0ia','nxb4','yw5PBwf0Aw9UlxPVB20TAw4','C29Tzq','Bw91C2uGDxaG6ycj5lIT5QIH5z2xoG','5RE75yQG5QIH5z2x5yIW5B2t5yMn5BIN','5PAW5zU+54Mh5Bc65A+4icG','6k+35ywi6ycj5OUP5OIw5lIk5lYG5lIa5BYG5zU+54Mh','zNjHBwvjBMrLEa','zwrPDc1TB2r1Bgu','C2vSzwn0zwq','i2zMyweWma','y29UDgvUDc1PBwfNzq','B3bHy2L0Eq','Dg9WlwXLzNq','y3jVCa','DgfYz2v0','Bw91C2v1Ca','ywn0AxzL','DxbSB2fKlwLTywDL','zMLSzxm','zMLSBa','CgfKzgLUzW','DgfIlwLTywDL','mtbWEa','BwfYz2LU','Bw9KDwXLC0XPC3q','C3rVCfbYB3bHz2f0Aw9U','y3vYCMvUDfnWCML0ztO','BwfW','y3nZvgv4Da','BMv3lwfUAw0TBw9KywW','D2HPDgu','yMXHy2S','Dg9tDhjPBMC','CMvZDg9Yzq','BwfYz2LUqM90Dg9T','y3jLyxrLvgv4De5Vzgu','Aw1Hz2uVkG','zwrPDa','5BEY6ycj5OUP6kgO5OofoIa','ywrKlxnWCML0zq','mNb4','CMvTB3zL','y3vYCMvUDeLTywDLswq6','C2nYB2XSvg9W','y2XVBMuTzNjHBwu','AgfUzgXLrNjHBwveCMfNrw50zxiOzxzLBNqP','CxvLCNLtzwXLy3rVCKfSBa','Aw5WDxq','mNb4ihnVBgLKicm0q0fgnta','B25LCNjVCG','5zU+54Mh5A+56lgH5A2y5zYO5l2g5PEGC3jJ','y2XVBMu','Aw1Hz2u','BwLU','ywX0','qwjVDxqGDg8Gy2fSBcbYzw5KzxjjBwfNzvbYzxzPzxC','z3jHyG','qxjYB3DvCa','Aw4GBw92zq','C3bLzwqTDMfSDwu','rM91BMqGAw1Hz2uGAxrLBtO','CMvK','lMv4ChjLC3nPB24TAxrLBq','CM90yxrL','DxbSB2fKlwLTywDLlw1VzgfS','y29UDhjVBc1Wyw5LBa','Aw1Hz2uTChjLDMLLDY1Jyw52yxm','zxHWCMvZC2LVBNm','zxHWCMvZC2LVBLjLy3q','y2XPzw50wa','D2HLzwW','mtaWma','5QIH5z2x5BEY57ky6ls0','Aw1Hz2uTChjLDMLLDY1Jyw52yxmGre9n5ywd57sGoG','CMDIysGWlcaYntuSidaSidaUocK','yxbWzw5Kq2HPBgq','B2zMC2v0wa','Bw91C2uTCg9ZAxrPB24','AM9PBG','y3vYC29Y','DgfIlwfUAw1HDgLVBG','v0fstJOG','Aw1Hz2vqCMv2Awv3q2fUDMfZoG','5PI+56s6572r5Qc8','CMvHzefZrgf0yvvsta','ksdNM7JLR7KO','q2HLy2TPBMCGAwyGy3vYCMvUDeLTywDLigfUzcbPBwfNzvbYzxzPzxDdyw52yxmGyxjLigf2ywLSywjSzsbMB3iGCMvUzgvY','CMDIysGYntuSidaSidaSidaUmsK','z2XVyMfSqwXWAge','Bw9KywWTAw1Hz2uTDxbSB2fK','sw1Hz2uGAxrLBtO','ywXS','iZy2nG','zgvSzxrLlwzYyw1L','B25KCMfNC3rHCNq','y2fUy2vSlwnYzwf0zs1HBMLT','qxjYB3Dmzwz0','zgvMyxvSDa','AgfUzgXLrNjHBwveCMfNu3rHCNqOzxzLBNqP','ywXPz25jDgvTCW','zxHWCMvZC2LVBKLK','i2zMndq0na','qMfJA3nWywnL','mtbWEcaW','AgfUzgXLrNjHBwveCM9Wkgv2zw50kq','zMLUzeLUzgv4','DhjHBNnSyxrL','Bw91C2vKB3DU','z3jHEq','yw5PBs1PDgvT','yw5PBuLUzgv4','B25SB2fK','56YS5lIa5BYG5zU+54Mh5l+H5OgVoG','y2fUDMfZ','z3jVDxa','Bwf4','ios4QUAOOEwDLW','zNjHBwu','u2v0ign1CNjLBNrjBwfNzsbHBMqGChjLDMLLD0LTywDLswq6','Aw5KzxHpzG','i2uWztbLma','q2fUBM90ihbVChvSyxrLigrYB3bKB3DUoIbPBwfNzs1KCM9Wzg93BIbLBgvTzw50ig5VDcbMB3vUza','Bw92zq','ywrKlwv4ChjLC3nPB24TCMvJDa','BM9Uzq','CMvZAxPL6kgO5Oof5yY65z+F','zM9JDxm','ywnJzxb0','lsdLIQJKVzWG','yM9KEq','oWOGicaGicaGicaGicaGicaGicaGigjVCMrLCI1YywrPDxm6idnWEdSkicaGicaGicaGicaGicaGia','ksdLHAJLSyaO','zgf0yxnLDa','y2XVC2vZDa'];_0x2ff9=function(){return _0x32b58a;};return _0x2ff9();}function showNewSpriteModal(){const _0x1f1d9d=_0x321370,_0x2b464c=document[_0x1f1d9d(0x1af)](_0x1f1d9d(0x2b4));currentSprite?_0x2b464c[_0x1f1d9d(0x11b)]=currentSprite[_0x1f1d9d(0x251)]:_0x2b464c[_0x1f1d9d(0x11b)]='',document['getElementById'](_0x1f1d9d(0x286))[_0x1f1d9d(0xe5)]['display']=_0x1f1d9d(0x289),_0x2b464c[_0x1f1d9d(0x232)]();}function hideNewSpriteModal(){const _0x5d4d17=_0x321370;document[_0x5d4d17(0x1af)](_0x5d4d17(0x286))[_0x5d4d17(0xe5)][_0x5d4d17(0x1b0)]='none',document[_0x5d4d17(0x1af)]('sprite-name')[_0x5d4d17(0x11b)]='';}function renameAnimation(){const _0x4113e5=_0x321370;if(!currentAnim)return;const _0x47a802=prompt(_0x4113e5(0xc9),currentAnim['name']);_0x47a802&&_0x47a802[_0x4113e5(0x2a9)]()&&(currentAnim[_0x4113e5(0x251)]=_0x47a802[_0x4113e5(0x2a9)](),renderAnimList(),document[_0x4113e5(0x1af)]('current-anim-name')['textContent']=currentAnim[_0x4113e5(0x251)]+_0x4113e5(0x175)+(currentFrameIndex+0x1),saveProject());}function copyAnimation(){const _0x4748fc=_0x321370;if(!currentAnim||!currentSprite)return;let _0x3691b4=currentAnim['name']+_0x4748fc(0x12d),_0x51fec6=0x1;while(currentSprite[_0x4748fc(0x253)][_0x4748fc(0x1b5)](_0x108a8a=>_0x108a8a[_0x4748fc(0x251)]===_0x3691b4)){_0x51fec6++,_0x3691b4=currentAnim['name']+'-复制'+_0x51fec6;}const _0x1ef2ea=new Anim(_0x3691b4);currentAnim[_0x4748fc(0x2a1)][_0x4748fc(0x118)](_0xde9440=>{const _0x194eea=_0x4748fc,_0x2b7938=_0xde9440[_0x194eea(0x229)][_0x194eea(0x1e7)](),_0x5c0069=new AnimFrame(_0x2b7938,_0xde9440['KeyFrameState']);_0x1ef2ea[_0x194eea(0x2a1)][_0x194eea(0x11c)](_0x5c0069);}),currentSprite[_0x4748fc(0x253)][_0x4748fc(0x11c)](_0x1ef2ea),renderAnimList(),saveProject();}function moveAnimationUp(){const _0x25df92=_0x321370;if(!currentSprite||!currentAnim)return;const _0x306158=currentSprite[_0x25df92(0x253)][_0x25df92(0x22b)](currentAnim);_0x306158>0x0&&([currentSprite[_0x25df92(0x253)][_0x306158-0x1],currentSprite[_0x25df92(0x253)][_0x306158]]=[currentSprite[_0x25df92(0x253)][_0x306158],currentSprite['mAnimList'][_0x306158-0x1]],renderAnimList(),saveProject());}function moveAnimationDown(){const _0x3a2cc9=_0x321370;if(!currentSprite||!currentAnim)return;const _0x677dda=currentSprite['mAnimList'][_0x3a2cc9(0x22b)](currentAnim);_0x677dda<currentSprite[_0x3a2cc9(0x253)][_0x3a2cc9(0x145)]-0x1&&([currentSprite[_0x3a2cc9(0x253)][_0x677dda],currentSprite[_0x3a2cc9(0x253)][_0x677dda+0x1]]=[currentSprite[_0x3a2cc9(0x253)][_0x677dda+0x1],currentSprite['mAnimList'][_0x677dda]],renderAnimList(),saveProject());}function moveAnimationToTop(){const _0x445f3f=_0x321370;if(!currentSprite||!currentAnim)return;const _0x18697e=currentSprite[_0x445f3f(0x253)][_0x445f3f(0x22b)](currentAnim);_0x18697e>0x0&&(currentSprite['mAnimList']['splice'](_0x18697e,0x1),currentSprite[_0x445f3f(0x253)]['unshift'](currentAnim),renderAnimList(),saveProject());}function moveAnimationToBottom(){const _0x5db36c=_0x321370;if(!currentSprite||!currentAnim)return;const _0x528c16=currentSprite[_0x5db36c(0x253)][_0x5db36c(0x22b)](currentAnim);_0x528c16<currentSprite['mAnimList'][_0x5db36c(0x145)]-0x1&&(currentSprite[_0x5db36c(0x253)][_0x5db36c(0x130)](_0x528c16,0x1),currentSprite[_0x5db36c(0x253)]['push'](currentAnim),renderAnimList(),saveProject());}function deleteAnimation(){const _0x5ee651=_0x321370;if(!currentAnim||!currentSprite)return;if(!confirm('确定要删除动画\x20\x22'+currentAnim[_0x5ee651(0x251)]+'\x22\x20吗？此操作无法恢复！'))return;const _0x92f5d1=currentSprite[_0x5ee651(0x253)]['indexOf'](currentAnim);currentSprite[_0x5ee651(0x253)][_0x5ee651(0x130)](_0x92f5d1,0x1),currentSprite[_0x5ee651(0x253)][_0x5ee651(0x145)]>0x0?selectAnim(0x0):(currentAnim=null,currentFrame=null,currentFrameIndex=-0x1,renderCanvas(0x14),document[_0x5ee651(0x1af)](_0x5ee651(0x295))[_0x5ee651(0x146)]=_0x5ee651(0xc2)),renderAnimList(),saveProject();}function createSprite(){const _0x499932=_0x321370,_0x321371=document[_0x499932(0x1af)](_0x499932(0x2b4))['value'][_0x499932(0x2a9)]();if(!_0x321371){alert(_0x499932(0xe2));return;}currentSprite?currentSprite['name']=_0x321371:(currentSprite=new Sprite(_0x321371),currentProject['addSprite'](currentSprite)),renderSpriteList(),hideNewSpriteModal();}function showNewAnimModal(){const _0xbd58da=_0x321370;if(!currentSprite){alert(_0xbd58da(0x26d));return;}document['getElementById'](_0xbd58da(0x1d1))[_0xbd58da(0xe5)][_0xbd58da(0x1b0)]=_0xbd58da(0x289),document[_0xbd58da(0x1af)]('anim-name')[_0xbd58da(0x232)]();}function hideNewAnimModal(){const _0x56f13b=_0x321370;document['getElementById']('new-anim-modal')['style']['display']=_0x56f13b(0x230),document[_0x56f13b(0x1af)](_0x56f13b(0xf5))[_0x56f13b(0x11b)]='';}function createAnim(){const _0x3fcc2e=_0x321370;if(!currentSprite)return;const _0x1189c7=document[_0x3fcc2e(0x1af)](_0x3fcc2e(0xf5))[_0x3fcc2e(0x11b)][_0x3fcc2e(0x2a9)]();if(!_0x1189c7){alert(_0x3fcc2e(0x153));return;}const _0x3cc207=new Anim(_0x1189c7);currentSprite[_0x3fcc2e(0x253)][_0x3fcc2e(0x11c)](_0x3cc207);const _0x563d2f=new Frame(),_0x47ea8c=new AnimFrame(_0x563d2f,!![]);_0x3cc207[_0x3fcc2e(0x2a1)]['push'](_0x47ea8c),renderAnimList(),hideNewAnimModal();}function showUploadImageModal(){const _0x2958a6=_0x321370;document[_0x2958a6(0x1af)](_0x2958a6(0x1f4))[_0x2958a6(0xe5)][_0x2958a6(0x1b0)]='flex';}function hideUploadImageModal(){const _0x320d2b=_0x321370;document[_0x320d2b(0x1af)](_0x320d2b(0x1f4))[_0x320d2b(0xe5)]['display']=_0x320d2b(0x230),document[_0x320d2b(0x1af)](_0x320d2b(0x20d))[_0x320d2b(0x11b)]='';}function toggleCropping(){const _0x5427a8=_0x321370;if(!currentImage){alert(_0x5427a8(0x1b9));return;}editMode=_0x5427a8(0x1c1),isCropping=!![],document[_0x5427a8(0x1af)](_0x5427a8(0x164))[_0x5427a8(0x25e)]['add'](_0x5427a8(0x1c4)),document[_0x5427a8(0x1af)](_0x5427a8(0x1bb))[_0x5427a8(0x25e)][_0x5427a8(0x1dd)](_0x5427a8(0x1c4)),selectedImageModule=-0x1,drawCurrentImage();}function toggleEditModule(){const _0x25c062=_0x321370;if(!currentImage||(!currentSprite||!currentSprite[_0x25c062(0x182)](currentImageId)||currentSprite[_0x25c062(0x182)](currentImageId)['modulesList'][_0x25c062(0x145)]===0x0)){alert(_0x25c062(0x192));return;}editMode=_0x25c062(0x1d9),isCropping=![],document[_0x25c062(0x1af)](_0x25c062(0x164))[_0x25c062(0x25e)]['remove'](_0x25c062(0x1c4)),document[_0x25c062(0x1af)](_0x25c062(0x1bb))[_0x25c062(0x25e)][_0x25c062(0xff)](_0x25c062(0x1c4)),cropLeft=0x0,cropTop=0x0,cropWidth=0x0,cropHeight=0x0,isImageModuleRangeMoving=![],resizeMode=null,moduleInfo&&(moduleInfo['style'][_0x25c062(0x1b0)]='none'),drawCurrentImage();}function showImageMousePosition(_0x327922){const _0xff47cc=_0x321370,_0x376e9a=imageCanvas[_0xff47cc(0xd8)](),_0x4a78cc=imageCanvas[_0xff47cc(0x155)]/_0x376e9a[_0xff47cc(0x155)],_0x310999=(_0x327922[_0xff47cc(0x1f9)]-_0x376e9a[_0xff47cc(0x283)])*_0x4a78cc,_0x27c2fc=(_0x327922[_0xff47cc(0x28f)]-_0x376e9a[_0xff47cc(0xe1)])*_0x4a78cc;let _0x1db9b1=0x0,_0x20f673=0x0,_0x26300f=0x0,_0x2a4b7a=0x0;console[_0xff47cc(0x2a2)](_0xff47cc(0x26c),_0x4a78cc,_0xff47cc(0x191),imageCanvas[_0xff47cc(0x155)],'区域rect.width:',_0x376e9a['width'],'currentImage.width',currentImage[_0xff47cc(0x155)],'zoomLevel:',zoomLevel),currentImage&&(_0x26300f=Math['round']((imageCanvas[_0xff47cc(0x155)]-currentImage['width']*zoomLevel)/0x2),_0x2a4b7a=Math['round']((imageCanvas[_0xff47cc(0x246)]-currentImage[_0xff47cc(0x246)]*zoomLevel)/0x2),console[_0xff47cc(0x11a)]('imageOriX:',_0x26300f,_0xff47cc(0x117),_0x2a4b7a),_0x1db9b1=Math['round']((_0x310999-_0x26300f)/zoomLevel),_0x20f673=Math[_0xff47cc(0x2af)]((_0x27c2fc-_0x2a4b7a)/zoomLevel)),document[_0xff47cc(0x1af)](_0xff47cc(0xbb))['textContent']='鼠标位置:\x20画布('+Math[_0xff47cc(0x2af)](_0x310999)+',\x20'+Math[_0xff47cc(0x2af)](_0x27c2fc)+_0xff47cc(0x299)+_0x26300f+',\x20'+_0x2a4b7a+_0xff47cc(0x15b)+_0x1db9b1+',\x20'+_0x20f673+_0xff47cc(0x237)+_0x327922[_0xff47cc(0x1f9)]+',\x20'+_0x327922[_0xff47cc(0x28f)]+'))';}function getImageEditXY(_0x257d3b){const _0x2b2f0f=_0x321370,_0x53f5ab=imageCanvas[_0x2b2f0f(0xd8)](),_0x4b7b43=imageCanvas['width']/_0x53f5ab[_0x2b2f0f(0x155)],_0x484df8=(_0x257d3b[_0x2b2f0f(0x1f9)]-_0x53f5ab[_0x2b2f0f(0x283)])*_0x4b7b43,_0x213548=(_0x257d3b[_0x2b2f0f(0x28f)]-_0x53f5ab['top'])*_0x4b7b43;if(!currentImage)return{'clickX':_0x484df8,'clickY':_0x213548,'imageOriX':0x0,'imageOriY':0x0,'imageX':0x0,'imageY':0x0};const _0x7db60d=Math[_0x2b2f0f(0x2af)]((imageCanvas['width']-currentImage[_0x2b2f0f(0x155)]*zoomLevel)/0x2),_0x3addf7=Math[_0x2b2f0f(0x2af)]((imageCanvas[_0x2b2f0f(0x246)]-currentImage[_0x2b2f0f(0x246)]*zoomLevel)/0x2);return imageX=Math[_0x2b2f0f(0x2af)]((_0x484df8-_0x7db60d)/zoomLevel),imageY=Math[_0x2b2f0f(0x2af)]((_0x213548-_0x3addf7)/zoomLevel),{'clickX':_0x484df8,'clickY':_0x213548,'imageOriX':_0x7db60d,'imageOriY':_0x3addf7,'imageX':imageX,'imageY':imageY};}function handleImageMouseDown(_0xbd1dd6){const _0x3d9bee=_0x321370;if(!currentImage)return;const {clickX:_0x26d38e,clickY:_0x55d281,imageOriX:_0x52774d,imageOriY:_0x36eaa7,imageX:_0x42e8ec,imageY:_0x33fa3e}=getImageEditXY(_0xbd1dd6);console[_0x3d9bee(0x2a2)]('drawX:',_0x52774d,_0x36eaa7);if(editMode===_0x3d9bee(0x1c1)){if(!isCropping)return;const _0x54df11=_0x52774d+cropLeft*zoomLevel,_0x1c938c=_0x36eaa7+cropTop*zoomLevel,_0x4e3b3d=cropWidth*zoomLevel,_0x2cf092=cropHeight*zoomLevel,_0x53185e=0x6;if(cropWidth>0x0&&cropHeight>0x0&&_0x26d38e>=_0x54df11-_0x53185e/0x2&&_0x26d38e<=_0x54df11+_0x4e3b3d+_0x53185e/0x2&&_0x55d281>=_0x1c938c-_0x53185e/0x2&&_0x55d281<=_0x1c938c+_0x2cf092+_0x53185e/0x2){isImageModuleRangeMoving=![],initialLeft=cropLeft,initialTop=cropTop,initialWidth=cropWidth,initialHeight=cropHeight,dragStartX=_0x26d38e,dragStartY=_0x55d281;if(_0x26d38e<=_0x54df11+_0x53185e){if(_0x55d281<=_0x1c938c+_0x53185e)resizeMode=_0x3d9bee(0x1c0);else _0x55d281>=_0x1c938c+_0x2cf092-_0x53185e?resizeMode=_0x3d9bee(0xf3):resizeMode='left';}else{if(_0x26d38e>=_0x54df11+_0x4e3b3d-_0x53185e){if(_0x55d281<=_0x1c938c+_0x53185e)resizeMode=_0x3d9bee(0x287);else _0x55d281>=_0x1c938c+_0x2cf092-_0x53185e?resizeMode='bottom-right':resizeMode=_0x3d9bee(0x244);}else{if(_0x55d281<=_0x1c938c+_0x53185e)resizeMode='top';else _0x55d281>=_0x1c938c+_0x2cf092-_0x53185e?resizeMode='bottom':resizeMode='move';}}}else isImageModuleRangeMoving=!![],resizeMode=null,cropStartX=_0x42e8ec,cropStartY=_0x33fa3e,cropLeft=cropStartX,cropTop=cropStartY,cropWidth=0x0,cropHeight=0x0,drawCurrentImage();}else{if(editMode==='edit'){const _0x58a2d5=currentSprite['getImage'](currentImageId);if(!_0x58a2d5||!_0x58a2d5['modulesList'])return;let _0x5f490c=-0x1;for(let _0xe0b481=0x0;_0xe0b481<_0x58a2d5['modulesList'][_0x3d9bee(0x145)];_0xe0b481++){const _0x26c6e7=_0x58a2d5['modulesList'][_0xe0b481],_0x4ab059=_0x26c6e7['x'],_0x269fa9=_0x26c6e7['y'],_0x875ebd=_0x26c6e7['x']+_0x26c6e7[_0x3d9bee(0x155)],_0x5dc4c2=_0x26c6e7['y']+_0x26c6e7[_0x3d9bee(0x246)];if(_0x42e8ec>=_0x4ab059&&_0x42e8ec<=_0x875ebd&&_0x33fa3e>=_0x269fa9&&_0x33fa3e<=_0x5dc4c2){_0x5f490c=_0xe0b481;break;}}if(_0x5f490c!==-0x1){selectedImageModule=_0x5f490c;const _0x459b88=_0x58a2d5['modulesList'][selectedImageModule];initialLeft=_0x459b88['x'],initialTop=_0x459b88['y'],initialWidth=_0x459b88['width'],initialHeight=_0x459b88[_0x3d9bee(0x246)],dragStartX=_0x26d38e,dragStartY=_0x55d281;const _0x1033ef=_0x52774d+_0x459b88['x']*zoomLevel,_0x494711=_0x36eaa7+_0x459b88['y']*zoomLevel,_0x4cc18e=_0x1033ef+_0x459b88[_0x3d9bee(0x155)]*zoomLevel,_0xbef06b=_0x494711+_0x459b88[_0x3d9bee(0x246)]*zoomLevel,_0xa1d8ae=0xf;if(_0x26d38e<=_0x1033ef+_0xa1d8ae){if(_0x55d281<=_0x494711+_0xa1d8ae)resizeMode=_0x3d9bee(0x1c0);else _0x55d281>=_0xbef06b-_0xa1d8ae?resizeMode=_0x3d9bee(0xf3):resizeMode=_0x3d9bee(0x283);}else{if(_0x26d38e>=_0x4cc18e-_0xa1d8ae){if(_0x55d281<=_0x494711+_0xa1d8ae)resizeMode='top-right';else _0x55d281>=_0xbef06b-_0xa1d8ae?resizeMode=_0x3d9bee(0x274):resizeMode=_0x3d9bee(0x244);}else{if(_0x55d281<=_0x494711+_0xa1d8ae)resizeMode='top';else _0x55d281>=_0xbef06b-_0xa1d8ae?resizeMode=_0x3d9bee(0x1a9):resizeMode=_0x3d9bee(0x22e);}}}else selectedImageModule=-0x1,resizeMode=null,drawCurrentImage();}}}function handleImageMouseMove(_0xb2a255){const _0x4b1dec=_0x321370;if(!currentImage)return;const _0x55bc48=imageCanvas['getBoundingClientRect'](),_0x367d8c=imageCanvas['width']/_0x55bc48['width'],_0x29d80b=(_0xb2a255[_0x4b1dec(0x1f9)]-_0x55bc48[_0x4b1dec(0x283)])*_0x367d8c,_0x210e6d=(_0xb2a255[_0x4b1dec(0x28f)]-_0x55bc48['top'])*_0x367d8c;if(resizeMode){let _0x38fecb=initialLeft,_0xdd494a=initialTop,_0x1cb340=initialWidth,_0x20d06e=initialHeight;switch(resizeMode){case _0x4b1dec(0x22e):const _0x553faf=(_0x29d80b-dragStartX)/zoomLevel,_0x23bea3=(_0x210e6d-dragStartY)/zoomLevel;_0x38fecb=initialLeft+_0x553faf,_0xdd494a=initialTop+_0x23bea3;break;case'left':_0x38fecb=initialLeft+(_0x29d80b-dragStartX)/zoomLevel,_0x1cb340=initialWidth-(_0x29d80b-dragStartX)/zoomLevel;break;case'right':_0x1cb340=initialWidth+(_0x29d80b-dragStartX)/zoomLevel;break;case _0x4b1dec(0xe1):_0xdd494a=initialTop+(_0x210e6d-dragStartY)/zoomLevel,_0x20d06e=initialHeight-(_0x210e6d-dragStartY)/zoomLevel;break;case _0x4b1dec(0x1a9):_0x20d06e=initialHeight+(_0x210e6d-dragStartY)/zoomLevel;break;case _0x4b1dec(0x1c0):_0x38fecb=initialLeft+(_0x29d80b-dragStartX)/zoomLevel,_0xdd494a=initialTop+(_0x210e6d-dragStartY)/zoomLevel,_0x1cb340=initialWidth-(_0x29d80b-dragStartX)/zoomLevel,_0x20d06e=initialHeight-(_0x210e6d-dragStartY)/zoomLevel;break;case _0x4b1dec(0x287):_0xdd494a=initialTop+(_0x210e6d-dragStartY)/zoomLevel,_0x1cb340=initialWidth+(_0x29d80b-dragStartX)/zoomLevel,_0x20d06e=initialHeight-(_0x210e6d-dragStartY)/zoomLevel;break;case'bottom-left':_0x38fecb=initialLeft+(_0x29d80b-dragStartX)/zoomLevel,_0x1cb340=initialWidth-(_0x29d80b-dragStartX)/zoomLevel,_0x20d06e=initialHeight+(_0x210e6d-dragStartY)/zoomLevel;break;case _0x4b1dec(0x274):_0x1cb340=initialWidth+(_0x29d80b-dragStartX)/zoomLevel,_0x20d06e=initialHeight+(_0x210e6d-dragStartY)/zoomLevel;break;}if(_0x1cb340<0x5)_0x1cb340=0x5;if(_0x20d06e<0x5)_0x20d06e=0x5;const _0x6e00f2=currentImage['width']-_0x1cb340,_0x43c74e=currentImage[_0x4b1dec(0x246)]-_0x20d06e;_0x38fecb=Math[_0x4b1dec(0x227)](0x0,Math['min'](_0x38fecb,_0x6e00f2)),_0xdd494a=Math[_0x4b1dec(0x227)](0x0,Math['min'](_0xdd494a,_0x43c74e));if(editMode===_0x4b1dec(0x1c1)&&isCropping)cropLeft=_0x38fecb,cropTop=_0xdd494a,cropWidth=_0x1cb340,cropHeight=_0x20d06e;else{if(editMode===_0x4b1dec(0x1d9)&&selectedImageModule!==-0x1){const _0xefc90=currentSprite[_0x4b1dec(0x182)](currentImageId);_0xefc90&&_0xefc90[_0x4b1dec(0x1cc)]&&_0xefc90['modulesList'][selectedImageModule]&&(_0xefc90['modulesList'][selectedImageModule]['x']=_0x38fecb,_0xefc90[_0x4b1dec(0x1cc)][selectedImageModule]['y']=_0xdd494a,_0xefc90[_0x4b1dec(0x1cc)][selectedImageModule]['width']=_0x1cb340,_0xefc90['modulesList'][selectedImageModule]['height']=_0x20d06e);}}drawCurrentImage();}else{if(editMode===_0x4b1dec(0x1c1)&&isCropping&&isImageModuleRangeMoving){const _0x5e2847=(imageCanvas[_0x4b1dec(0x155)]-currentImage[_0x4b1dec(0x155)]*zoomLevel)/0x2,_0x351292=(imageCanvas[_0x4b1dec(0x246)]-currentImage[_0x4b1dec(0x246)]*zoomLevel)/0x2,_0x103f0c=(_0x29d80b-_0x5e2847)/zoomLevel,_0x5ec370=(_0x210e6d-_0x351292)/zoomLevel,_0x151dd6=Math[_0x4b1dec(0x1e9)](cropStartX,_0x103f0c),_0x327ab4=Math['min'](cropStartY,_0x5ec370),_0xfe5808=Math[_0x4b1dec(0x112)](_0x103f0c-cropStartX),_0x3c05a8=Math[_0x4b1dec(0x112)](_0x5ec370-cropStartY),_0x42104e=Math[_0x4b1dec(0x227)](0x0,_0x151dd6),_0x52bec5=Math['max'](0x0,_0x327ab4),_0x2eb401=Math[_0x4b1dec(0x1e9)](_0xfe5808,currentImage['width']-_0x42104e),_0x47bcd2=Math[_0x4b1dec(0x1e9)](_0x3c05a8,currentImage[_0x4b1dec(0x246)]-_0x52bec5);cropLeft=_0x42104e,cropTop=_0x52bec5,cropWidth=_0x2eb401,cropHeight=_0x47bcd2,drawCurrentImage();}else{if(editMode===_0x4b1dec(0x1d9)){const _0x351737=(imageCanvas['width']-currentImage[_0x4b1dec(0x155)]*zoomLevel)/0x2,_0x1fa084=(imageCanvas[_0x4b1dec(0x246)]-currentImage[_0x4b1dec(0x246)]*zoomLevel)/0x2,_0x2fc17b=currentSprite[_0x4b1dec(0x182)](currentImageId);if(!_0x2fc17b||!_0x2fc17b[_0x4b1dec(0x1cc)]){imageCanvas['style'][_0x4b1dec(0x203)]='default';return;}const _0x1713b4=(_0xb2a255[_0x4b1dec(0x1f9)]-_0x55bc48[_0x4b1dec(0x283)]-_0x351737)/zoomLevel,_0x11938d=(_0xb2a255[_0x4b1dec(0x28f)]-_0x55bc48[_0x4b1dec(0xe1)]-_0x1fa084)/zoomLevel;for(let _0x55291e=0x0;_0x55291e<_0x2fc17b[_0x4b1dec(0x1cc)][_0x4b1dec(0x145)];_0x55291e++){const _0x5d7b24=_0x2fc17b[_0x4b1dec(0x1cc)][_0x55291e],_0x4a488a=_0x351737+_0x5d7b24['x']*zoomLevel,_0x5d467e=_0x1fa084+_0x5d7b24['y']*zoomLevel,_0x7668fb=_0x4a488a+_0x5d7b24['width']*zoomLevel,_0xb4281f=_0x5d467e+_0x5d7b24[_0x4b1dec(0x246)]*zoomLevel,_0x3fcea9=0xf;if(_0x29d80b>=_0x4a488a-_0x3fcea9/0x2&&_0x29d80b<=_0x7668fb+_0x3fcea9/0x2&&_0x210e6d>=_0x5d467e-_0x3fcea9/0x2&&_0x210e6d<=_0xb4281f+_0x3fcea9/0x2){if(_0x29d80b<=_0x4a488a+_0x3fcea9){if(_0x210e6d<=_0x5d467e+_0x3fcea9)imageCanvas[_0x4b1dec(0xe5)][_0x4b1dec(0x203)]=_0x4b1dec(0x298);else _0x210e6d>=_0xb4281f-_0x3fcea9?imageCanvas[_0x4b1dec(0xe5)][_0x4b1dec(0x203)]=_0x4b1dec(0x159):imageCanvas[_0x4b1dec(0xe5)]['cursor']=_0x4b1dec(0x16c);}else{if(_0x29d80b>=_0x7668fb-_0x3fcea9){if(_0x210e6d<=_0x5d467e+_0x3fcea9)imageCanvas[_0x4b1dec(0xe5)][_0x4b1dec(0x203)]='nesw-resize';else _0x210e6d>=_0xb4281f-_0x3fcea9?imageCanvas[_0x4b1dec(0xe5)][_0x4b1dec(0x203)]=_0x4b1dec(0x298):imageCanvas[_0x4b1dec(0xe5)]['cursor']=_0x4b1dec(0x16c);}else{if(_0x210e6d<=_0x5d467e+_0x3fcea9)imageCanvas[_0x4b1dec(0xe5)][_0x4b1dec(0x203)]='ns-resize';else _0x210e6d>=_0xb4281f-_0x3fcea9?imageCanvas['style'][_0x4b1dec(0x203)]='ns-resize':imageCanvas[_0x4b1dec(0xe5)][_0x4b1dec(0x203)]='move';}}return;}}imageCanvas[_0x4b1dec(0xe5)]['cursor']=_0x4b1dec(0x215);}}}}function handleImageMouseUp(){const _0x4540e0=_0x321370;if(!currentImage)return;isImageModuleRangeMoving=![],resizeMode=null;if(editMode==='crop'&&isCropping){const _0xa09221=cropWidth*zoomLevel,_0x1f465d=cropHeight*zoomLevel;if(_0xa09221>0xa&&_0x1f465d>0xa){const _0x438309=document[_0x4540e0(0x1af)](_0x4540e0(0x277));_0x438309&&(_0x438309[_0x4540e0(0x146)]=_0x4540e0(0x24c)+Math[_0x4540e0(0x2af)](_0xa09221)+'x'+Math['round'](_0x1f465d)+_0x4540e0(0xcb),_0x438309['style'][_0x4540e0(0x1b0)]=_0x4540e0(0x27d));}else{if(_0xa09221>0x0&&_0x1f465d>0x0){cropLeft=0x0,cropTop=0x0,cropWidth=0x0,cropHeight=0x0,drawCurrentImage();const _0x45ba8e=document['getElementById']('module-info');_0x45ba8e&&(_0x45ba8e[_0x4540e0(0xe5)][_0x4540e0(0x1b0)]=_0x4540e0(0x230));}}}else editMode===_0x4540e0(0x1d9)&&drawCurrentImage();}function handleImageMouseDblClick(_0x198d8e){const _0x3c3a8a=_0x321370;console[_0x3c3a8a(0x2a2)](_0x3c3a8a(0x282));if(!isCropping||!currentImage)return;_0x198d8e['stopPropagation'](),console[_0x3c3a8a(0x2a2)]('dblclick2');const _0x3b2c6c=(imageCanvas[_0x3c3a8a(0x155)]-currentImage['width']*zoomLevel)/0x2,_0x45fad8=(imageCanvas[_0x3c3a8a(0x246)]-currentImage['height']*zoomLevel)/0x2;console[_0x3c3a8a(0x2a2)](_0x3c3a8a(0x26b),_0x3b2c6c,_0x45fad8);const _0x1e1984=imageCanvas[_0x3c3a8a(0xd8)](),_0x3f7696=imageCanvas[_0x3c3a8a(0x155)]/_0x1e1984[_0x3c3a8a(0x155)],_0x20050b=((_0x198d8e[_0x3c3a8a(0x1f9)]-_0x1e1984[_0x3c3a8a(0x283)])*_0x3f7696-_0x3b2c6c)/zoomLevel,_0xafae61=((_0x198d8e[_0x3c3a8a(0x28f)]-_0x1e1984[_0x3c3a8a(0xe1)])*_0x3f7696-_0x45fad8)/zoomLevel;console['log']('imageX',_0x20050b,_0x3c3a8a(0x23f),_0xafae61,_0x3c3a8a(0x13e),cropLeft,cropTop,cropWidth,cropHeight),isCropping&&_0x20050b>=cropLeft&&_0x20050b<=cropLeft+cropWidth&&_0xafae61>=cropTop&&_0xafae61<=cropTop+cropHeight&&saveModule();}function saveModule(){const _0x5d59c4=_0x321370;if(!currentImage||!isCropping){alert(_0x5d59c4(0x267));return;}const _0x5685ae=cropLeft,_0x11e4a8=cropTop,_0x295a04=cropWidth,_0x2ae93c=cropHeight;if(_0x295a04<0xa||_0x2ae93c<0xa){alert('模块尺寸过小，请重新框选');return;}if(currentSprite&&currentImageId){const _0x44f9ba=currentSprite[_0x5d59c4(0x182)](currentImageId);if(_0x44f9ba){const _0x1a6727=_0x44f9ba[_0x5d59c4(0x1cc)][_0x5d59c4(0x145)];_0x44f9ba[_0x5d59c4(0x1cc)][_0x5d59c4(0x11c)]({'x':Math['round'](_0x5685ae),'y':Math[_0x5d59c4(0x2af)](_0x11e4a8),'width':Math[_0x5d59c4(0x2af)](_0x295a04),'height':Math['round'](_0x2ae93c)}),cropLeft=0x0,cropTop=0x0,cropWidth=0x0,cropHeight=0x0,drawCurrentImage(),console[_0x5d59c4(0x2a2)](_0x5d59c4(0xf9)),renderModulesList();}}}function renderModulesList(){const _0x5f598e=_0x321370,_0x4a8d1e=document[_0x5f598e(0x1af)](_0x5f598e(0x245));_0x4a8d1e[_0x5f598e(0x24b)]='';if(!currentSprite||!currentImageId)return;const _0x1b390a=currentSprite[_0x5f598e(0x182)](currentImageId);if(!_0x1b390a||_0x1b390a[_0x5f598e(0x1cc)][_0x5f598e(0x145)]===0x0)return;_0x1b390a[_0x5f598e(0x1cc)][_0x5f598e(0x118)]((_0x4d4877,_0x1f39b4)=>{const _0x245d37=_0x5f598e,_0x333886=document[_0x245d37(0x255)](_0x245d37(0x2ac));_0x333886[_0x245d37(0x171)]=_0x245d37(0x261)+(selectedImageModule===_0x1f39b4||selectedImageModules[_0x245d37(0x144)](_0x1f39b4)?'\x20selected':'');const _0x3e357f=document[_0x245d37(0x255)](_0x245d37(0x225));_0x3e357f[_0x245d37(0x155)]=0x50,_0x3e357f[_0x245d37(0x246)]=0x50;const _0x15cfd9=_0x3e357f[_0x245d37(0x13d)]('2d'),_0x22bf12=Math[_0x245d37(0x1e9)](0x50/_0x4d4877[_0x245d37(0x155)],0x50/_0x4d4877['height']),_0x4e9913=_0x4d4877['width']*_0x22bf12,_0x4ce08f=_0x4d4877['height']*_0x22bf12;_0x15cfd9[_0x245d37(0x14f)](currentImage,_0x4d4877['x'],_0x4d4877['y'],_0x4d4877[_0x245d37(0x155)],_0x4d4877['height'],(0x50-_0x4e9913)/0x2,(0x50-_0x4ce08f)/0x2,_0x4e9913,_0x4ce08f),_0x333886[_0x245d37(0x1ff)](_0x3e357f);const _0x1a0b48=document[_0x245d37(0x255)]('div');_0x1a0b48[_0x245d37(0xe5)]['position']=_0x245d37(0x292),_0x1a0b48[_0x245d37(0xe5)][_0x245d37(0x1a9)]=_0x245d37(0x1b3),_0x1a0b48[_0x245d37(0xe5)][_0x245d37(0x244)]=_0x245d37(0xd9),_0x1a0b48[_0x245d37(0xe5)][_0x245d37(0x2b0)]=_0x245d37(0x272),_0x1a0b48['style']['color']=_0x245d37(0x1d2),_0x1a0b48['style'][_0x245d37(0x1c8)]=_0x245d37(0xba),_0x1a0b48[_0x245d37(0xe5)]['borderRadius']=_0x245d37(0x19f),_0x1a0b48[_0x245d37(0xe5)][_0x245d37(0xd7)]=_0x245d37(0x190),_0x1a0b48[_0x245d37(0x146)]=_0x1f39b4+0x1,_0x333886[_0x245d37(0x1ff)](_0x1a0b48);const _0x3f86c8=document[_0x245d37(0x255)]('button');_0x3f86c8[_0x245d37(0xe5)][_0x245d37(0x107)]=_0x245d37(0x292),_0x3f86c8[_0x245d37(0xe5)][_0x245d37(0xe1)]='5px',_0x3f86c8[_0x245d37(0xe5)]['right']=_0x245d37(0x1b3),_0x3f86c8[_0x245d37(0xe5)][_0x245d37(0x155)]=_0x245d37(0x266),_0x3f86c8[_0x245d37(0xe5)][_0x245d37(0x246)]=_0x245d37(0x266),_0x3f86c8[_0x245d37(0xe5)][_0x245d37(0x2b0)]=_0x245d37(0x219),_0x3f86c8[_0x245d37(0xe5)][_0x245d37(0x2ad)]=_0x245d37(0x1d2),_0x3f86c8[_0x245d37(0xe5)][_0x245d37(0x180)]='none',_0x3f86c8[_0x245d37(0xe5)][_0x245d37(0x12e)]=_0x245d37(0x19f),_0x3f86c8[_0x245d37(0xe5)][_0x245d37(0xd7)]=_0x245d37(0x1ca),_0x3f86c8['style'][_0x245d37(0x2a5)]=_0x245d37(0x131),_0x3f86c8[_0x245d37(0xe5)]['textAlign']='center',_0x3f86c8[_0x245d37(0xe5)][_0x245d37(0x203)]=_0x245d37(0x168),_0x3f86c8[_0x245d37(0xe5)][_0x245d37(0x1b0)]=_0x245d37(0x289),_0x3f86c8[_0x245d37(0xe5)][_0x245d37(0x217)]=_0x245d37(0x179),_0x3f86c8['style'][_0x245d37(0x26a)]='center',_0x3f86c8['textContent']='×',_0x3f86c8[_0x245d37(0x29a)]('click',_0x4f5cb0=>{const _0xf70a5c=_0x245d37;_0x4f5cb0[_0xf70a5c(0x1cd)](),confirm(_0xf70a5c(0x1ad))&&(_0x1b390a['modulesList'][_0xf70a5c(0x130)](_0x1f39b4,0x1),renderModulesList(),drawCurrentImage());}),_0x333886[_0x245d37(0x1ff)](_0x3f86c8),_0x333886['addEventListener']('click',_0x52c382=>{const _0x56698b=_0x245d37;if(isCtrlPressed){const _0x1ccbf5=selectedImageModules[_0x56698b(0x22b)](_0x1f39b4);_0x1ccbf5===-0x1?selectedImageModules[_0x56698b(0x11c)](_0x1f39b4):selectedImageModules['splice'](_0x1ccbf5,0x1),selectedImageModule=-0x1;}else selectedImageModule=_0x1f39b4,selectedImageModules=[];renderModulesList(),drawCurrentImage();}),_0x4a8d1e[_0x245d37(0x1ff)](_0x333886);});}function showAddModuleModal(){const _0x25dc49=_0x321370;if(isEditingExpressionRect)return;if(!currentFrame){alert(_0x25dc49(0x16b));return;}if(!hasAvailableModules()){alert(_0x25dc49(0x28e)),switchTab(_0x25dc49(0x1e8));return;}addRandomModule();}function hasAvailableModules(){const _0x305697=_0x321370;if(!currentSprite)return![];for(const _0x4befca of currentSprite['m_imageList']){if(_0x4befca[_0x305697(0x1cc)]['length']>0x0)return!![];}return![];}function addRandomModule(){const _0x729c77=_0x321370;if(isEditingExpressionRect)return;if(!currentSprite||!currentFrame)return;const _0x432a3b=[];currentSprite[_0x729c77(0x264)][_0x729c77(0x118)](_0x5aa9fc=>{const _0x1cc5f1=_0x729c77;_0x5aa9fc[_0x1cc5f1(0x1cc)][_0x1cc5f1(0x118)]((_0x3a0388,_0x3475db)=>{const _0x215832=_0x1cc5f1;_0x432a3b[_0x215832(0x11c)]({'imageId':_0x5aa9fc['id'],'moduleIndex':_0x3475db});});});if(_0x432a3b[_0x729c77(0x145)]===0x0)return;const _0x43dd63=_0x432a3b[Math[_0x729c77(0x114)](Math[_0x729c77(0xf0)]()*_0x432a3b['length'])],_0x37f4e0=new Module(_0x43dd63[_0x729c77(0xfb)],_0x43dd63[_0x729c77(0x158)]),_0x51b5bd=new FrameModule(_0x37f4e0,0x0,0x0,0x0);CommandManager[_0x729c77(0x24d)][_0x729c77(0x1ac)](new AddFmCommand(currentFrame,_0x51b5bd)),renderCanvas(0x3);}function addFrame(){const _0x3fc802=_0x321370;if(!currentAnim){alert(_0x3fc802(0x125));return;}const _0x29bb5c=new Frame(),_0x24baad=new AnimFrame(_0x29bb5c,!![]);currentAnim[_0x3fc802(0x2a1)][_0x3fc802(0x130)](currentFrameIndex+0x1,0x0,_0x24baad),renderTimeline(),selectFrame(currentFrameIndex+0x1);}function addFrameToEnd(){const _0x435dc3=_0x321370;if(!currentAnim){alert(_0x435dc3(0x125));return;}const _0x1192c5=new Frame(),_0x129a09=new AnimFrame(_0x1192c5,!![]);currentAnim['aframeList'][_0x435dc3(0x11c)](_0x129a09),renderTimeline(),selectFrame(currentAnim[_0x435dc3(0x2a1)][_0x435dc3(0x145)]-0x1);}function cloneFrame(){const _0x4fbf5f=_0x321370;if(!currentAnim||!currentFrame){alert(_0x4fbf5f(0x16b));return;}const _0x138952=currentFrame[_0x4fbf5f(0x1e7)](),_0x49575b=currentAnim[_0x4fbf5f(0x2a1)][currentFrameIndex],_0x5df0f1=_0x49575b['expressionRect'],_0x36f859=new AnimFrame(_0x138952,_0x49575b['KeyFrameState'],_0x5df0f1?{..._0x5df0f1}:{'x':0x0,'y':0x0,'width':0x32,'height':0x3c});currentAnim[_0x4fbf5f(0x2a1)][_0x4fbf5f(0x130)](currentFrameIndex+0x1,0x0,_0x36f859),selectFrame(currentFrameIndex+0x1),showNotification(_0x4fbf5f(0x187)),selectFrame(currentFrameIndex+0x1);}function deleteFrame(){const _0x1457b1=_0x321370;if(!currentAnim||currentAnim['aframeList'][_0x1457b1(0x145)]<=0x1){alert(_0x1457b1(0x271));return;}currentAnim['aframeList'][_0x1457b1(0x130)](currentFrameIndex,0x1),currentFrameIndex=Math[_0x1457b1(0x1e9)](currentFrameIndex,currentAnim[_0x1457b1(0x2a1)]['length']-0x1),currentFrame=currentAnim['aframeList'][currentFrameIndex][_0x1457b1(0x229)],selectedModuleIndex=-0x1,renderTimeline(),renderCanvas(0x4),document[_0x1457b1(0x1af)](_0x1457b1(0x295))['textContent']=currentAnim['name']+_0x1457b1(0x175)+(currentFrameIndex+0x1);}function undoAction(){const _0x5da414=_0x321370;CommandManager[_0x5da414(0x24d)][_0x5da414(0x27b)](),renderCanvas(0x7),renderModulesList(),renderTimeline();}function redoAction(){const _0x3109c7=_0x321370;CommandManager[_0x3109c7(0x24d)][_0x3109c7(0xcd)](),renderCanvas(0x7),renderModulesList(),renderTimeline();}function deleteFrameModule(){const _0x48a6c3=_0x321370;if(isEditingExpressionRect)return;if(!currentFrame||selectedModuleIndex<0x0)return;const _0x324960=currentFrame[_0x48a6c3(0x15d)][selectedModuleIndex],_0x10ec7f={'execute':function(){},'undo':function(){currentFrame['fmList']['splice'](selectedModuleIndex,0x0,_0x324960),selectedModuleIndex=selectedModuleIndex,renderCanvas(0x5),updateModuleProperties(_0x324960);}};CommandManager[_0x48a6c3(0x24d)]['addCommand'](_0x10ec7f),console[_0x48a6c3(0x2a2)]('delete\x20fm:',selectedModuleIndex),currentFrame[_0x48a6c3(0x15d)][_0x48a6c3(0x130)](selectedModuleIndex,0x1),selectedModuleIndex=-0x1,renderCanvas(0x6);}function copyModule(){const _0x2286d3=_0x321370;if(isEditingExpressionRect)return;if(!currentFrame||selectedModuleIndex<0x0&&selectedModuleIndices['length']===0x0)return;if(selectedModuleIndices['length']>0x1){copiedModuleInfos=[];for(const _0x248fa0 of selectedModuleIndices){const _0x24fc74=currentFrame[_0x2286d3(0x15d)][_0x248fa0];copiedModuleInfos[_0x2286d3(0x11c)](_0x24fc74['clone']());}copiedModuleInfo=null,showNotification(_0x2286d3(0x18c)+selectedModuleIndices[_0x2286d3(0x145)]+_0x2286d3(0xca));}else{if(selectedModuleIndex>=0x0){const _0x56448f=currentFrame[_0x2286d3(0x15d)][selectedModuleIndex];copiedModuleInfo=_0x56448f[_0x2286d3(0x1e7)](),copiedModuleInfos=null,showNotification(_0x2286d3(0x276));}}}function pasteModule(){const _0x5361dc=_0x321370;if(isEditingExpressionRect)return;if(!copiedModuleInfo&&!copiedModuleInfos||!currentFrame)return;const _0x5aa3a8=new CompositeCommand(),_0x21deba=[];if(copiedModuleInfos&&copiedModuleInfos[_0x5361dc(0x145)]>0x0){for(const _0x176e7f of copiedModuleInfos){const _0x14bd65=new FrameModule(_0x176e7f['module'],_0x176e7f['x']+0xa,_0x176e7f['y']+0xa,_0x176e7f[_0x5361dc(0x23b)],_0x176e7f[_0x5361dc(0x27e)]?_0x176e7f[_0x5361dc(0x27e)]:0x1,_0x176e7f[_0x5361dc(0x273)]?_0x176e7f[_0x5361dc(0x273)]:0x0);_0x5aa3a8['addCommand'](new AddFmCommand(currentFrame,_0x14bd65));}CommandManager[_0x5361dc(0x24d)]['addCommand'](_0x5aa3a8);const _0x2f4d43=currentFrame[_0x5361dc(0x15d)]['length']-copiedModuleInfos[_0x5361dc(0x145)];selectedModuleIndices=[];for(let _0x1254b3=_0x2f4d43;_0x1254b3<currentFrame['fmList'][_0x5361dc(0x145)];_0x1254b3++){selectedModuleIndices[_0x5361dc(0x11c)](_0x1254b3);}selectedModuleIndex=selectedModuleIndices[0x0],updateModuleProperties(currentFrame[_0x5361dc(0x15d)][selectedModuleIndex]),renderCanvas(0x7),showNotification(_0x5361dc(0x1b2)+copiedModuleInfos[_0x5361dc(0x145)]+_0x5361dc(0x228));}else{if(copiedModuleInfo){const _0x9e525f=new FrameModule(copiedModuleInfo[_0x5361dc(0x11f)],copiedModuleInfo['x']+0xa,copiedModuleInfo['y']+0xa,copiedModuleInfo[_0x5361dc(0x23b)],copiedModuleInfo[_0x5361dc(0x27e)]?copiedModuleInfo[_0x5361dc(0x27e)]:0x1,copiedModuleInfo[_0x5361dc(0x273)]?copiedModuleInfo[_0x5361dc(0x273)]:0x0);CommandManager['instance'][_0x5361dc(0x1ac)](new AddFmCommand(currentFrame,_0x9e525f)),selectedModuleIndex=currentFrame[_0x5361dc(0x15d)][_0x5361dc(0x145)]-0x1,selectedModuleIndices=[selectedModuleIndex],updateModuleProperties(currentFrame[_0x5361dc(0x15d)][selectedModuleIndex]),renderCanvas(0x7),showNotification(_0x5361dc(0x1fc));}}}function showNotification(_0x40052b){const _0x2dbb14=_0x321370;let _0x57ee0d=document[_0x2dbb14(0x1af)](_0x2dbb14(0x294));!_0x57ee0d&&(_0x57ee0d=document[_0x2dbb14(0x255)]('div'),_0x57ee0d['id']=_0x2dbb14(0x294),document[_0x2dbb14(0x235)]['appendChild'](_0x57ee0d)),_0x57ee0d[_0x2dbb14(0x146)]=_0x40052b,_0x57ee0d['style'][_0x2dbb14(0x107)]=_0x2dbb14(0x126),_0x57ee0d[_0x2dbb14(0xe5)][_0x2dbb14(0x1a9)]=_0x2dbb14(0xbe),_0x57ee0d[_0x2dbb14(0xe5)][_0x2dbb14(0x244)]=_0x2dbb14(0xbe),_0x57ee0d[_0x2dbb14(0xe5)][_0x2dbb14(0x1c8)]=_0x2dbb14(0x10e),_0x57ee0d['style']['backgroundColor']=_0x2dbb14(0x141),_0x57ee0d[_0x2dbb14(0xe5)][_0x2dbb14(0x2ad)]=_0x2dbb14(0x1d2),_0x57ee0d['style'][_0x2dbb14(0x12e)]=_0x2dbb14(0x142),_0x57ee0d[_0x2dbb14(0xe5)]['zIndex']=_0x2dbb14(0x1fb),_0x57ee0d[_0x2dbb14(0xe5)]['opacity']='0',_0x57ee0d['style'][_0x2dbb14(0x143)]='opacity\x200.3s',setTimeout(()=>{const _0x34bf79=_0x2dbb14;_0x57ee0d[_0x34bf79(0xe5)]['opacity']='1';},0xa),setTimeout(()=>{const _0xa8f518=_0x2dbb14;_0x57ee0d[_0xa8f518(0xe5)]['opacity']='0';},0xbb8);}function flipHorizontal(){const _0x445592=_0x321370;if(isEditingExpressionRect)return;if(!currentFrame||selectedModuleIndex<0x0&&selectedModuleIndices['length']===0x0)return;const _0x5d1bb2=new CompositeCommand();if(selectedModuleIndices[_0x445592(0x145)]>0x1)for(const _0x3470cc of selectedModuleIndices){const _0x31d615=currentFrame['fmList'][_0x3470cc];_0x5d1bb2[_0x445592(0x1ac)](new FlipHorizontalCommand(_0x31d615));}else{if(selectedModuleIndex>=0x0){console[_0x445592(0x2a2)](_0x445592(0x268),currentFrame[_0x445592(0x15d)][selectedModuleIndex][_0x445592(0x23b)]);const _0x4d1e87=currentFrame[_0x445592(0x15d)][selectedModuleIndex];_0x5d1bb2[_0x445592(0x1ac)](new FlipHorizontalCommand(_0x4d1e87)),console[_0x445592(0x2a2)](_0x445592(0x184),_0x4d1e87[_0x445592(0x23b)]);}}CommandManager[_0x445592(0x24d)][_0x445592(0x1ac)](_0x5d1bb2),renderCanvas(0x8);}function flipVertical(){const _0x139966=_0x321370;if(isEditingExpressionRect)return;if(!currentFrame||selectedModuleIndex<0x0&&selectedModuleIndices['length']===0x0)return;const _0x55a54e=new CompositeCommand();if(selectedModuleIndices['length']>0x1)for(const _0x465722 of selectedModuleIndices){const _0x5801c7=currentFrame[_0x139966(0x15d)][_0x465722];_0x55a54e[_0x139966(0x1ac)](new FlipVerticalCommand(_0x5801c7));}else{if(selectedModuleIndex>=0x0){const _0x3c2765=currentFrame[_0x139966(0x15d)][selectedModuleIndex];_0x55a54e['addCommand'](new FlipVerticalCommand(_0x3c2765));}}CommandManager['instance'][_0x139966(0x1ac)](_0x55a54e),renderCanvas(0x9);}function rotateModule(){const _0xcc8fe0=_0x321370;if(isEditingExpressionRect)return;if(!currentFrame||selectedModuleIndex<0x0)return;const _0xca88f1=currentFrame[_0xcc8fe0(0x15d)][selectedModuleIndex];CommandManager[_0xcc8fe0(0x24d)]['addCommand'](new TransformFmCommand(_0xca88f1,_0xca88f1['x'],_0xca88f1['y'],_0xca88f1[_0xcc8fe0(0x23b)])),_0xca88f1[_0xcc8fe0(0x23b)]^=0x4,renderCanvas(0xa),updateModuleProperties(_0xca88f1);}function changeAnimationSpeed(){const _0x2ea830=_0x321370;animationSpeed=parseInt(document[_0x2ea830(0x1af)](_0x2ea830(0x111))[_0x2ea830(0x11b)]),document[_0x2ea830(0x1af)](_0x2ea830(0x1ef))['textContent']=animationSpeed;}function handleKeyDown(_0x4b6348){const _0x37b1d7=_0x321370;_0x4b6348[_0x37b1d7(0xd4)]===_0x37b1d7(0x265)&&(isSpacePressed=!![],canvas[_0x37b1d7(0xda)](':hover')&&(canvas[_0x37b1d7(0xe5)][_0x37b1d7(0x203)]=_0x37b1d7(0x1ec)),_0x4b6348[_0x37b1d7(0xc1)]());if(isEditingExpressionRect)return;(_0x4b6348[_0x37b1d7(0xd4)]===_0x37b1d7(0x186)||_0x4b6348[_0x37b1d7(0xd4)]===_0x37b1d7(0x110)||_0x4b6348[_0x37b1d7(0xd4)]===_0x37b1d7(0xd2))&&(isCtrlPressed=!![]);if(editMode===_0x37b1d7(0x1d9)&&selectedImageModule!==-0x1){const _0x26ea80=currentSprite[_0x37b1d7(0x182)](currentImageId);if(_0x26ea80&&_0x26ea80[_0x37b1d7(0x1cc)]&&_0x26ea80[_0x37b1d7(0x1cc)][selectedImageModule]){const _0x500b1f=_0x26ea80[_0x37b1d7(0x1cc)][selectedImageModule];if(['ArrowUp',_0x37b1d7(0x129),_0x37b1d7(0x214),'ArrowRight']['includes'](_0x4b6348[_0x37b1d7(0xd4)])){let _0x53ea09=0x0,_0xed6ad3=0x0;if(_0x4b6348[_0x37b1d7(0xd4)]===_0x37b1d7(0x1ed))_0xed6ad3=-0x1;else{if(_0x4b6348[_0x37b1d7(0xd4)]===_0x37b1d7(0x129))_0xed6ad3=0x1;else{if(_0x4b6348[_0x37b1d7(0xd4)]===_0x37b1d7(0x214))_0x53ea09=-0x1;else _0x4b6348[_0x37b1d7(0xd4)]==='ArrowRight'&&(_0x53ea09=0x1);}}_0x500b1f['x']+=_0x53ea09,_0x500b1f['y']+=_0xed6ad3,_0x500b1f['x']=Math['max'](0x0,_0x500b1f['x']),_0x500b1f['y']=Math[_0x37b1d7(0x227)](0x0,_0x500b1f['y']),_0x500b1f['x']=Math[_0x37b1d7(0x1e9)](_0x500b1f['x'],currentImage['width']-_0x500b1f[_0x37b1d7(0x155)]),_0x500b1f['y']=Math[_0x37b1d7(0x1e9)](_0x500b1f['y'],currentImage[_0x37b1d7(0x246)]-_0x500b1f['height']),drawCurrentImage(),_0x4b6348[_0x37b1d7(0xc1)]();}else(_0x4b6348[_0x37b1d7(0xd4)]===_0x37b1d7(0xc6)||_0x4b6348['code']==='Backspace')&&(confirm(_0x37b1d7(0xe9))&&(_0x26ea80[_0x37b1d7(0x1cc)][_0x37b1d7(0x130)](selectedImageModule,0x1),selectedImageModule=-0x1,resizeMode=null,drawCurrentImage(),renderModulesList()),_0x4b6348[_0x37b1d7(0xc1)]());}}if(currentFrame&&(selectedModuleIndex>=0x0||selectedModuleIndices[_0x37b1d7(0x145)]>0x0)){let _0x6b4dd2=[];if(selectedModuleIndices[_0x37b1d7(0x145)]>0x0)_0x6b4dd2=selectedModuleIndices[_0x37b1d7(0x1cf)](_0x395b03=>currentFrame[_0x37b1d7(0x15d)][_0x395b03]);else selectedModuleIndex>=0x0&&(_0x6b4dd2=[currentFrame['fmList'][selectedModuleIndex]]);if([_0x37b1d7(0x1ed),_0x37b1d7(0x129),'ArrowLeft',_0x37b1d7(0x15a)][_0x37b1d7(0x144)](_0x4b6348['code'])){const _0x5b562c=new CompositeCommand();let _0x6a2c66=0x0,_0xc8d876=0x0;if(_0x4b6348[_0x37b1d7(0xd4)]==='ArrowUp')_0xc8d876=0x1;else{if(_0x4b6348['code']===_0x37b1d7(0x129))_0xc8d876=-0x1;else{if(_0x4b6348[_0x37b1d7(0xd4)]===_0x37b1d7(0x214))_0x6a2c66=-0x1;else _0x4b6348['code']==='ArrowRight'&&(_0x6a2c66=0x1);}}_0x6b4dd2[_0x37b1d7(0x118)](_0x146b50=>{const _0x20ce12=_0x37b1d7,_0x52c6d7=_0x146b50['x'],_0x2b5325=_0x146b50['y'];_0x146b50['x']+=_0x6a2c66,_0x146b50['y']+=_0xc8d876;const _0x125cae={'execute':function(){_0x146b50['x']=_0x52c6d7+_0x6a2c66,_0x146b50['y']=_0x2b5325+_0xc8d876;},'undo':function(){_0x146b50['x']=_0x52c6d7,_0x146b50['y']=_0x2b5325;}};_0x5b562c[_0x20ce12(0x1ac)](_0x125cae);}),CommandManager[_0x37b1d7(0x24d)][_0x37b1d7(0x1ac)](_0x5b562c),renderCanvas(0x7),selectedModuleIndex>=0x0&&updateModuleProperties(currentFrame[_0x37b1d7(0x15d)][selectedModuleIndex]),_0x4b6348[_0x37b1d7(0xc1)]();}else{if(_0x4b6348[_0x37b1d7(0xd4)]===_0x37b1d7(0xc6)||_0x4b6348['code']===_0x37b1d7(0x21a)){const _0x35abe1=new CompositeCommand();let _0x12e980=![];if(selectedModuleIndices['length']>0x0){const _0x40a0be=[...selectedModuleIndices][_0x37b1d7(0x258)]((_0x3e6e19,_0x1ae1c5)=>_0x1ae1c5-_0x3e6e19);_0x40a0be['forEach'](_0x1576a8=>{const _0x1252e0=_0x37b1d7;if(_0x1576a8>=0x0&&_0x1576a8<currentFrame[_0x1252e0(0x15d)][_0x1252e0(0x145)]){_0x12e980=!![];const _0x29c090=currentFrame[_0x1252e0(0x15d)][_0x1576a8],_0x4a6eb4=_0x1576a8,_0x16732a={'execute':function(){},'undo':function(){const _0x416ba4=_0x1252e0;currentFrame[_0x416ba4(0x15d)]['splice'](_0x4a6eb4,0x0,_0x29c090),renderCanvas(0x5),currentFrame[_0x416ba4(0x15d)][_0x416ba4(0x145)]>0x0&&(selectedModuleIndex=Math['min'](_0x4a6eb4,currentFrame[_0x416ba4(0x15d)][_0x416ba4(0x145)]-0x1),updateModuleProperties(currentFrame[_0x416ba4(0x15d)][selectedModuleIndex]));}};_0x35abe1[_0x1252e0(0x1ac)](_0x16732a),currentFrame['fmList'][_0x1252e0(0x130)](_0x1576a8,0x1);}});}else{if(selectedModuleIndex>=0x0&&selectedModuleIndex<currentFrame[_0x37b1d7(0x15d)][_0x37b1d7(0x145)]){_0x12e980=!![];const _0x2b8407=currentFrame[_0x37b1d7(0x15d)][selectedModuleIndex],_0x629a50=selectedModuleIndex,_0x274065={'execute':function(){},'undo':function(){const _0x52bc32=_0x37b1d7;currentFrame['fmList'][_0x52bc32(0x130)](_0x629a50,0x0,_0x2b8407),renderCanvas(0x5),updateModuleProperties(_0x2b8407);}};_0x35abe1['addCommand'](_0x274065),currentFrame[_0x37b1d7(0x15d)][_0x37b1d7(0x130)](selectedModuleIndex,0x1);}}_0x12e980&&(CommandManager[_0x37b1d7(0x24d)][_0x37b1d7(0x1ac)](_0x35abe1),selectedModuleIndex=-0x1,selectedModuleIndices=[],renderCanvas(0x6),_0x4b6348[_0x37b1d7(0xc1)]());}}}}function handleKeyUp(_0x205c08){const _0x3ae03f=_0x321370;_0x205c08['code']===_0x3ae03f(0x265)&&(isSpacePressed=![],isDraggingOrigin=![],canvas[_0x3ae03f(0xe5)][_0x3ae03f(0x203)]=_0x3ae03f(0x215)),(_0x205c08[_0x3ae03f(0xd4)]===_0x3ae03f(0x186)||_0x205c08[_0x3ae03f(0xd4)]===_0x3ae03f(0x110)||_0x205c08['code']===_0x3ae03f(0xd2))&&(isCtrlPressed=![]);}function handleFrameMouseHover(_0x9b0ad4){const _0x3f92ea=_0x321370;if(isDragging||isSpacePressed||!currentFrame||selectedModuleIndex<0x0||!currentSprite)return;if(isEditingExpressionRect)return;const [_0x3a7e57,_0x16c8cc]=getCurrentXY(_0x9b0ad4),_0x1b5c69=currentFrame[_0x3f92ea(0x15d)][selectedModuleIndex],_0x4c0037=_0x1b5c69['module'];if(_0x4c0037){const _0xa1e733=currentSprite[_0x3f92ea(0x182)](_0x4c0037[_0x3f92ea(0xfb)]);if(_0xa1e733&&_0xa1e733[_0x3f92ea(0x1cc)][_0x4c0037[_0x3f92ea(0x29c)]]){const _0x26d3f5=_0xa1e733[_0x3f92ea(0x1cc)][_0x4c0037['imageModuleId']];let _0x107e78=_0x26d3f5[_0x3f92ea(0x155)],_0x25e868=_0x26d3f5[_0x3f92ea(0x246)];_0x1b5c69[_0x3f92ea(0x27e)]&&(_0x107e78*=_0x1b5c69[_0x3f92ea(0x27e)],_0x25e868*=_0x1b5c69[_0x3f92ea(0x27e)]);_0x1b5c69['flag']&0x4&&([_0x107e78,_0x25e868]=[_0x25e868,_0x107e78]);const _0x144dee=_0x1b5c69['x']+_0x107e78+0xa,_0x1a6579=_0x1b5c69['y']-_0x25e868,_0x2b7614=_0x3a7e57-_0x144dee,_0x7c0acc=_0x16c8cc-_0x1a6579;if(_0x2b7614*_0x2b7614+_0x7c0acc*_0x7c0acc<=0x10){canvas[_0x3f92ea(0xe5)][_0x3f92ea(0x203)]=_0x3f92ea(0x19a);return;}const _0x26baf0=[{'x':_0x1b5c69['x'],'y':_0x1b5c69['y']},{'x':_0x1b5c69['x']+_0x107e78,'y':_0x1b5c69['y']},{'x':_0x1b5c69['x']+_0x107e78,'y':_0x1b5c69['y']-_0x25e868},{'x':_0x1b5c69['x'],'y':_0x1b5c69['y']-_0x25e868}];for(let _0x2bc0bc=0x0;_0x2bc0bc<_0x26baf0['length'];_0x2bc0bc++){const _0x383c22=_0x3a7e57-_0x26baf0[_0x2bc0bc]['x'],_0x3035eb=_0x16c8cc-_0x26baf0[_0x2bc0bc]['y'];if(_0x383c22*_0x383c22+_0x3035eb*_0x3035eb<=0x10){_0x2bc0bc===0x0||_0x2bc0bc===0x2?canvas['style'][_0x3f92ea(0x203)]=_0x3f92ea(0x298):canvas[_0x3f92ea(0xe5)]['cursor']=_0x3f92ea(0x159);return;}}const _0x2a50de=_0x1b5c69['x'],_0xa87c27=_0x1b5c69['y'],_0x18af7a=_0x2a50de+_0x107e78,_0x27aa2c=_0xa87c27-_0x25e868;if(_0x3a7e57>=_0x2a50de-0x4&&_0x3a7e57<=_0x18af7a+0x4&&_0x16c8cc<=_0xa87c27-0x4&&_0x16c8cc>=_0x27aa2c+0x4){canvas[_0x3f92ea(0xe5)][_0x3f92ea(0x203)]='move';return;}}}canvas[_0x3f92ea(0xe5)][_0x3f92ea(0x203)]!==_0x3f92ea(0x215)&&canvas[_0x3f92ea(0xe5)][_0x3f92ea(0x203)]!==_0x3f92ea(0x1ec)&&(canvas[_0x3f92ea(0xe5)]['cursor']=_0x3f92ea(0x215));};const originalHandleMouseDown=handleFrameMouseDown,originalHandleMouseMove=handleFrameMouseMove,originalHandleMouseUp=handleFrameMouseUp;let dragStartModuleState=null,isDraggingRotate=![],originalAngle=0x0,moduleCenterX=0x0,moduleCenterY=0x0,isEditingExpressionRect=![],isDraggingExpressionRect=![],isResizingExpressionRect=![],expressionResizeControlPoint=-0x1,expressionDragStartX=0x0,expressionDragStartY=0x0,expressionOriginalX=0x0,expressionOriginalY=0x0,expressionOriginalWidth=0x0,expressionOriginalHeight=0x0,expressions=[],globalHorizontalMirrorFlag=0x0,isShowExpression=![],resizeControlPoint=-0x1,originalWidth=0x0,originalHeight=0x0,originalX=0x0,originalY=0x0;function checkPointInFm(_0x2f9a08,_0xe06165,_0x155eeb){const _0xb03771=_0x321370;if(!currentSprite)return[null,![],![],0x0,0x0];for(let _0x39471c=_0x155eeb[_0xb03771(0x15d)]['length']-0x1;_0x39471c>=0x0;_0x39471c--){const _0x3b9ac0=_0x155eeb[_0xb03771(0x15d)][_0x39471c],_0x3a631e=_0x3b9ac0['module'];if(!_0x3a631e)continue;const _0x12d12c=currentSprite[_0xb03771(0x182)](_0x3a631e['imageId']);if(!_0x12d12c||!_0x12d12c[_0xb03771(0x1cc)][_0x3a631e['imageModuleId']])continue;const _0x1918d7=_0x12d12c['modulesList'][_0x3a631e[_0xb03771(0x29c)]];let _0xdd1780=_0x1918d7[_0xb03771(0x155)],_0x5530a7=_0x1918d7[_0xb03771(0x246)];_0x3b9ac0['scale']&&(_0xdd1780*=_0x3b9ac0[_0xb03771(0x27e)],_0x5530a7*=_0x3b9ac0['scale']);_0x3b9ac0[_0xb03771(0x23b)]&0x4&&([_0xdd1780,_0x5530a7]=[_0x5530a7,_0xdd1780]);const _0x27833c=_0x3b9ac0['x'],_0x164559=_0x3b9ac0['y'],_0x3b2ea5=_0x27833c+_0xdd1780,_0x651ae0=_0x164559-_0x5530a7;if(_0x2f9a08>=_0x27833c-0x4&&_0x2f9a08<=_0x3b2ea5+0x4&&_0xe06165<=_0x164559+0x4&&_0xe06165>=_0x651ae0-0x4)return[_0x3b9ac0,!![],![],_0xdd1780,_0x5530a7];const _0x197f6e=_0x3b9ac0['x']+_0xdd1780+0xa,_0x40dd5a=_0x3b9ac0['y']-_0x5530a7,_0x22f29a=_0x2f9a08-_0x197f6e,_0x4a5aaf=_0xe06165-_0x40dd5a;if(_0x2f9a08>=_0x197f6e-0x4&&_0x2f9a08<=_0x197f6e+0x4&&_0xe06165>=_0x40dd5a-0x4&&_0xe06165<=_0x40dd5a+0x4)return[_0x3b9ac0,![],!![],_0xdd1780,_0x5530a7];}return[null,![],![],0x0,0x0];}function _0x10c5(_0x5234df,_0x5cf663){const _0x37ac74=_0x2ff9();return _0x10c5=function(_0x405282,_0x27f6d8){_0x405282=_0x405282-0xb6;let _0x2ff917=_0x37ac74[_0x405282];if(_0x10c5['WfLFqO']===undefined){var _0x10c584=function(_0x5a6a6d){const _0x82537d='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x2ecabb='',_0x29f98d='',_0x44ef9a=_0x2ecabb+_0x10c584;for(let _0x4fe40a=0x0,_0x27dcb8,_0x4fc44b,_0x360645=0x0;_0x4fc44b=_0x5a6a6d['charAt'](_0x360645++);~_0x4fc44b&&(_0x27dcb8=_0x4fe40a%0x4?_0x27dcb8*0x40+_0x4fc44b:_0x4fc44b,_0x4fe40a++%0x4)?_0x2ecabb+=_0x44ef9a['charCodeAt'](_0x360645+0xa)-0xa!==0x0?String['fromCharCode'](0xff&_0x27dcb8>>(-0x2*_0x4fe40a&0x6)):_0x4fe40a:0x0){_0x4fc44b=_0x82537d['indexOf'](_0x4fc44b);}for(let _0x3f906d=0x0,_0x2859d3=_0x2ecabb['length'];_0x3f906d<_0x2859d3;_0x3f906d++){_0x29f98d+='%'+('00'+_0x2ecabb['charCodeAt'](_0x3f906d)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x29f98d);};_0x10c5['svkijS']=_0x10c584,_0x5234df=arguments,_0x10c5['WfLFqO']=!![];}const _0xc09b40=_0x37ac74[0x0],_0x41f183=_0x405282+_0xc09b40,_0x5abb9d=_0x5234df[_0x41f183];if(!_0x5abb9d){const _0x5b4e2e=function(_0xe265b5){this['lURzDb']=_0xe265b5,this['Gxkezu']=[0x1,0x0,0x0],this['WLOteS']=function(){return'newState';},this['dJNMCw']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['nCfnBo']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x5b4e2e['prototype']['syjMXG']=function(){const _0x463999=new RegExp(this['dJNMCw']+this['nCfnBo']),_0x13c87e=_0x463999['test'](this['WLOteS']['toString']())?--this['Gxkezu'][0x1]:--this['Gxkezu'][0x0];return this['OiimwG'](_0x13c87e);},_0x5b4e2e['prototype']['OiimwG']=function(_0x2f7364){if(!Boolean(~_0x2f7364))return _0x2f7364;return this['Sboyar'](this['lURzDb']);},_0x5b4e2e['prototype']['Sboyar']=function(_0x4972ad){for(let _0x549c19=0x0,_0x3198bf=this['Gxkezu']['length'];_0x549c19<_0x3198bf;_0x549c19++){this['Gxkezu']['push'](Math['round'](Math['random']())),_0x3198bf=this['Gxkezu']['length'];}return _0x4972ad(this['Gxkezu'][0x0]);},new _0x5b4e2e(_0x10c5)['syjMXG'](),_0x2ff917=_0x10c5['svkijS'](_0x2ff917),_0x5234df[_0x41f183]=_0x2ff917;}else _0x2ff917=_0x5abb9d;return _0x2ff917;},_0x10c5(_0x5234df,_0x5cf663);}function getCurrentXY(_0x545e5c){const _0x2ebcb8=_0x321370,_0xe6c5dd=canvas[_0x2ebcb8(0xd8)]();let _0x1aa48b=_0x545e5c[_0x2ebcb8(0x1f9)]-_0xe6c5dd['left'],_0x57d0ae=_0x545e5c['clientY']-_0xe6c5dd[_0x2ebcb8(0xe1)];return _0x1aa48b=Math['round']((_0x1aa48b-m_imageOriginPos['x'])/zoomLevel),_0x57d0ae=Math['round']((m_imageOriginPos['y']-_0x57d0ae)/zoomLevel),[_0x1aa48b,_0x57d0ae];}function handleFrameMouseDown(_0x2bb93b){const _0x85a417=_0x321370;if(isSpacePressed&&selectedModuleIndex===-0x1){isDraggingOrigin=!![];const _0xf48980=canvas['getBoundingClientRect']();originDragScreenX=_0x2bb93b['clientX'],originDragScreenY=_0x2bb93b['clientY'],originDragStartPosX=m_imageOriginPos['x'],originDragStartPosY=m_imageOriginPos['y'],canvas[_0x85a417(0xe5)]['cursor']=_0x85a417(0x19a);return;}if(!currentFrame)return;const [_0x425dec,_0x3ac44f]=getCurrentXY(_0x2bb93b);if(isEditingExpressionRect&&currentFrameIndex!==-0x1&&currentAnim&&currentFrameIndex<currentAnim[_0x85a417(0x2a1)][_0x85a417(0x145)]&&currentAnim[_0x85a417(0x2a1)][currentFrameIndex]&&currentAnim[_0x85a417(0x2a1)][currentFrameIndex][_0x85a417(0x1f8)]){const _0xab734=currentAnim[_0x85a417(0x2a1)][currentFrameIndex][_0x85a417(0x1f8)],_0x2a6bd6=_0xab734['x'],_0x51d644=_0xab734['x']+_0xab734['width'],_0x3d7be1=_0xab734['y'],_0x352849=_0xab734['y']-_0xab734[_0x85a417(0x246)],_0x141ca2=[{'x':_0xab734['x'],'y':_0xab734['y']},{'x':_0xab734['x']+_0xab734[_0x85a417(0x155)],'y':_0xab734['y']},{'x':_0xab734['x']+_0xab734['width'],'y':_0xab734['y']-_0xab734['height']},{'x':_0xab734['x'],'y':_0xab734['y']-_0xab734['height']}];let _0x2c0fb1=-0x1;for(let _0x5666e4=0x0;_0x5666e4<_0x141ca2[_0x85a417(0x145)];_0x5666e4++){const _0x1ee9a3=_0x425dec-_0x141ca2[_0x5666e4]['x'],_0x5607f3=_0x3ac44f-_0x141ca2[_0x5666e4]['y'];if(_0x1ee9a3*_0x1ee9a3+_0x5607f3*_0x5607f3<=0x10){_0x2c0fb1=_0x5666e4;break;}}if(_0x2c0fb1!==-0x1){expressionResizeControlPoint=_0x2c0fb1,isDragging=!![],expressionDragStartX=_0x425dec,expressionDragStartY=_0x3ac44f,expressionOriginalX=_0xab734['x'],expressionOriginalY=_0xab734['y'],expressionOriginalWidth=_0xab734[_0x85a417(0x155)],expressionOriginalHeight=_0xab734[_0x85a417(0x246)],isResizingExpressionRect=!![],console[_0x85a417(0x2a2)](_0x85a417(0x231));return;}else{if(_0x425dec>=_0x2a6bd6&&_0x425dec<=_0x51d644&&_0x3ac44f>=_0x352849&&_0x3ac44f<=_0x3d7be1){isDraggingExpressionRect=!![],expressionDragStartX=_0x425dec,expressionDragStartY=_0x3ac44f,expressionOriginalX=_0xab734['x'],expressionOriginalY=_0xab734['y'];return;}}}if(isEditingExpressionRect){canvas[_0x85a417(0xe5)][_0x85a417(0x203)]=_0x85a417(0x215);return;}if(selectedModuleIndex>=0x0&&!isCtrlPressed){const _0x11ce4f=currentFrame[_0x85a417(0x15d)][selectedModuleIndex],_0x418c7e=_0x11ce4f[_0x85a417(0x11f)];if(_0x418c7e){const _0x353704=currentSprite['getImage'](_0x418c7e[_0x85a417(0xfb)]);if(_0x353704&&_0x353704['modulesList'][_0x418c7e[_0x85a417(0x29c)]]){const _0x10587b=_0x353704[_0x85a417(0x1cc)][_0x418c7e['imageModuleId']];let _0x4c462c=_0x10587b[_0x85a417(0x155)],_0x12fed7=_0x10587b[_0x85a417(0x246)];_0x11ce4f[_0x85a417(0x23b)]&0x4&&([_0x4c462c,_0x12fed7]=[_0x12fed7,_0x4c462c]);const _0x1869ba=[{'x':m_imageOriginPos['x']+_0x11ce4f['x'],'y':m_imageOriginPos['y']-_0x11ce4f['y']},{'x':m_imageOriginPos['x']+_0x11ce4f['x']+_0x4c462c,'y':m_imageOriginPos['y']-_0x11ce4f['y']},{'x':m_imageOriginPos['x']+_0x11ce4f['x']+_0x4c462c,'y':m_imageOriginPos['y']-_0x11ce4f['y']+_0x12fed7},{'x':m_imageOriginPos['x']+_0x11ce4f['x'],'y':m_imageOriginPos['y']-_0x11ce4f['y']+_0x12fed7}];for(let _0x423174=0x0;_0x423174<_0x1869ba[_0x85a417(0x145)];_0x423174++){const _0x1fb74d=_0x425dec-_0x1869ba[_0x423174]['x'],_0x3f085e=_0x3ac44f-_0x1869ba[_0x423174]['y'];if(_0x1fb74d*_0x1fb74d+_0x3f085e*_0x3f085e<=0x10){resizeControlPoint=_0x423174,isDragging=!![],dragStartX=_0x425dec,dragStartY=_0x3ac44f,originalWidth=_0x4c462c,originalHeight=_0x12fed7,originalX=_0x11ce4f['x'],originalY=_0x11ce4f['y'],console[_0x85a417(0x2a2)](_0x85a417(0x1a1));return;}}}}}const [_0x38d29d,_0x379118,_0xdbeaf2,_0x58d62d,_0x31df66]=checkPointInFm(_0x425dec,_0x3ac44f,currentFrame);if(_0x38d29d){const _0x493bcc=_0x38d29d[_0x85a417(0x11f)];selectedModuleIndex=currentFrame[_0x85a417(0x15d)][_0x85a417(0x22b)](_0x38d29d);!isCtrlPressed&&(selectedModuleIndices=[],selectedModuleIndices[_0x85a417(0x11c)](selectedModuleIndex));if(_0xdbeaf2){console[_0x85a417(0x2a2)](_0x85a417(0x102)),isDragging=!![],isDraggingRotate=!![],originalAngle=_0x38d29d[_0x85a417(0x273)],moduleCenterX=m_imageOriginPos['x']+_0x38d29d['x']+_0x58d62d/0x2,moduleCenterY=m_imageOriginPos['y']-_0x38d29d['y']+_0x31df66/0x2,dragStartX=_0x425dec,dragStartY=_0x3ac44f,dragStartModuleState={'x':_0x38d29d['x'],'y':_0x38d29d['y'],'flag':_0x38d29d[_0x85a417(0x23b)],'angle':_0x38d29d[_0x85a417(0x273)]};return;}if(_0x379118){if(selectedModuleIndex>=0x0&&selectedModuleIndices['length']<=0x1)isDragging=!![],dragStartX=_0x425dec,dragStartY=_0x3ac44f,dragStartModuleState={'x':_0x38d29d['x'],'y':_0x38d29d['y'],'flag':_0x38d29d[_0x85a417(0x23b)]},updateModuleProperties(_0x38d29d);else{if(isCtrlPressed){isMultiDragging=!![],dragStartX=_0x425dec,dragStartY=_0x3ac44f,dragStartModuleStates=[];for(const _0x1ab139 of selectedModuleIndices){const _0x284b7b=currentFrame[_0x85a417(0x15d)][_0x1ab139];dragStartModuleStates[_0x85a417(0x11c)]({'index':_0x1ab139,'x':_0x284b7b['x'],'y':_0x284b7b['y'],'flag':_0x284b7b['flag']});}console['log'](_0x85a417(0x16d)),updateModuleProperties(_0x38d29d);}else updateModuleProperties(_0x38d29d);}renderCanvas(0xb);return;}}isMarqueeSelecting=!![],isDragging=![],marqueeStartX=_0x425dec,marqueeStartY=_0x3ac44f,marqueeEndX=_0x425dec,marqueeEndY=_0x3ac44f,!isCtrlPressed&&(selectedModuleIndex=-0x1,selectedModuleIndices=[]),renderCanvas();}function handleFrameMouseMove(_0x3c27ca){const _0x2ac699=_0x321370;if(isDraggingOrigin){const _0x3404ac=_0x3c27ca['clientX']-originDragScreenX,_0x306c33=_0x3c27ca[_0x2ac699(0x28f)]-originDragScreenY;m_imageOriginPos['x']=originDragStartPosX+_0x3404ac,m_imageOriginPos['y']=originDragStartPosY+_0x306c33,renderCanvas();return;}let [_0x27c699,_0x59c8f2]=getCurrentXY(_0x3c27ca);if(isDraggingExpressionRect&&currentAnim&&currentFrameIndex!==-0x1&&currentFrameIndex<currentAnim[_0x2ac699(0x2a1)][_0x2ac699(0x145)]&&currentAnim[_0x2ac699(0x2a1)][currentFrameIndex]&&currentAnim[_0x2ac699(0x2a1)][currentFrameIndex][_0x2ac699(0x1f8)]){const _0x26b5e5=currentAnim[_0x2ac699(0x2a1)][currentFrameIndex]['expressionRect'],_0x1d6cb9=_0x27c699-expressionDragStartX,_0x4fd4d4=_0x59c8f2-expressionDragStartY;_0x26b5e5['x']=expressionOriginalX+_0x1d6cb9,_0x26b5e5['y']=expressionOriginalY+_0x4fd4d4,renderCanvas();return;}if(isResizingExpressionRect&&expressionResizeControlPoint!==-0x1&&isDragging&&currentAnim&&currentFrameIndex!==-0x1&&currentFrameIndex<currentAnim['aframeList'][_0x2ac699(0x145)]&&currentAnim['aframeList'][currentFrameIndex]&&currentAnim[_0x2ac699(0x2a1)][currentFrameIndex][_0x2ac699(0x1f8)]){const _0x540896=currentAnim[_0x2ac699(0x2a1)][currentFrameIndex][_0x2ac699(0x1f8)],_0x4cb35a=_0x27c699-expressionDragStartX,_0x3cd1b8=_0x59c8f2-expressionDragStartY;let _0xdb10b8=expressionOriginalWidth,_0x1a521f=expressionOriginalHeight,_0x18fe29=expressionOriginalX,_0x3f7273=expressionOriginalY;switch(expressionResizeControlPoint){case 0x0:_0xdb10b8=expressionOriginalWidth-_0x4cb35a,_0x1a521f=_0xdb10b8*1.2,_0x18fe29=expressionOriginalX+_0x4cb35a,_0x3f7273=expressionOriginalY-(_0x1a521f-expressionOriginalHeight);break;case 0x1:_0xdb10b8=expressionOriginalWidth+_0x4cb35a,_0x1a521f=_0xdb10b8*1.2,_0x3f7273=expressionOriginalY-(_0x1a521f-expressionOriginalHeight);break;case 0x2:_0xdb10b8=expressionOriginalWidth+_0x4cb35a,_0x1a521f=_0xdb10b8*1.2;break;case 0x3:_0xdb10b8=expressionOriginalWidth-_0x4cb35a,_0x1a521f=_0xdb10b8*1.2,_0x18fe29=expressionOriginalX+_0x4cb35a;break;}_0xdb10b8=Math[_0x2ac699(0x227)](0x1e,_0xdb10b8),_0x1a521f=_0xdb10b8*1.2;_0xdb10b8>0x28&&(_0x540896['x']=_0x18fe29,_0x540896['y']=_0x3f7273);_0x540896[_0x2ac699(0x155)]=_0xdb10b8,_0x540896[_0x2ac699(0x246)]=_0x1a521f,renderCanvas();return;}if(isEditingExpressionRect){if(currentFrameIndex!==-0x1&&currentAnim&&currentFrameIndex<currentAnim[_0x2ac699(0x2a1)][_0x2ac699(0x145)]&&currentAnim[_0x2ac699(0x2a1)][currentFrameIndex]&&currentAnim['aframeList'][currentFrameIndex][_0x2ac699(0x1f8)]){const _0x587375=currentAnim[_0x2ac699(0x2a1)][currentFrameIndex][_0x2ac699(0x1f8)],_0x545b52=_0x587375['x'],_0x435a56=_0x587375['x']+_0x587375[_0x2ac699(0x155)],_0x3dcd42=_0x587375['y'],_0x552f3c=_0x587375['y']-_0x587375[_0x2ac699(0x246)],_0x1ee89c=[{'x':_0x587375['x'],'y':_0x587375['y']},{'x':_0x587375['x']+_0x587375['width'],'y':_0x587375['y']},{'x':_0x587375['x']+_0x587375[_0x2ac699(0x155)],'y':_0x587375['y']-_0x587375['height']},{'x':_0x587375['x'],'y':_0x587375['y']-_0x587375[_0x2ac699(0x246)]}];let _0x3aedd7=![],_0x4c36c0=-0x1;for(let _0x26210e=0x0;_0x26210e<_0x1ee89c['length'];_0x26210e++){const _0x36650d=_0x27c699-_0x1ee89c[_0x26210e]['x'],_0x12ece3=_0x59c8f2-_0x1ee89c[_0x26210e]['y'];if(_0x36650d*_0x36650d+_0x12ece3*_0x12ece3<=0x10){_0x3aedd7=!![],_0x4c36c0=_0x26210e,console[_0x2ac699(0x2a2)](_0x2ac699(0x247),_0x26210e);break;}}if(_0x3aedd7)console[_0x2ac699(0x2a2)](_0x2ac699(0x173),_0x4c36c0),_0x4c36c0===0x0||_0x4c36c0===0x2?canvas[_0x2ac699(0xe5)]['cursor']=_0x2ac699(0x298):canvas[_0x2ac699(0xe5)][_0x2ac699(0x203)]=_0x2ac699(0x159);else _0x27c699>=_0x545b52&&_0x27c699<=_0x435a56&&_0x59c8f2<=_0x3dcd42&&_0x59c8f2>=_0x552f3c?(canvas[_0x2ac699(0xe5)][_0x2ac699(0x203)]=_0x2ac699(0x22e),console[_0x2ac699(0x2a2)](_0x2ac699(0x1ee))):canvas[_0x2ac699(0xe5)][_0x2ac699(0x203)]=_0x2ac699(0x215);}else console['log'](_0x2ac699(0x263)),canvas[_0x2ac699(0xe5)][_0x2ac699(0x203)]=_0x2ac699(0x215);return;}if(isMarqueeSelecting&&currentFrame){marqueeEndX=_0x27c699,marqueeEndY=_0x59c8f2,renderCanvas();return;}if(!isDragging&&!isMultiDragging||!currentFrame||selectedModuleIndex<0x0)return;const _0x1530cd=currentFrame[_0x2ac699(0x15d)][selectedModuleIndex];if(isDraggingRotate){const _0xed2eb9=canvas[_0x2ac699(0xd8)](),_0xf63b90=_0x3c27ca[_0x2ac699(0x1f9)]-_0xed2eb9['left'],_0x1e5baf=_0x3c27ca[_0x2ac699(0x28f)]-_0xed2eb9[_0x2ac699(0xe1)],_0x902f97=_0xf63b90-moduleCenterX,_0x2d0e41=_0x1e5baf-moduleCenterY,_0x5cffc3=Math[_0x2ac699(0x2a4)](_0x2d0e41,_0x902f97),_0x116813=_0x5cffc3*0xb4/Math['PI'];_0x1530cd['angle']=originalAngle+_0x116813,renderCanvas(),updateModuleProperties(_0x1530cd);return;}if(resizeControlPoint!==-0x1){const _0x169256=_0x27c699-dragStartX,_0x46dd58=_0x59c8f2-dragStartY;let _0x122582=originalWidth,_0x184e86=originalHeight,_0x20677d=originalX,_0x1e153e=originalY;switch(resizeControlPoint){case 0x0:_0x122582=originalWidth-_0x169256,_0x184e86=originalHeight+_0x46dd58,_0x20677d=originalX+_0x169256/0x2,_0x1e153e=originalY-_0x46dd58/0x2;break;case 0x1:_0x122582=originalWidth+_0x169256,_0x184e86=originalHeight+_0x46dd58,_0x20677d=originalX-_0x169256/0x2,_0x1e153e=originalY-_0x46dd58/0x2;break;case 0x2:_0x122582=originalWidth+_0x169256,_0x184e86=originalHeight-_0x46dd58,_0x20677d=originalX-_0x169256/0x2,_0x1e153e=originalY+_0x46dd58/0x2;break;case 0x3:_0x122582=originalWidth-_0x169256,_0x184e86=originalHeight-_0x46dd58,_0x20677d=originalX+_0x169256/0x2,_0x1e153e=originalY+_0x46dd58/0x2;break;}_0x122582=Math[_0x2ac699(0x227)](0x1,_0x122582),_0x184e86=Math[_0x2ac699(0x227)](0x1,_0x184e86);const _0x1ef53a=_0x1530cd['module'];if(_0x1ef53a){const _0x125a9c=currentSprite[_0x2ac699(0x182)](_0x1ef53a[_0x2ac699(0xfb)]);if(_0x125a9c&&_0x125a9c[_0x2ac699(0x1cc)][_0x1ef53a[_0x2ac699(0x29c)]]){const _0x1acde4=_0x125a9c[_0x2ac699(0x1cc)][_0x1ef53a[_0x2ac699(0x29c)]];let _0x3de96c=_0x1acde4[_0x2ac699(0x155)],_0x4c05f4=_0x1acde4[_0x2ac699(0x246)];_0x1530cd[_0x2ac699(0x23b)]&0x4&&([_0x3de96c,_0x4c05f4]=[_0x4c05f4,_0x3de96c]);const _0x57af42=_0x122582/_0x3de96c;_0x1530cd['x']=_0x20677d,_0x1530cd['y']=_0x1e153e;if(!_0x1530cd[_0x2ac699(0x27e)])_0x1530cd[_0x2ac699(0x27e)]=0x1;_0x1530cd[_0x2ac699(0x27e)]=_0x57af42;}}}else{const _0x187545=_0x27c699-dragStartX,_0x106723=_0x59c8f2-dragStartY;if(isMultiDragging)for(const _0x240e6d of selectedModuleIndices){const _0x572bf3=currentFrame[_0x2ac699(0x15d)][_0x240e6d];_0x572bf3['x']=_0x572bf3['x']+_0x187545,_0x572bf3['y']=_0x572bf3['y']+_0x106723;}else isDragging&&(_0x1530cd['x']=_0x1530cd['x']+_0x187545,_0x1530cd['y']=_0x1530cd['y']+_0x106723);dragStartX=_0x27c699,dragStartY=_0x59c8f2;}renderCanvas(),updateModuleProperties(_0x1530cd);}function handleFrameMouseUp(_0x20daf6){const _0x20551a=_0x321370;if(isDraggingOrigin){isDraggingOrigin=![];isSpacePressed?canvas['style'][_0x20551a(0x203)]=_0x20551a(0x1ec):canvas['style']['cursor']=_0x20551a(0x215);return;}if(isEditingExpressionRect){if(isDraggingExpressionRect)isDraggingExpressionRect=![];if(isResizingExpressionRect)isResizingExpressionRect=![];return;}if(isMarqueeSelecting&&currentFrame&&currentSprite){isMarqueeSelecting=![];const _0x1aa9cd=Math[_0x20551a(0x1e9)](marqueeStartX,marqueeEndX),_0x21b554=Math[_0x20551a(0x1e9)](marqueeStartY,marqueeEndY),_0x2a8102=Math['max'](marqueeStartX,marqueeEndX),_0x280982=Math[_0x20551a(0x227)](marqueeStartY,marqueeEndY);for(let _0x30f5c0=0x0;_0x30f5c0<currentFrame['fmList']['length'];_0x30f5c0++){const _0x25919a=currentFrame['fmList'][_0x30f5c0],_0x290b2f=_0x25919a[_0x20551a(0x11f)];if(!_0x290b2f)continue;const _0x486515=currentSprite['getImage'](_0x290b2f['imageId']);if(!_0x486515||!_0x486515['modulesList'][_0x290b2f[_0x20551a(0x29c)]])continue;const _0x713e86=_0x486515[_0x20551a(0x1cc)][_0x290b2f[_0x20551a(0x29c)]];let _0x37e975=_0x713e86[_0x20551a(0x155)],_0x91c743=_0x713e86[_0x20551a(0x246)];_0x25919a[_0x20551a(0x27e)]&&(_0x37e975*=_0x25919a[_0x20551a(0x27e)],_0x91c743*=_0x25919a[_0x20551a(0x27e)]);_0x25919a['flag']&0x4&&([_0x37e975,_0x91c743]=[_0x91c743,_0x37e975]);const _0x2e9396=_0x25919a['x'],_0x4b5dbd=_0x2e9396+_0x37e975,_0x36b31d=_0x25919a['y'],_0x1dce73=_0x36b31d-_0x91c743;_0x2e9396>=_0x1aa9cd&&_0x4b5dbd<=_0x2a8102&&_0x1dce73>=_0x21b554&&_0x36b31d<=_0x280982&&(!selectedModuleIndices['includes'](_0x30f5c0)&&selectedModuleIndices[_0x20551a(0x11c)](_0x30f5c0));}selectedModuleIndices[_0x20551a(0x145)]>0x0&&(selectedModuleIndex=selectedModuleIndices[0x0],updateModuleProperties(currentFrame[_0x20551a(0x15d)][selectedModuleIndex]));renderCanvas();return;}else isMarqueeSelecting=![];if(isDragging&&currentFrame&&selectedModuleIndex>=0x0){if(selectedModuleIndices[_0x20551a(0x145)]>0x1&&dragStartModuleStates[_0x20551a(0x145)]>0x0){const _0x4f829f=new CompositeCommand();for(const _0x134a15 of dragStartModuleStates){const _0x46e0f3=currentFrame['fmList'][_0x134a15['index']],_0xf7f89e=new TransformFmCommand(_0x46e0f3,_0x134a15['x'],_0x134a15['y'],_0x134a15[_0x20551a(0x23b)]);_0x4f829f['addCommand'](_0xf7f89e);}CommandManager[_0x20551a(0x24d)][_0x20551a(0x1ac)](_0x4f829f);}else{if(dragStartModuleState){const _0x3b4f76=currentFrame['fmList'][selectedModuleIndex],_0x1aa893=new TransformFmCommand(_0x3b4f76,dragStartModuleState['x'],dragStartModuleState['y'],dragStartModuleState[_0x20551a(0x23b)]);CommandManager['instance']['addCommand'](_0x1aa893);}}dragStartModuleState=null,dragStartModuleStates=[];}if(!currentFrame)return;let [_0x583cea,_0x32e492]=getCurrentXY(_0x20daf6);const [_0x3ecf3f,_0xe6f4f,_0x42743f]=checkPointInFm(_0x583cea,_0x32e492,currentFrame);if(_0x3ecf3f&&_0xe6f4f&&isCtrlPressed){const _0x17b9b4=selectedModuleIndices[_0x20551a(0x22b)](selectedModuleIndex);console['log'](_0x20551a(0x1b6),_0x17b9b4),_0x17b9b4===-0x1?(selectedModuleIndices[_0x20551a(0x11c)](selectedModuleIndex),selectedModuleIndex=selectedModuleIndex):(selectedModuleIndices[_0x20551a(0x130)](_0x17b9b4,selectedModuleIndex),selectedModuleIndex=selectedModuleIndices[_0x20551a(0x145)]>0x0?selectedModuleIndices[0x0]:-0x1),renderCanvas(0x15);}isDragging=![],isMultiDragging=![],resizeControlPoint=-0x1,isDraggingRotate=![],isDraggingExpressionRect=![],expressionResizeControlPoint=-0x1;}function updateModuleProperties(_0x1f82fb){if(isEditingExpressionRect)return;if(!_0x1f82fb)return;}function updateModulePosition(){const _0x98fae=_0x321370;if(isEditingExpressionRect)return;if(!currentFrame||selectedModuleIndex<0x0)return;const _0xc67b03=currentFrame['fmList'][selectedModuleIndex],_0x13f544=new TransformFmCommand(_0xc67b03,_0xc67b03['x'],_0xc67b03['y'],_0xc67b03['flag']);CommandManager['instance'][_0x98fae(0x1ac)](_0x13f544),renderCanvas(0xe);}function updateModuleSize(){const _0x450199=_0x321370;if(isEditingExpressionRect)return;if(!currentFrame||selectedModuleIndex<0x0)return;const _0x4109c2=currentFrame[_0x450199(0x15d)][selectedModuleIndex],_0x6f774=_0x4109c2['module'];if(_0x6f774){const _0x4ef42a=currentSprite['getImage'](_0x6f774[_0x450199(0xfb)]);if(_0x4ef42a&&_0x4ef42a[_0x450199(0x1cc)][_0x6f774[_0x450199(0x29c)]]){const _0x1efb35=_0x4ef42a[_0x450199(0x1cc)][_0x6f774['imageModuleId']];let _0x566399=_0x1efb35[_0x450199(0x155)],_0x1621f7=_0x1efb35[_0x450199(0x246)];_0x4109c2[_0x450199(0x23b)]&0x4&&([_0x566399,_0x1621f7]=[_0x1621f7,_0x566399]);const _0x5bbf38=parseInt(document[_0x450199(0x1af)](_0x450199(0x17f))[_0x450199(0x11b)])||_0x566399,_0x178f15=parseInt(document[_0x450199(0x1af)]('module-height')[_0x450199(0x11b)])||_0x1621f7,_0x37a79e=new TransformFmCommand(_0x4109c2,_0x4109c2['x'],_0x4109c2['y'],_0x4109c2[_0x450199(0x23b)]),_0x3fd766=_0x5bbf38/_0x566399;if(!_0x4109c2[_0x450199(0x27e)])_0x4109c2['scale']=0x1;_0x4109c2['scale']=_0x3fd766,CommandManager[_0x450199(0x24d)]['addCommand'](_0x37a79e),renderCanvas(0xf),updateModuleProperties(_0x4109c2);}}}function checkImageUsage(_0x562b23){const _0x31eae5=_0x321370,_0x401de9=[];if(!currentSprite)return _0x401de9;return currentSprite[_0x31eae5(0x253)][_0x31eae5(0x118)]((_0x1c8748,_0x4fe600)=>{const _0x53fead=_0x31eae5;_0x1c8748[_0x53fead(0x2a1)][_0x53fead(0x118)]((_0x3a7081,_0x594bcb)=>{const _0x261a15=_0x53fead,_0x12759b=_0x3a7081[_0x261a15(0x229)],_0x22f400=_0x12759b[_0x261a15(0x15d)][_0x261a15(0x1b5)](_0x133b80=>_0x133b80[_0x261a15(0x11f)]&&_0x133b80[_0x261a15(0x11f)]['imageId']===_0x562b23);_0x22f400&&_0x401de9['push']({'animName':_0x1c8748['name'],'animIndex':_0x4fe600,'frameIndex':_0x594bcb});});}),_0x401de9;}function deleteImage(_0x593f4e){const _0x56fbc8=_0x321370,_0x94369a=checkImageUsage(_0x593f4e['id']);if(_0x94369a[_0x56fbc8(0x145)]>0x0){let _0x4f4468=_0x56fbc8(0xd5);_0x94369a[_0x56fbc8(0x118)](_0x2bf77d=>{const _0x1a2ffd=_0x56fbc8;_0x4f4468+=_0x1a2ffd(0x234)+_0x2bf77d[_0x1a2ffd(0x260)]+_0x1a2ffd(0x121)+(_0x2bf77d[_0x1a2ffd(0x1ba)]+0x1)+_0x1a2ffd(0x13b);}),_0x4f4468+='删除后，这些帧中使用该图片的模块也将被删除。\x0a确认要删除吗？';if(!confirm(_0x4f4468))return;_0x94369a[_0x56fbc8(0x118)](_0x2a32ff=>{const _0xa133d4=_0x56fbc8,_0x5cd95b=currentSprite['mAnimList'][_0x2a32ff[_0xa133d4(0x222)]],_0x3191db=_0x5cd95b[_0xa133d4(0x2a1)][_0x2a32ff[_0xa133d4(0x1ba)]],_0x119445=_0x3191db[_0xa133d4(0x229)];_0x119445[_0xa133d4(0x15d)]=_0x119445[_0xa133d4(0x15d)][_0xa133d4(0x285)](_0xd1a401=>!_0xd1a401[_0xa133d4(0x11f)]||_0xd1a401[_0xa133d4(0x11f)][_0xa133d4(0xfb)]!==_0x593f4e['id']);});}const _0xc1d268=currentSprite['m_imageList'][_0x56fbc8(0x21d)](_0x2a88b9=>_0x2a88b9['id']===_0x593f4e['id']);_0xc1d268!==-0x1&&currentSprite[_0x56fbc8(0x264)][_0x56fbc8(0x130)](_0xc1d268,0x1),imageManager[_0x56fbc8(0xec)](_0x593f4e['id']),currentImageId===_0x593f4e['id']&&(currentImageId=null,currentImage=null,imageCtx[_0x56fbc8(0x25b)](0x0,0x0,imageCanvas[_0x56fbc8(0x155)],imageCanvas[_0x56fbc8(0x246)]),renderModulesList()),renderImagesList(),currentTab===_0x56fbc8(0x116)&&currentFrame&&renderCanvas();}function replaceImage(_0x754ab2){const _0xdb30ea=_0x321370,_0x16e1f1=document[_0xdb30ea(0x255)](_0xdb30ea(0x1e3));_0x16e1f1[_0xdb30ea(0x2b3)]=_0xdb30ea(0x288),_0x16e1f1[_0xdb30ea(0x233)]=_0xdb30ea(0x1d8),_0x16e1f1[_0xdb30ea(0x250)]=function(_0x5efc54){const _0x2861ab=_0xdb30ea,_0x278191=_0x5efc54[_0x2861ab(0x1c2)][_0x2861ab(0x1c6)][0x0];if(!_0x278191)return;const _0x47f73a=new FileReader();_0x47f73a['onload']=function(_0x1b55e6){const _0x4a7ce8=_0x2861ab,_0xcf94a3=new Image();_0xcf94a3[_0x4a7ce8(0x223)]=function(){const _0x26c3d2=_0x4a7ce8;if(_0xcf94a3['width']!==_0x754ab2[_0x26c3d2(0x1e8)][_0x26c3d2(0x155)]||_0xcf94a3[_0x26c3d2(0x246)]!==_0x754ab2[_0x26c3d2(0x1e8)][_0x26c3d2(0x246)]){alert(_0x26c3d2(0x1b8)+_0xcf94a3[_0x26c3d2(0x155)]+'x'+_0xcf94a3[_0x26c3d2(0x246)]+')\x20必须与原图片尺寸\x20('+_0x754ab2[_0x26c3d2(0x1e8)][_0x26c3d2(0x155)]+'x'+_0x754ab2[_0x26c3d2(0x1e8)][_0x26c3d2(0x246)]+')\x20一致，否则会出现未知错误。');return;}_0x754ab2[_0x26c3d2(0x1e8)]=_0xcf94a3,_0x754ab2[_0x26c3d2(0x13a)]=_0x1b55e6[_0x26c3d2(0x1c2)]['result'],currentImageId===_0x754ab2['id']&&(currentImage=_0xcf94a3,drawCurrentImage()),renderImagesList(),currentTab===_0x26c3d2(0x116)&&currentFrame&&renderCanvas();},_0xcf94a3[_0x4a7ce8(0x13a)]=_0x1b55e6[_0x4a7ce8(0x1c2)]['result'];},_0x47f73a[_0x2861ab(0x208)](_0x278191);},_0x16e1f1[_0xdb30ea(0x1a5)]();}function renderSpriteList(){const _0x415abf=_0x321370,_0x2b3444=document[_0x415abf(0x1af)](_0x415abf(0x13f));_0x2b3444[_0x415abf(0x24b)]='',currentProject[_0x415abf(0x27a)][_0x415abf(0x118)]((_0x180a36,_0x374657)=>{const _0x10afb0=_0x415abf,_0x528cb5=document[_0x10afb0(0x255)]('li');_0x528cb5[_0x10afb0(0x146)]=_0x180a36['name'],currentSprite===_0x180a36&&_0x528cb5[_0x10afb0(0x25e)]['add']('active'),_0x528cb5[_0x10afb0(0x29a)](_0x10afb0(0x1a5),()=>{selectSprite(_0x374657);}),_0x2b3444[_0x10afb0(0x1ff)](_0x528cb5);});}function renderAnimList(){const _0x52a4c1=_0x321370,_0x3b535d=document[_0x52a4c1(0x1af)](_0x52a4c1(0x19e));_0x3b535d[_0x52a4c1(0x24b)]='';if(!currentSprite)return;currentSprite[_0x52a4c1(0x253)]['forEach']((_0x224ed7,_0x40b78b)=>{const _0x274def=_0x52a4c1,_0x491a24=document[_0x274def(0x255)]('li');_0x491a24['className']=_0x274def(0x221)+(currentAnim===_0x224ed7?_0x274def(0x14e):'');const _0xfd9fb1=document['createElement'](_0x274def(0x24e));_0xfd9fb1['className']='anim-name',_0xfd9fb1[_0x274def(0x146)]=_0x224ed7[_0x274def(0x251)],_0xfd9fb1[_0x274def(0x29a)](_0x274def(0x1a5),_0x238482=>{const _0x550b8d=_0x274def;_0x238482[_0x550b8d(0x1cd)](),selectAnim(_0x40b78b);});const _0x1e1f85=document['createElement'](_0x274def(0x2ac));_0x1e1f85[_0x274def(0x171)]=_0x274def(0x28c);const _0x598b5a=document[_0x274def(0x255)](_0x274def(0x270));_0x598b5a[_0x274def(0x171)]=_0x274def(0xdd),_0x598b5a[_0x274def(0x146)]='复制',_0x598b5a[_0x274def(0x29a)](_0x274def(0x1a5),_0x5d7386=>{_0x5d7386['stopPropagation'](),currentAnim===_0x224ed7?copyAnimation():(selectAnim(_0x40b78b),setTimeout(copyAnimation,0x64));}),_0x1e1f85[_0x274def(0x1ff)](_0x598b5a);const _0x39971e=document[_0x274def(0x255)](_0x274def(0x270));_0x39971e['className']=_0x274def(0xdd),_0x39971e[_0x274def(0x146)]='重命名',_0x39971e[_0x274def(0x29a)](_0x274def(0x1a5),_0x3acb65=>{_0x3acb65['stopPropagation'](),currentAnim===_0x224ed7?renameAnimation():(selectAnim(_0x40b78b),setTimeout(renameAnimation,0x64));});const _0x52d7d4=document[_0x274def(0x255)](_0x274def(0x270));_0x52d7d4[_0x274def(0x171)]='anim-action-btn',_0x52d7d4[_0x274def(0x146)]='上移',_0x52d7d4[_0x274def(0x188)]=_0x40b78b===0x0,_0x52d7d4[_0x274def(0x29a)](_0x274def(0x1a5),_0x21ee33=>{_0x21ee33['stopPropagation'](),currentAnim===_0x224ed7?moveAnimationUp():(selectAnim(_0x40b78b),setTimeout(moveAnimationUp,0x64));});const _0x203fa5=document[_0x274def(0x255)](_0x274def(0x270));_0x203fa5['className']=_0x274def(0xdd),_0x203fa5['textContent']='下移',_0x203fa5[_0x274def(0x188)]=_0x40b78b===currentSprite[_0x274def(0x253)][_0x274def(0x145)]-0x1,_0x203fa5['addEventListener']('click',_0x51cbe8=>{const _0x1f9ddc=_0x274def;_0x51cbe8[_0x1f9ddc(0x1cd)](),currentAnim===_0x224ed7?moveAnimationDown():(selectAnim(_0x40b78b),setTimeout(moveAnimationDown,0x64));});const _0x5b2aff=document[_0x274def(0x255)](_0x274def(0x270));_0x5b2aff[_0x274def(0x171)]=_0x274def(0xdd),_0x5b2aff[_0x274def(0x146)]='置顶',_0x5b2aff[_0x274def(0x188)]=_0x40b78b===0x0,_0x5b2aff[_0x274def(0x29a)]('click',_0x7eb42f=>{const _0x4599a0=_0x274def;_0x7eb42f[_0x4599a0(0x1cd)](),currentAnim===_0x224ed7?moveAnimationToTop():(selectAnim(_0x40b78b),setTimeout(moveAnimationToTop,0x64));});const _0x42672b=document[_0x274def(0x255)](_0x274def(0x270));_0x42672b[_0x274def(0x171)]='anim-action-btn',_0x42672b[_0x274def(0x146)]='置底',_0x42672b['disabled']=_0x40b78b===currentSprite[_0x274def(0x253)]['length']-0x1,_0x42672b[_0x274def(0x29a)]('click',_0x432f19=>{const _0x3a38a7=_0x274def;_0x432f19[_0x3a38a7(0x1cd)](),currentAnim===_0x224ed7?moveAnimationToBottom():(selectAnim(_0x40b78b),setTimeout(moveAnimationToBottom,0x64));});const _0x2ae300=document[_0x274def(0x255)](_0x274def(0x270));_0x2ae300[_0x274def(0x171)]='anim-action-btn',_0x2ae300['textContent']='删除',_0x2ae300[_0x274def(0xe5)]['backgroundColor']=_0x274def(0x243),_0x2ae300[_0x274def(0xe5)][_0x274def(0x2ad)]=_0x274def(0x1d2),_0x2ae300['addEventListener']('click',_0x21b920=>{_0x21b920['stopPropagation'](),currentAnim===_0x224ed7?deleteAnimation():(selectAnim(_0x40b78b),setTimeout(deleteAnimation,0x64));}),_0x1e1f85[_0x274def(0x1ff)](_0x39971e),_0x1e1f85[_0x274def(0x1ff)](_0x2ae300),_0x491a24['appendChild'](_0xfd9fb1),_0x491a24[_0x274def(0x1ff)](_0x1e1f85),_0x3b535d[_0x274def(0x1ff)](_0x491a24);});}function renderTimeline(){const _0x305d38=_0x321370,_0x1341ec=document[_0x305d38(0x1af)](_0x305d38(0x29b));_0x1341ec[_0x305d38(0x24b)]='';if(!currentAnim)return;_0x1341ec[_0x305d38(0x122)]('ondragover',_0x305d38(0x189)),_0x1341ec[_0x305d38(0x122)](_0x305d38(0x23a),'handleTimelineDrop(event)'),currentAnim['aframeList'][_0x305d38(0x118)]((_0x5ee768,_0x476194)=>{const _0x5c5099=_0x305d38,_0x52aa6d=document['createElement']('div');_0x52aa6d[_0x5c5099(0x171)]='timeline-frame'+(_0x476194===currentFrameIndex?'\x20active':''),_0x5ee768[_0x5c5099(0xd6)]&&_0x52aa6d['classList'][_0x5c5099(0xff)](_0x5c5099(0x18d)),_0x52aa6d[_0x5c5099(0x146)]=_0x476194+0x1,_0x52aa6d[_0x5c5099(0x122)](_0x5c5099(0x269),_0x5c5099(0xfc)),_0x52aa6d[_0x5c5099(0x122)]('data-index',_0x476194),_0x52aa6d['setAttribute'](_0x5c5099(0x212),_0x5c5099(0x216)),_0x52aa6d[_0x5c5099(0x122)](_0x5c5099(0x28b),_0x5c5099(0x176)),_0x52aa6d[_0x5c5099(0x122)](_0x5c5099(0xe4),'event.preventDefault()'),_0x52aa6d[_0x5c5099(0x122)](_0x5c5099(0x23a),_0x5c5099(0x21c)),_0x52aa6d[_0x5c5099(0x122)](_0x5c5099(0x119),_0x5c5099(0x1e1)),_0x52aa6d['setAttribute'](_0x5c5099(0x10f),_0x5c5099(0x2a0)),_0x52aa6d['addEventListener']('click',()=>{selectFrame(_0x476194);}),_0x1341ec['appendChild'](_0x52aa6d);});}let draggedFrameIndex=-0x1;function handleFrameDragStart(_0x54afdb){const _0x22dca5=_0x321370;draggedFrameIndex=parseInt(_0x54afdb['target'][_0x22dca5(0x1a6)]('data-index')),_0x54afdb[_0x22dca5(0x27f)][_0x22dca5(0xdf)]=_0x22dca5(0x22e),_0x54afdb['target'][_0x22dca5(0xe5)][_0x22dca5(0x1bf)]='0.5';}function handleFrameDragEnd(_0x5c0773){const _0x517da2=_0x321370;_0x5c0773['target']['style']['opacity']='1';const _0x5c54db=document[_0x517da2(0x1e2)](_0x517da2(0x18f));_0x5c54db[_0x517da2(0x118)](_0x26aa38=>{const _0x227456=_0x517da2;_0x26aa38['style'][_0x227456(0x2b0)]='';});}function handleFrameDragEnter(_0x3c1c73){const _0x4069b6=_0x321370;_0x3c1c73[_0x4069b6(0x1c2)][_0x4069b6(0x25e)][_0x4069b6(0xe8)]('timeline-frame')&&(_0x3c1c73[_0x4069b6(0x1c2)][_0x4069b6(0xe5)][_0x4069b6(0x2b0)]=_0x4069b6(0x22c));}function handleFrameDragLeave(_0x4dfea9){const _0x4f3e1a=_0x321370;_0x4dfea9[_0x4f3e1a(0x1c2)][_0x4f3e1a(0x25e)][_0x4f3e1a(0xe8)](_0x4f3e1a(0x162))&&(_0x4dfea9[_0x4f3e1a(0x1c2)]['style']['backgroundColor']='');}function handleFrameDrop(_0x41ef8d){const _0xc39059=_0x321370;_0x41ef8d[_0xc39059(0xc1)]();if(!currentAnim||draggedFrameIndex===-0x1)return;const _0x32ec15=_0x41ef8d[_0xc39059(0x1c2)][_0xc39059(0x239)](_0xc39059(0x18f));if(!_0x32ec15)return;const _0x118cae=parseInt(_0x32ec15['getAttribute'](_0xc39059(0x17a)));if(draggedFrameIndex===_0x118cae){draggedFrameIndex=-0x1;return;}const _0x283aca=currentAnim['aframeList'][draggedFrameIndex];currentAnim[_0xc39059(0x2a1)][_0xc39059(0x130)](draggedFrameIndex,0x1);const _0x592d73=_0x118cae>draggedFrameIndex?_0x118cae:_0x118cae;currentAnim[_0xc39059(0x2a1)][_0xc39059(0x130)](_0x592d73,0x0,_0x283aca);if(currentFrameIndex===draggedFrameIndex)currentFrameIndex=_0x592d73;else{if(currentFrameIndex>draggedFrameIndex&&currentFrameIndex<=_0x592d73)currentFrameIndex--;else currentFrameIndex<draggedFrameIndex&&currentFrameIndex>=_0x592d73&&currentFrameIndex++;}currentFrame=currentAnim[_0xc39059(0x2a1)][currentFrameIndex]['frame'],renderTimeline(),saveProject(),draggedFrameIndex=-0x1;}function handleTimelineDrop(_0x344544){const _0x469828=_0x321370;_0x344544[_0x469828(0xc1)]();}function renderXY(){const _0x5e4d1d=_0x321370;if(showGrid){ctx['strokeStyle']=gridColor,ctx[_0x5e4d1d(0x140)]=0x1,ctx[_0x5e4d1d(0x24a)]();for(let _0x32c9ae=0x0;_0x32c9ae<=canvas[_0x5e4d1d(0x155)];_0x32c9ae+=gridSize){ctx[_0x5e4d1d(0x109)](_0x32c9ae,0x0),ctx['lineTo'](_0x32c9ae,canvas['height']);}ctx['stroke'](),ctx['beginPath']();for(let _0x134c5d=0x0;_0x134c5d<=canvas[_0x5e4d1d(0x246)];_0x134c5d+=gridSize){ctx[_0x5e4d1d(0x109)](0x0,_0x134c5d),ctx[_0x5e4d1d(0x25c)](canvas[_0x5e4d1d(0x155)],_0x134c5d);}ctx[_0x5e4d1d(0x241)]();}ctx['strokeStyle']=_0x5e4d1d(0xbd),ctx[_0x5e4d1d(0x140)]=0x1,ctx[_0x5e4d1d(0x167)]([0x5,0x5]),ctx['beginPath'](),ctx[_0x5e4d1d(0x109)](0x0,m_imageOriginPos['y']),ctx[_0x5e4d1d(0x25c)](canvas[_0x5e4d1d(0x155)],m_imageOriginPos['y']),ctx[_0x5e4d1d(0x241)](),ctx[_0x5e4d1d(0x24a)](),ctx[_0x5e4d1d(0x109)](m_imageOriginPos['x'],0x0),ctx['lineTo'](m_imageOriginPos['x'],canvas[_0x5e4d1d(0x246)]),ctx[_0x5e4d1d(0x241)](),ctx['setLineDash']([]),ctx['strokeStyle']=_0x5e4d1d(0x1f1),ctx[_0x5e4d1d(0x140)]=0x1,ctx[_0x5e4d1d(0x24a)](),ctx[_0x5e4d1d(0x109)](m_imageOriginPos['x']-0x8,m_imageOriginPos['y']),ctx[_0x5e4d1d(0x25c)](m_imageOriginPos['x']+0x8,m_imageOriginPos['y']),ctx['moveTo'](m_imageOriginPos['x'],m_imageOriginPos['y']-0x8),ctx[_0x5e4d1d(0x25c)](m_imageOriginPos['x'],m_imageOriginPos['y']+0x8),ctx[_0x5e4d1d(0x241)]();}function renderCanvas(_0x33ed2b=-0x1){const _0x1c7158=_0x321370;_0x33ed2b!==-0x1&&console[_0x1c7158(0x2a2)](_0x1c7158(0x161),_0x33ed2b);ctx[_0x1c7158(0x25b)](0x0,0x0,canvas[_0x1c7158(0x155)],canvas['height']),renderXY();if(!currentFrame){showPreviewWithMouse&&drawMouseFollowPreview(ctx);ctx[_0x1c7158(0x1d5)]();return;}ctx[_0x1c7158(0x1d5)](),ctx[_0x1c7158(0x10d)](),ctx[_0x1c7158(0x27e)](zoomLevel,zoomLevel);let _0x1980fb=null;if(isShowExpression&&currentSelectedExpression&&currentFrameIndex>=0x0){const _0x1e074b=expressions[_0x1c7158(0x14a)](_0x2ccc7a=>_0x2ccc7a['name']===currentSelectedExpression);_0x1e074b&&currentFrameIndex<_0x1e074b[_0x1c7158(0x1aa)][_0x1c7158(0x145)]&&(_0x1980fb=_0x1e074b[_0x1c7158(0x1aa)][currentFrameIndex]);}if(currentAnim&&currentFrameIndex>=0x0&&currentFrameIndex<currentAnim[_0x1c7158(0x2a1)][_0x1c7158(0x145)]&&currentAnim[_0x1c7158(0x2a1)][currentFrameIndex]){const _0x5b7c47=currentAnim[_0x1c7158(0x2a1)][currentFrameIndex];_0x5b7c47[_0x1c7158(0xfa)](ctx,currentSprite,m_imageOriginPos['x']/zoomLevel,m_imageOriginPos['y']/zoomLevel,_0x1980fb,globalHorizontalMirrorFlag,0x1,0x0);}if(!isPlaying&&isEditingExpressionRect&&currentAnim&&currentFrameIndex>=0x0&&currentAnim['aframeList'][currentFrameIndex]){const _0xd657e8=currentAnim[_0x1c7158(0x2a1)][currentFrameIndex];if(_0xd657e8[_0x1c7158(0x1f8)]){const _0x12d2c6=_0xd657e8[_0x1c7158(0x1f8)];ctx[_0x1c7158(0x1a4)]=isEditingExpressionRect?_0x1c7158(0x242):_0x1c7158(0x240),ctx[_0x1c7158(0x140)]=0x2/zoomLevel,ctx[_0x1c7158(0xea)](m_imageOriginPos['x']/zoomLevel+_0x12d2c6['x'],m_imageOriginPos['y']/zoomLevel-_0x12d2c6['y'],_0x12d2c6[_0x1c7158(0x155)],_0x12d2c6[_0x1c7158(0x246)]);const _0x33f5f2=[{'x':m_imageOriginPos['x']/zoomLevel+_0x12d2c6['x'],'y':m_imageOriginPos['y']/zoomLevel-_0x12d2c6['y']},{'x':m_imageOriginPos['x']/zoomLevel+_0x12d2c6['x']+_0x12d2c6['width'],'y':m_imageOriginPos['y']/zoomLevel-_0x12d2c6['y']},{'x':m_imageOriginPos['x']/zoomLevel+_0x12d2c6['x']+_0x12d2c6[_0x1c7158(0x155)],'y':m_imageOriginPos['y']/zoomLevel-_0x12d2c6['y']+_0x12d2c6[_0x1c7158(0x246)]},{'x':m_imageOriginPos['x']/zoomLevel+_0x12d2c6['x'],'y':m_imageOriginPos['y']/zoomLevel-_0x12d2c6['y']+_0x12d2c6[_0x1c7158(0x246)]}];ctx[_0x1c7158(0xc4)]=_0x1c7158(0x242),_0x33f5f2[_0x1c7158(0x118)](_0xf81fdd=>{const _0x32cea1=_0x1c7158;ctx[_0x32cea1(0x24a)](),ctx[_0x32cea1(0x17e)](_0xf81fdd['x'],_0xf81fdd['y'],0x4/zoomLevel,0x0,0x2*Math['PI']),ctx[_0x32cea1(0x1c7)]();});}}if(selectedModuleIndices[_0x1c7158(0x145)]>0x0&&currentFrame)for(const _0x143d1f of selectedModuleIndices){const _0x1e6a5f=currentFrame[_0x1c7158(0x15d)][_0x143d1f];if(!_0x1e6a5f)continue;const _0x1c5ef8=_0x1e6a5f[_0x1c7158(0x11f)];if(!_0x1c5ef8)continue;const _0x3da707=currentSprite[_0x1c7158(0x182)](_0x1c5ef8[_0x1c7158(0xfb)]);if(!_0x3da707||!_0x3da707[_0x1c7158(0x1cc)][_0x1c5ef8[_0x1c7158(0x29c)]])continue;const _0x151547=_0x3da707[_0x1c7158(0x1cc)][_0x1c5ef8['imageModuleId']];let _0x207fe6=_0x151547[_0x1c7158(0x155)],_0x5497aa=_0x151547[_0x1c7158(0x246)];_0x1e6a5f['scale']&&(_0x207fe6*=_0x1e6a5f[_0x1c7158(0x27e)],_0x5497aa*=_0x1e6a5f[_0x1c7158(0x27e)]);_0x1e6a5f[_0x1c7158(0x23b)]&0x4&&([_0x207fe6,_0x5497aa]=[_0x5497aa,_0x207fe6]);const _0x31d541=_0x143d1f===selectedModuleIndex,_0xc0a193=_0x31d541?'blue':_0x1c7158(0x210),_0x337398=_0x31d541?0x2/zoomLevel:0x1/zoomLevel;ctx[_0x1c7158(0x1a4)]=_0xc0a193,ctx[_0x1c7158(0x140)]=_0x337398,ctx[_0x1c7158(0xea)](m_imageOriginPos['x']/zoomLevel+_0x1e6a5f['x']-0x2/zoomLevel,m_imageOriginPos['y']/zoomLevel-_0x1e6a5f['y']-0x2/zoomLevel,_0x207fe6+0x4/zoomLevel,_0x5497aa+0x4/zoomLevel);if(_0x31d541){const _0x1afaa6=[{'x':m_imageOriginPos['x']/zoomLevel+_0x1e6a5f['x'],'y':m_imageOriginPos['y']/zoomLevel-_0x1e6a5f['y']},{'x':m_imageOriginPos['x']/zoomLevel+_0x1e6a5f['x']+_0x207fe6,'y':m_imageOriginPos['y']/zoomLevel-_0x1e6a5f['y']},{'x':m_imageOriginPos['x']/zoomLevel+_0x1e6a5f['x']+_0x207fe6,'y':m_imageOriginPos['y']/zoomLevel-_0x1e6a5f['y']+_0x5497aa},{'x':m_imageOriginPos['x']/zoomLevel+_0x1e6a5f['x'],'y':m_imageOriginPos['y']/zoomLevel-_0x1e6a5f['y']+_0x5497aa}];ctx[_0x1c7158(0xc4)]=_0x1c7158(0x240),_0x1afaa6['forEach'](_0x3bfe7a=>{const _0x1d1171=_0x1c7158;ctx['beginPath'](),ctx[_0x1d1171(0x17e)](_0x3bfe7a['x'],_0x3bfe7a['y'],0x4/zoomLevel,0x0,0x2*Math['PI']),ctx[_0x1d1171(0x1c7)]();});const _0x8b25a1=m_imageOriginPos['x']/zoomLevel+_0x1e6a5f['x']+_0x207fe6+0xa/zoomLevel,_0x2ea2cd=m_imageOriginPos['y']/zoomLevel-_0x1e6a5f['y']+_0x5497aa;ctx['strokeStyle']=_0x1c7158(0x240),ctx[_0x1c7158(0x140)]=0x1/zoomLevel,ctx['beginPath'](),ctx[_0x1c7158(0x109)](_0x1afaa6[0x2]['x'],_0x1afaa6[0x2]['y']),ctx[_0x1c7158(0x25c)](_0x8b25a1,_0x2ea2cd),ctx['stroke'](),ctx[_0x1c7158(0xc4)]=_0x1c7158(0x240),ctx['beginPath'](),ctx[_0x1c7158(0x17e)](_0x8b25a1,_0x2ea2cd,0x4/zoomLevel,0x0,0x2*Math['PI']),ctx[_0x1c7158(0x1c7)](),ctx[_0x1c7158(0xc4)]=_0x1c7158(0x1d3),ctx[_0x1c7158(0x12f)]=0xc/zoomLevel+_0x1c7158(0x157),ctx[_0x1c7158(0xd0)](_0x1c7158(0x23c)+Math[_0x1c7158(0x2af)](_0x1e6a5f['x']),m_imageOriginPos['x']/zoomLevel+_0x1e6a5f['x']+_0x207fe6/0x2+0xa/zoomLevel,m_imageOriginPos['y']/zoomLevel-_0x1e6a5f['y']-_0x5497aa/0x2-0xa/zoomLevel),ctx['fillText'](_0x1c7158(0xb7)+Math[_0x1c7158(0x2af)](_0x1e6a5f['y']),m_imageOriginPos['x']/zoomLevel+_0x1e6a5f['x']+_0x207fe6/0x2+0xa/zoomLevel,m_imageOriginPos['y']/zoomLevel-_0x1e6a5f['y']-_0x5497aa/0x2);}}else{if(selectedModuleIndex!==-0x1){}}if(isMarqueeSelecting&&currentFrame){const _0x35c474=Math[_0x1c7158(0x1e9)](marqueeStartX,marqueeEndX),_0x1ada09=Math[_0x1c7158(0x1e9)](marqueeStartY,marqueeEndY),_0x1b6d78=Math['max'](marqueeStartX,marqueeEndX),_0x3c923b=Math[_0x1c7158(0x227)](marqueeStartY,marqueeEndY),_0x290a98=m_imageOriginPos['x']/zoomLevel+_0x35c474,_0x3ba044=m_imageOriginPos['y']/zoomLevel-_0x1ada09,_0x4b5804=_0x1b6d78-_0x35c474,_0x1d858a=_0x1ada09-_0x3c923b;ctx[_0x1c7158(0x167)]([0x5/zoomLevel,0x5/zoomLevel]),ctx[_0x1c7158(0x1a4)]=_0x1c7158(0x1f1),ctx[_0x1c7158(0x140)]=0x1/zoomLevel,ctx[_0x1c7158(0xea)](_0x290a98,_0x3ba044,_0x4b5804,_0x1d858a),ctx[_0x1c7158(0xc4)]=_0x1c7158(0x20b),ctx[_0x1c7158(0x172)](_0x290a98,_0x3ba044,_0x4b5804,_0x1d858a),ctx[_0x1c7158(0x167)]([]);}ctx['restore'](),showPreviewWithMouse&&drawMouseFollowPreview(ctx);}function selectSprite(_0x105260){const _0x4f58c8=_0x321370;if(_0x105260<0x0||_0x105260>=currentProject[_0x4f58c8(0x27a)]['length'])return;currentSprite=currentProject[_0x4f58c8(0x27a)][_0x105260],currentAnim=null,currentFrame=null,currentFrameIndex=0x0,selectedModuleIndex=-0x1,selectedModuleIndices=[],renderSpriteList(),renderAnimList(),renderTimeline(),renderCanvas(0x10),renderImagesList(),document['getElementById'](_0x4f58c8(0x295))['textContent']=_0x4f58c8(0x29d);}function selectAnim(_0x583980){const _0x4d2d50=_0x321370;if(!currentSprite||_0x583980<0x0||_0x583980>=currentSprite[_0x4d2d50(0x253)][_0x4d2d50(0x145)])return;currentAnim=currentSprite['mAnimList'][_0x583980],currentFrame=currentAnim[_0x4d2d50(0x2a1)]['length']>0x0?currentAnim[_0x4d2d50(0x2a1)][0x0][_0x4d2d50(0x229)]:null,currentFrameIndex=0x0,selectedModuleIndex=-0x1,selectedModuleIndices=[],renderAnimList(),renderTimeline(),renderCanvas(0x11),document['getElementById'](_0x4d2d50(0x295))['textContent']=currentAnim[_0x4d2d50(0x251)]+(currentFrame?_0x4d2d50(0x175)+(currentFrameIndex+0x1):_0x4d2d50(0x149));}function selectFrame(_0x272646){const _0x526af2=_0x321370;if(!currentAnim||_0x272646<0x0||_0x272646>=currentAnim[_0x526af2(0x2a1)]['length'])return;currentFrameIndex=_0x272646,currentFrame=currentAnim['aframeList'][_0x272646][_0x526af2(0x229)],selectedModuleIndex=-0x1,selectedModuleIndices=[],renderTimeline(),renderCanvas(0x12),document['getElementById'](_0x526af2(0x295))['textContent']=currentAnim[_0x526af2(0x251)]+_0x526af2(0x175)+(currentFrameIndex+0x1);}function togglePlayAnimation(){const _0x160edc=_0x321370;if(!currentAnim||currentAnim[_0x160edc(0x2a1)][_0x160edc(0x145)]===0x0){alert(_0x160edc(0x2b1));return;}isPlaying=!isPlaying;const _0x3ea56e=document[_0x160edc(0x1af)](_0x160edc(0x254));_0x3ea56e[_0x160edc(0x146)]=isPlaying?'暂停':'播放';if(isPlaying)lastFrameTime=performance[_0x160edc(0x139)](),playAnimation();else animationFrameId&&cancelAnimationFrame(animationFrameId);}function playAnimation(_0x5c2109){const _0x16d648=_0x321370;if(!isPlaying)return;if(!_0x5c2109)_0x5c2109=performance[_0x16d648(0x139)]();const _0x41daaa=_0x5c2109-lastFrameTime;_0x41daaa>=animationSpeed&&(lastFrameTime=_0x5c2109,currentFrameIndex=(currentFrameIndex+0x1)%currentAnim[_0x16d648(0x2a1)][_0x16d648(0x145)],currentFrame=currentAnim[_0x16d648(0x2a1)][currentFrameIndex]['frame'],renderTimeline(),renderCanvas(0x13),document[_0x16d648(0x1af)](_0x16d648(0x295))['textContent']=currentAnim[_0x16d648(0x251)]+_0x16d648(0x175)+(currentFrameIndex+0x1)),animationFrameId=requestAnimationFrame(playAnimation);}let hidDebug=![];function showDebugInfo(){const _0x37f82b=_0x321370;let _0x44df95=document[_0x37f82b(0x1af)](_0x37f82b(0xb8));if(_0x44df95){_0x44df95[_0x37f82b(0x170)]=hidDebug,hidDebug=!hidDebug;return;}_0x44df95=document[_0x37f82b(0x255)](_0x37f82b(0x2ac)),_0x44df95['id']=_0x37f82b(0xb8),_0x44df95[_0x37f82b(0xe5)][_0x37f82b(0x1d0)]=_0x37f82b(0x2a7);const _0x199c93=document['createElement'](_0x37f82b(0x2ac));_0x199c93[_0x37f82b(0xe5)][_0x37f82b(0x1c8)]='10px';const _0x35acc7=document['createElement']('h4');_0x35acc7[_0x37f82b(0xe5)]['marginTop']='0',_0x35acc7['style'][_0x37f82b(0x2ad)]=_0x37f82b(0x18b),_0x35acc7[_0x37f82b(0x146)]='控制台调试信息';const _0x40bccc=document[_0x37f82b(0x255)](_0x37f82b(0x2ac));_0x40bccc['id']=_0x37f82b(0x147),_0x199c93[_0x37f82b(0x1ff)](_0x35acc7),_0x199c93[_0x37f82b(0x1ff)](_0x40bccc),_0x44df95[_0x37f82b(0x1ff)](_0x199c93),document['body'][_0x37f82b(0x1ff)](_0x44df95),window[_0x37f82b(0xc8)]=console[_0x37f82b(0x2a2)],window[_0x37f82b(0x128)]=console[_0x37f82b(0x1b1)],window['oldConsoleError']=console['error'],console[_0x37f82b(0x2a2)]=function(){const _0x55cb32=_0x37f82b;oldConsoleLog['apply'](console,arguments);const _0x5a2e16=document[_0x55cb32(0x255)](_0x55cb32(0x2ac));_0x5a2e16['textContent']='LOG:\x20'+Array['from'](arguments)[_0x55cb32(0x202)]('\x20'),_0x5a2e16['style'][_0x55cb32(0x2ad)]=_0x55cb32(0x18b),_0x5a2e16[_0x55cb32(0xe5)][_0x55cb32(0x1d6)]=_0x55cb32(0x1dc);if(_0x5a2e16[_0x55cb32(0x146)][_0x55cb32(0x144)]('{')||_0x5a2e16['textContent'][_0x55cb32(0x144)]('['))try{const _0x37ed3b=JSON[_0x55cb32(0x2aa)](_0x5a2e16[_0x55cb32(0x146)][_0x55cb32(0xc3)](0x4));_0x5a2e16[_0x55cb32(0x146)]=_0x55cb32(0x275)+JSON[_0x55cb32(0x18e)](_0x37ed3b,null,0x2);}catch(_0x43c660){}document[_0x55cb32(0x1af)](_0x55cb32(0x147))[_0x55cb32(0x1ff)](_0x5a2e16),document[_0x55cb32(0x1af)]('debug-info')[_0x55cb32(0x1df)]=document[_0x55cb32(0x1af)]('debug-info')[_0x55cb32(0x195)];},console['warn']=function(){const _0x51dbaf=_0x37f82b;oldConsoleWarn[_0x51dbaf(0x101)](console,arguments);const _0x50cbc6=document[_0x51dbaf(0x255)](_0x51dbaf(0x2ac));_0x50cbc6[_0x51dbaf(0x146)]=_0x51dbaf(0x205)+Array[_0x51dbaf(0x293)](arguments)[_0x51dbaf(0x202)]('\x20'),_0x50cbc6[_0x51dbaf(0xe5)][_0x51dbaf(0x2ad)]=_0x51dbaf(0x1bd),_0x50cbc6[_0x51dbaf(0xe5)][_0x51dbaf(0x1d6)]='2px',document['getElementById']('debug-logs')[_0x51dbaf(0x1ff)](_0x50cbc6),document[_0x51dbaf(0x1af)](_0x51dbaf(0xb8))[_0x51dbaf(0x1df)]=document[_0x51dbaf(0x1af)](_0x51dbaf(0xb8))['scrollHeight'];},console[_0x37f82b(0x166)]=function(){const _0x20e9b8=_0x37f82b;oldConsoleError[_0x20e9b8(0x101)](console,arguments);const _0x2f5d3b=document[_0x20e9b8(0x255)](_0x20e9b8(0x2ac));_0x2f5d3b[_0x20e9b8(0x146)]='ERROR:\x20'+Array[_0x20e9b8(0x293)](arguments)[_0x20e9b8(0x202)]('\x20'),_0x2f5d3b[_0x20e9b8(0xe5)][_0x20e9b8(0x2ad)]=_0x20e9b8(0x219),_0x2f5d3b[_0x20e9b8(0xe5)][_0x20e9b8(0x1d6)]=_0x20e9b8(0x1dc),document[_0x20e9b8(0x1af)](_0x20e9b8(0x147))['appendChild'](_0x2f5d3b),document[_0x20e9b8(0x1af)](_0x20e9b8(0xb8))[_0x20e9b8(0x1df)]=document[_0x20e9b8(0x1af)](_0x20e9b8(0xb8))['scrollHeight'];},console['log']('调试面板已初始化');}function handleShowExpressionRectChange(){const _0x52c9f2=_0x321370;if(!currentAnim||!currentFrame||currentFrameIndex<0x0){this[_0x52c9f2(0x249)]=![],alert('请先选择一个帧');return;}this['checked']?(!currentAnim[_0x52c9f2(0x2a1)][currentFrameIndex][_0x52c9f2(0x1f8)]&&(currentAnim['aframeList'][currentFrameIndex][_0x52c9f2(0x1f8)]={'x':0x0,'y':0x0,'width':0x32,'height':0x3c}),isEditingExpressionRect=!![],selectedModuleIndex=-0x1,selectedModuleIndices=[]):isEditingExpressionRect=![],renderCanvas();}function handleHorizontalMirrorChange(){const _0x39242b=_0x321370;globalHorizontalMirrorFlag=this[_0x39242b(0x249)]?0x1:0x0,console[_0x39242b(0x2a2)](_0x39242b(0x1ab),globalHorizontalMirrorFlag),renderCanvas();}function updateExpressionCheckboxState(){const _0x975fa9=_0x321370,_0x4e658b=document[_0x975fa9(0x1af)]('add-expression-rect');if(_0x4e658b&&currentFrameIndex>=0x0)_0x4e658b[_0x975fa9(0x249)]=isEditingExpressionRect;else _0x4e658b&&(_0x4e658b[_0x975fa9(0x249)]=![]);}const originalSelectFrame=selectFrame;selectFrame=function(_0x3bb3f8){const _0x44d764=_0x321370;originalSelectFrame(_0x3bb3f8),currentAnim&&currentFrameIndex>=0x0&&currentAnim[_0x44d764(0x2a1)][currentFrameIndex]&&(!currentAnim[_0x44d764(0x2a1)][currentFrameIndex][_0x44d764(0x1f8)]&&(currentAnim[_0x44d764(0x2a1)][currentFrameIndex]['expressionRect']={'x':0x0,'y':0x0,'width':0x32,'height':0x3c}));},document[_0x321370(0x29a)](_0x321370(0x134),function(){const _0x1a819e=_0x321370,_0x1260d9=document[_0x1a819e(0x1af)](_0x1a819e(0x16f)),_0x1a7c55=document[_0x1a819e(0x1af)](_0x1a819e(0x2a6)),_0x18e92c=document[_0x1a819e(0x1af)]('animation-control-section'),_0x52aecf=document[_0x1a819e(0x1af)](_0x1a819e(0xef));_0x1260d9&&_0x1a7c55&&_0x18e92c&&_0x52aecf&&(_0x1260d9['addEventListener'](_0x1a819e(0x1a5),function(){const _0x9bacd4=_0x1a819e;_0x1260d9[_0x9bacd4(0x25e)][_0x9bacd4(0xff)](_0x9bacd4(0x1c4)),_0x1a7c55[_0x9bacd4(0x25e)][_0x9bacd4(0x1dd)](_0x9bacd4(0x1c4)),_0x18e92c[_0x9bacd4(0xe5)][_0x9bacd4(0x1b0)]='flex',_0x52aecf[_0x9bacd4(0xe5)][_0x9bacd4(0x1b0)]=_0x9bacd4(0x230),isMultiDragging&&(isMultiDragging=![]),dragStartModuleStates['length']>0x0&&(dragStartModuleStates=[]);}),_0x1a7c55[_0x1a819e(0x29a)](_0x1a819e(0x1a5),function(){const _0x53d9b9=_0x1a819e;_0x1a7c55[_0x53d9b9(0x25e)][_0x53d9b9(0xff)](_0x53d9b9(0x1c4)),_0x1260d9[_0x53d9b9(0x25e)][_0x53d9b9(0x1dd)](_0x53d9b9(0x1c4)),_0x18e92c[_0x53d9b9(0xe5)][_0x53d9b9(0x1b0)]='none',_0x52aecf[_0x53d9b9(0xe5)][_0x53d9b9(0x1b0)]='flex',initExpressionList(),initExpressionGroupButtons();}));});let currentSelectedExpression=null,currentExpressionGroup=_0x321370(0x20f);function initExpressionGroupButtons(){const _0x5391e1=_0x321370,_0x53d952=document[_0x5391e1(0x1e2)]('#expression-group-buttons\x20.tab-button');_0x53d952[_0x5391e1(0x118)](_0x3352e2=>{const _0x561b4b=_0x5391e1;_0x3352e2[_0x561b4b(0x29a)](_0x561b4b(0x1a5),function(){const _0x417a21=_0x561b4b;_0x53d952[_0x417a21(0x118)](_0x4fcc7b=>_0x4fcc7b[_0x417a21(0x25e)]['remove'](_0x417a21(0x1c4))),this[_0x417a21(0x25e)]['add'](_0x417a21(0x1c4)),currentExpressionGroup=this['dataset'][_0x417a21(0x226)],initExpressionList();});});}function initExpressionList(){const _0x24ebb8=_0x321370,_0x3f03eb=document['getElementById'](_0x24ebb8(0x123));if(!_0x3f03eb)return;_0x3f03eb[_0x24ebb8(0x24b)]='';if(!expressions||expressions[_0x24ebb8(0x145)]===0x0){console[_0x24ebb8(0x2a2)](_0x24ebb8(0x13c),window[_0x24ebb8(0x1f7)],expressions);return;}const _0x55b12d=document[_0x24ebb8(0x255)](_0x24ebb8(0x2ac));_0x55b12d['className']=_0x24ebb8(0x127);let _0x469f16=[];switch(currentExpressionGroup){case _0x24ebb8(0x20f):_0x469f16=expressions;break;case'common':_0x469f16=expressions[_0x24ebb8(0x285)](_0x29d25c=>_0x29d25c[_0x24ebb8(0x2b3)]===0x0);break;case _0x24ebb8(0x193):_0x469f16=expressions[_0x24ebb8(0x285)](_0x46ff2b=>_0x46ff2b[_0x24ebb8(0x2b3)]===0x1);break;case'female':_0x469f16=expressions[_0x24ebb8(0x285)](_0x10855f=>_0x10855f[_0x24ebb8(0x2b3)]===0x2);break;}if(_0x469f16[_0x24ebb8(0x145)]===0x0){const _0x47777b=document[_0x24ebb8(0x255)]('div');_0x47777b['style']['textAlign']=_0x24ebb8(0x179),_0x47777b[_0x24ebb8(0xe5)]['padding']=_0x24ebb8(0xbe),_0x47777b[_0x24ebb8(0xe5)][_0x24ebb8(0x2ad)]=_0x24ebb8(0x210),_0x47777b[_0x24ebb8(0x146)]='当前分组没有表情',_0x55b12d[_0x24ebb8(0x1ff)](_0x47777b);}else _0x469f16[_0x24ebb8(0x118)](_0x1c0eda=>{const _0x3b9db1=_0x24ebb8,_0x461399=document[_0x3b9db1(0x255)]('div');_0x461399[_0x3b9db1(0x171)]=_0x3b9db1(0xfe)+(currentSelectedExpression===_0x1c0eda['name']?_0x3b9db1(0x1bc):''),_0x461399['dataset'][_0x3b9db1(0x218)]=_0x1c0eda['name'];const _0x1317e3=document[_0x3b9db1(0x255)](_0x3b9db1(0xf2));_0x1317e3[_0x3b9db1(0x171)]=_0x3b9db1(0x16e),_0x1317e3[_0x3b9db1(0x13a)]=_0x1c0eda[_0x3b9db1(0x26e)][0x0],_0x1317e3[_0x3b9db1(0x1ea)]=_0x1c0eda['name'],_0x1317e3[_0x3b9db1(0x1e5)]=function(){const _0x130650=_0x3b9db1;this['style']['display']=_0x130650(0x230);const _0x5264be=document['createElement']('div');_0x5264be['style']['width']=_0x130650(0x17d),_0x5264be[_0x130650(0xe5)]['height']=_0x130650(0x17d),_0x5264be[_0x130650(0xe5)]['backgroundColor']='#f0f0f0',_0x5264be[_0x130650(0xe5)][_0x130650(0x1cb)]=_0x130650(0x152),_0x5264be['style'][_0x130650(0x12e)]=_0x130650(0x142),_0x5264be[_0x130650(0xe5)][_0x130650(0x1b0)]='flex',_0x5264be[_0x130650(0xe5)][_0x130650(0x217)]=_0x130650(0x179),_0x5264be[_0x130650(0xe5)]['justifyContent']='center',_0x5264be['textContent']=_0x1c0eda[_0x130650(0x251)],this['parentNode'][_0x130650(0x1ff)](_0x5264be);};const _0x408508=document[_0x3b9db1(0x255)](_0x3b9db1(0x2ac));_0x408508['textContent']=_0x1c0eda['name'],_0x408508['style']['fontSize']='12px',_0x461399[_0x3b9db1(0x1ff)](_0x1317e3),_0x461399['appendChild'](_0x408508),_0x461399['addEventListener'](_0x3b9db1(0x1a5),function(){const _0x12c75a=_0x3b9db1;document['querySelectorAll'](_0x12c75a(0x1f2))['forEach'](_0x306836=>{const _0x55a97d=_0x12c75a;_0x306836[_0x55a97d(0x25e)][_0x55a97d(0x1dd)](_0x55a97d(0x1bc));}),this['classList'][_0x12c75a(0xff)](_0x12c75a(0x1bc)),currentSelectedExpression=_0x1c0eda[_0x12c75a(0x251)],console[_0x12c75a(0x2a2)](_0x12c75a(0x1da)+_0x1c0eda[_0x12c75a(0x251)]),renderCanvas(0x14);}),_0x55b12d[_0x3b9db1(0x1ff)](_0x461399);});_0x3f03eb['appendChild'](_0x55b12d);}function drawFrameExpression(){const _0x1dd76f=_0x321370;if(!currentAnim||!currentFrameIndex||currentFrameIndex<0x0||!currentAnim[_0x1dd76f(0x2a1)][currentFrameIndex])return;const _0x19dbb5=currentAnim[_0x1dd76f(0x2a1)][currentFrameIndex],_0x257160=_0x19dbb5[_0x1dd76f(0x1f8)];if(!_0x257160||!_0x257160['x']||!_0x257160['y']||!_0x257160['width']||!_0x257160[_0x1dd76f(0x246)])return;if(!currentSelectedExpression||!expressions)return;const _0x3c0148=expressions[_0x1dd76f(0x14a)](_0x2aa7d9=>_0x2aa7d9['name']===currentSelectedExpression);if(!_0x3c0148||!_0x3c0148[_0x1dd76f(0x26e)]||_0x3c0148[_0x1dd76f(0x26e)][_0x1dd76f(0x145)]===0x0){ctx[_0x1dd76f(0xc4)]=_0x1dd76f(0x15f),ctx[_0x1dd76f(0x172)](_0x257160['x'],_0x257160['y'],_0x257160['width'],_0x257160['height']),ctx[_0x1dd76f(0xc4)]=_0x1dd76f(0x1d2),ctx['font']=_0x1dd76f(0x10c),ctx[_0x1dd76f(0xce)]=_0x1dd76f(0x179),ctx['textBaseline']=_0x1dd76f(0xeb),ctx[_0x1dd76f(0xd0)](currentSelectedExpression,_0x257160['x']+_0x257160[_0x1dd76f(0x155)]/0x2,_0x257160['y']+_0x257160['height']/0x2);return;}const _0x3e032f=new Image();_0x3e032f[_0x1dd76f(0x13a)]=_0x3c0148[_0x1dd76f(0x26e)][0x0],_0x3e032f[_0x1dd76f(0x223)]=function(){const _0x1f3575=_0x1dd76f,_0x5f18ee=document[_0x1f3575(0x255)](_0x1f3575(0x225)),_0x13527c=_0x5f18ee[_0x1f3575(0x13d)]('2d');_0x5f18ee['width']=_0x257160[_0x1f3575(0x155)],_0x5f18ee[_0x1f3575(0x246)]=_0x257160['height'],_0x13527c[_0x1f3575(0x14f)](_0x3e032f,0x0,0x0,_0x257160[_0x1f3575(0x155)],_0x257160[_0x1f3575(0x246)]),ctx[_0x1f3575(0x14f)](_0x5f18ee,_0x257160['x'],_0x257160['y']);},_0x3e032f[_0x1dd76f(0x1e5)]=function(){const _0x294344=_0x1dd76f;ctx[_0x294344(0xc4)]=_0x294344(0x15f),ctx['fillRect'](_0x257160['x'],_0x257160['y'],_0x257160[_0x294344(0x155)],_0x257160[_0x294344(0x246)]),ctx[_0x294344(0xc4)]=_0x294344(0x1d2),ctx[_0x294344(0x12f)]=_0x294344(0x10c),ctx[_0x294344(0xce)]=_0x294344(0x179),ctx[_0x294344(0xdb)]='middle',ctx[_0x294344(0xd0)](currentSelectedExpression,_0x257160['x']+_0x257160[_0x294344(0x155)]/0x2,_0x257160['y']+_0x257160[_0x294344(0x246)]/0x2);};}function init(){const _0x3a164f=_0x321370;imageManager=new LWImageManager(),updateImageOriginPos();const _0xa623e=loadProject();if(!_0xa623e){currentProject=new Project();const _0x52d2eb=new Sprite(_0x3a164f(0x120));currentProject[_0x3a164f(0x136)](_0x52d2eb);const _0x14f27c=new Anim(_0x3a164f(0x252));_0x52d2eb[_0x3a164f(0x253)][_0x3a164f(0x11c)](_0x14f27c);const _0x53298d=new Frame(),_0x44b373=new AnimFrame(_0x53298d,!![]);_0x14f27c[_0x3a164f(0x2a1)][_0x3a164f(0x11c)](_0x44b373),currentSprite=_0x52d2eb,currentAnim=_0x14f27c,currentFrame=_0x53298d;}switchTab(_0x3a164f(0x116)),renderSpriteList(),renderAnimList(),renderTimeline(),renderImagesList(),resizeCanvas(),bindEvents(),document[_0x3a164f(0x1af)]('show-all-modules')[_0x3a164f(0x29a)](_0x3a164f(0x14c),drawCurrentImage),window[_0x3a164f(0x29a)](_0x3a164f(0x173),resizeCanvas),document['getElementById'](_0x3a164f(0x23e))['addEventListener']('click',handleZoomIn),document['getElementById'](_0x3a164f(0x1a2))[_0x3a164f(0x29a)]('click',handleZoomOut),document[_0x3a164f(0x1af)](_0x3a164f(0x29e))[_0x3a164f(0x29a)](_0x3a164f(0x1a5),handleZoomReset),imageCanvas[_0x3a164f(0x29a)](_0x3a164f(0x1fa),handleMouseWheel),imageCanvas[_0x3a164f(0x29a)](_0x3a164f(0xcf),showImageMousePosition),canvas[_0x3a164f(0x29a)](_0x3a164f(0xcf),showMousePosition);!imagePreviewCanvas&&(imagePreviewCanvas=document[_0x3a164f(0x1af)]('image-preview-canvas'),imagePreviewCtx=imagePreviewCanvas[_0x3a164f(0x13d)]('2d'));!originalPreviewCanvas&&(originalPreviewCanvas=document[_0x3a164f(0x1af)](_0x3a164f(0xee)),originalPreviewCtx=originalPreviewCanvas[_0x3a164f(0x13d)]('2d'));!flipHorizontalPreviewCanvas&&(flipHorizontalPreviewCanvas=document[_0x3a164f(0x1af)](_0x3a164f(0x11e)),flipHorizontalPreviewCtx=flipHorizontalPreviewCanvas[_0x3a164f(0x13d)]('2d'));!flipVerticalPreviewCanvas&&(flipVerticalPreviewCanvas=document['getElementById'](_0x3a164f(0x10a)),flipVerticalPreviewCtx=flipVerticalPreviewCanvas['getContext']('2d'));!flipBothPreviewCanvas&&(flipBothPreviewCanvas=document['getElementById'](_0x3a164f(0xdc)),flipBothPreviewCtx=flipBothPreviewCanvas[_0x3a164f(0x13d)]('2d'));const _0xf8c83a=document[_0x3a164f(0x255)](_0x3a164f(0x270));_0xf8c83a[_0x3a164f(0x146)]='检查Canvas状态',_0xf8c83a[_0x3a164f(0xe5)][_0x3a164f(0x1d0)]=_0x3a164f(0x291),_0xf8c83a[_0x3a164f(0xe5)][_0x3a164f(0x1b0)]=_0x3a164f(0x230),_0xf8c83a[_0x3a164f(0x29a)](_0x3a164f(0x1a5),function(){const _0x22b22e=_0x3a164f;showDebugInfo(),debugCanvasState(),currentImage&&imagePreviewCanvas&&(console[_0x22b22e(0x2a2)](_0x22b22e(0x163)),renderImagePreview());}),document[_0x3a164f(0x235)][_0x3a164f(0x1ff)](_0xf8c83a);const _0x371a29=document['getElementById']('image-dropdown');_0x371a29&&_0x371a29['addEventListener']('change',function(){const _0xc2395=_0x3a164f,_0x23e3bf=this[_0xc2395(0x11b)];console[_0xc2395(0x2a2)](_0xc2395(0x12a),_0x23e3bf);if(_0x23e3bf&&currentSprite){console['log'](_0xc2395(0x169),_0x23e3bf);for(let _0x2d8c0d of currentSprite[_0xc2395(0x264)]){console[_0xc2395(0x2a2)](_0xc2395(0x20e),_0x2d8c0d['id'],_0x2d8c0d[_0xc2395(0x251)]);}const _0xfa44e6=currentSprite[_0xc2395(0x182)](_0x23e3bf);if(_0xfa44e6){console[_0xc2395(0x2a2)](_0xc2395(0x1f0),_0xfa44e6[_0xc2395(0x251)]),previewImageId=_0x23e3bf,previewImage=_0xfa44e6[_0xc2395(0x1e8)],console[_0xc2395(0x2a2)](_0xc2395(0x22a),previewImageId);!imagePreviewCanvas&&(imagePreviewCanvas=document[_0xc2395(0x1af)](_0xc2395(0x1f6)),imagePreviewCanvas&&(imagePreviewCtx=imagePreviewCanvas[_0xc2395(0x13d)]('2d')));if(imagePreviewCanvas&&previewImage){}console[_0xc2395(0x2a2)](_0xc2395(0x1eb)),renderImagePreview(0x1);}else console[_0xc2395(0x1b1)](_0xc2395(0x198),_0x23e3bf);}else console[_0xc2395(0x1b1)](_0xc2395(0x2a8));});document['getElementById'](_0x3a164f(0x133))['addEventListener'](_0x3a164f(0x1a5),function(){previewZoomLevel=Math['min'](previewZoomLevel+0.1,0x5),renderImagePreview();}),document[_0x3a164f(0x1af)]('zoom-out-btn')[_0x3a164f(0x29a)](_0x3a164f(0x1a5),function(){const _0x2e6753=_0x3a164f;previewZoomLevel=Math[_0x2e6753(0x227)](previewZoomLevel-0.1,0.1),renderImagePreview();}),document['getElementById'](_0x3a164f(0xf7))[_0x3a164f(0x29a)]('click',function(){previewZoomLevel=0x1,renderImagePreview();});const _0x218a3c=document[_0x3a164f(0x1e2)]('.transformation-item');_0x218a3c[_0x3a164f(0x118)](_0x133e3b=>{const _0x32faea=_0x3a164f;_0x133e3b['addEventListener'](_0x32faea(0x1a5),function(){const _0x78f97b=_0x32faea;selectedTransformation=this[_0x78f97b(0x238)]['type'],showPreviewWithMouse=!![],_0x218a3c[_0x78f97b(0x118)](_0x222bdb=>_0x222bdb[_0x78f97b(0xe5)][_0x78f97b(0x180)]=_0x78f97b(0x230)),this[_0x78f97b(0xe5)][_0x78f97b(0x180)]='2px\x20solid\x20#4CAF50';});}),imagePreviewCanvas&&(imagePreviewCanvas['addEventListener'](_0x3a164f(0x1a5),handlePreviewCanvasClick),imagePreviewCanvas['addEventListener'](_0x3a164f(0xcf),updateMousePosition)),canvas[_0x3a164f(0x29a)](_0x3a164f(0x1a5),function(_0x26c44c){showPreviewWithMouse&&selectedImageModule!==-0x1&&currentFrame&&addModuleToFrame(_0x26c44c);}),canvas[_0x3a164f(0x29a)](_0x3a164f(0xcf),function(_0x58faab){const _0x295b2a=_0x3a164f;showPreviewWithMouse&&selectedImageModule!==-0x1&&(mouseXOnCanvas=_0x58faab[_0x295b2a(0x200)],mouseYOnCanvas=_0x58faab[_0x295b2a(0x181)],renderCanvas());}),canvas[_0x3a164f(0x29a)](_0x3a164f(0xf6),function(){showPreviewWithMouse&&(showPreviewWithMouse=![],renderCanvas());}),loadExpression();}function bindEvents(){const _0x4d57f2=_0x321370;document['getElementById'](_0x4d57f2(0x1db))[_0x4d57f2(0x29a)](_0x4d57f2(0x1a5),showNewSpriteModal),document[_0x4d57f2(0x1af)](_0x4d57f2(0xc0))['addEventListener'](_0x4d57f2(0x1a5),createSprite),document[_0x4d57f2(0x1af)](_0x4d57f2(0x297))[_0x4d57f2(0x29a)](_0x4d57f2(0x1a5),hideNewSpriteModal),document[_0x4d57f2(0x1af)](_0x4d57f2(0x28d))[_0x4d57f2(0x29a)](_0x4d57f2(0x1a5),showNewAnimModal),document['getElementById'](_0x4d57f2(0xe0))[_0x4d57f2(0x29a)]('click',createAnim),document[_0x4d57f2(0x1af)](_0x4d57f2(0x213))[_0x4d57f2(0x29a)](_0x4d57f2(0x1a5),hideNewAnimModal),document[_0x4d57f2(0x1af)](_0x4d57f2(0x1c5))[_0x4d57f2(0x29a)]('click',showUploadImageModal),document[_0x4d57f2(0x1af)](_0x4d57f2(0x113))[_0x4d57f2(0x29a)](_0x4d57f2(0x1a5),uploadImage),document[_0x4d57f2(0x1af)](_0x4d57f2(0x2a3))['addEventListener'](_0x4d57f2(0x1a5),hideUploadImageModal),document[_0x4d57f2(0x1af)]('add-frame')[_0x4d57f2(0x29a)](_0x4d57f2(0x1a5),addFrame),document['getElementById'](_0x4d57f2(0xf1))[_0x4d57f2(0x29a)]('click',addFrameToEnd),document[_0x4d57f2(0x1af)](_0x4d57f2(0x1e0))[_0x4d57f2(0x29a)](_0x4d57f2(0x1a5),cloneFrame),document[_0x4d57f2(0x1af)](_0x4d57f2(0x211))[_0x4d57f2(0x29a)]('click',deleteFrame),document['getElementById']('delete-frame-module')[_0x4d57f2(0x29a)](_0x4d57f2(0x1a5),deleteFrameModule),document[_0x4d57f2(0x1af)](_0x4d57f2(0xb6))['addEventListener'](_0x4d57f2(0x1a5),copyModule),document[_0x4d57f2(0x1af)](_0x4d57f2(0x115))['addEventListener']('click',pasteModule),document[_0x4d57f2(0x1af)](_0x4d57f2(0x27b))['addEventListener'](_0x4d57f2(0x1a5),undoAction),document[_0x4d57f2(0x1af)](_0x4d57f2(0xcd))['addEventListener'](_0x4d57f2(0x1a5),redoAction),document[_0x4d57f2(0x29a)](_0x4d57f2(0x25f),function(_0x3ad18e){const _0x201fc1=_0x4d57f2,_0x18ebcf=_0x3ad18e[_0x201fc1(0xe7)]||_0x3ad18e[_0x201fc1(0x185)];if(_0x18ebcf&&!_0x3ad18e[_0x201fc1(0x12c)]&&!_0x3ad18e[_0x201fc1(0xc7)]){if(_0x3ad18e[_0x201fc1(0xc5)]==='c'||_0x3ad18e[_0x201fc1(0xc5)]==='C')_0x3ad18e['preventDefault'](),copyModule();else{if(_0x3ad18e['key']==='v'||_0x3ad18e[_0x201fc1(0xc5)]==='V')_0x3ad18e[_0x201fc1(0xc1)](),pasteModule();else{if(_0x3ad18e[_0x201fc1(0xc5)]==='d'||_0x3ad18e[_0x201fc1(0xc5)]==='D')_0x3ad18e['preventDefault'](),deleteFrameModule();else{if(_0x3ad18e[_0x201fc1(0xc5)]==='z'||_0x3ad18e[_0x201fc1(0xc5)]==='Z')_0x3ad18e[_0x201fc1(0xc1)](),undoAction();else(_0x3ad18e[_0x201fc1(0xc5)]==='y'||_0x3ad18e['key']==='Y')&&(_0x3ad18e['preventDefault'](),redoAction());}}}}}),document[_0x4d57f2(0x1af)](_0x4d57f2(0x178))[_0x4d57f2(0x29a)](_0x4d57f2(0x1a5),flipHorizontal),document['getElementById'](_0x4d57f2(0x24f))['addEventListener'](_0x4d57f2(0x1a5),flipVertical),document[_0x4d57f2(0x1af)](_0x4d57f2(0x137))['addEventListener'](_0x4d57f2(0x1a5),moveModuleUp),document['getElementById']('move-module-down')['addEventListener']('click',moveModuleDown),document['getElementById'](_0x4d57f2(0x1f3))['addEventListener'](_0x4d57f2(0x1a5),rotateModule),document[_0x4d57f2(0x1af)](_0x4d57f2(0x254))['addEventListener'](_0x4d57f2(0x1a5),togglePlayAnimation),document['getElementById'](_0x4d57f2(0x111))[_0x4d57f2(0x29a)](_0x4d57f2(0x1e3),changeAnimationSpeed),document[_0x4d57f2(0x1af)](_0x4d57f2(0x177))[_0x4d57f2(0x29a)]('click',function(){const _0x350f9f=_0x4d57f2;showGrid=!showGrid,this['textContent']=showGrid?_0x350f9f(0x156):_0x350f9f(0x207),renderCanvas(0x2);}),document['getElementById'](_0x4d57f2(0x1c5))[_0x4d57f2(0x29a)](_0x4d57f2(0x1a5),showUploadImageModal),document[_0x4d57f2(0x1af)](_0x4d57f2(0x113))['addEventListener'](_0x4d57f2(0x1a5),uploadImage),document['getElementById'](_0x4d57f2(0x2a3))[_0x4d57f2(0x29a)]('click',hideUploadImageModal),document[_0x4d57f2(0x1af)]('crop-module')[_0x4d57f2(0x29a)](_0x4d57f2(0x1a5),toggleCropping),document[_0x4d57f2(0x1af)]('edit-module')[_0x4d57f2(0x29a)]('click',toggleEditModule),document[_0x4d57f2(0x1af)]('save-module')[_0x4d57f2(0x29a)](_0x4d57f2(0x1a5),saveModule),document['getElementById']('save-project')[_0x4d57f2(0x29a)](_0x4d57f2(0x1a5),saveProject),document['getElementById']('new-project')[_0x4d57f2(0x29a)](_0x4d57f2(0x1a5),newProject),canvas[_0x4d57f2(0x29a)](_0x4d57f2(0x21f),handleFrameMouseDown),canvas[_0x4d57f2(0x29a)](_0x4d57f2(0xcf),handleFrameMouseMove),canvas[_0x4d57f2(0x29a)](_0x4d57f2(0x1c3),handleFrameMouseUp),canvas[_0x4d57f2(0x29a)]('mouseleave',handleFrameMouseUp),canvas[_0x4d57f2(0x29a)]('wheel',handleMouseWheel),canvas[_0x4d57f2(0x29a)](_0x4d57f2(0xcf),handleFrameMouseHover),document[_0x4d57f2(0x1af)](_0x4d57f2(0x1b4))['addEventListener'](_0x4d57f2(0x1a5),handleZoomIn),document[_0x4d57f2(0x1af)](_0x4d57f2(0x103))[_0x4d57f2(0x29a)](_0x4d57f2(0x1a5),handleZoomOut),document['getElementById'](_0x4d57f2(0x19b))[_0x4d57f2(0x29a)](_0x4d57f2(0x1a5),handleZoomReset),document[_0x4d57f2(0x29a)](_0x4d57f2(0x25f),handleKeyDown),document['addEventListener'](_0x4d57f2(0x100),handleKeyUp),imageCanvas[_0x4d57f2(0x29a)](_0x4d57f2(0xd3),handleImageMouseDblClick),imageCanvas[_0x4d57f2(0x29a)](_0x4d57f2(0x21f),handleImageMouseDown),imageCanvas['addEventListener']('mousemove',handleImageMouseMove),document[_0x4d57f2(0x29a)](_0x4d57f2(0x1c3),handleImageMouseUp),document[_0x4d57f2(0x1af)](_0x4d57f2(0xb9))[_0x4d57f2(0x29a)](_0x4d57f2(0x14c),function(){const _0x1a81cd=_0x4d57f2;isShowExpression=this[_0x1a81cd(0x249)],renderCanvas();}),document[_0x4d57f2(0x1af)](_0x4d57f2(0x22f))[_0x4d57f2(0x29a)](_0x4d57f2(0x14c),handleShowExpressionRectChange),document['getElementById'](_0x4d57f2(0x1a8))[_0x4d57f2(0x29a)](_0x4d57f2(0x14c),handleHorizontalMirrorChange);}