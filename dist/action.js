const _0x46983b=_0x2b13;(function(_0x43ff8f,_0xab6c15){const _0x1b0175=_0x2b13,_0x4da4ec=_0x43ff8f();while(!![]){try{const _0x4fe876=parseInt(_0x1b0175(0x1e7))/0x1*(parseInt(_0x1b0175(0x1a9))/0x2)+-parseInt(_0x1b0175(0x247))/0x3*(parseInt(_0x1b0175(0x256))/0x4)+parseInt(_0x1b0175(0x16d))/0x5*(parseInt(_0x1b0175(0x278))/0x6)+-parseInt(_0x1b0175(0x1bf))/0x7*(parseInt(_0x1b0175(0x17a))/0x8)+parseInt(_0x1b0175(0x19a))/0x9*(parseInt(_0x1b0175(0x205))/0xa)+-parseInt(_0x1b0175(0x29d))/0xb*(-parseInt(_0x1b0175(0x30a))/0xc)+-parseInt(_0x1b0175(0x20b))/0xd*(parseInt(_0x1b0175(0x1f8))/0xe);if(_0x4fe876===_0xab6c15)break;else _0x4da4ec['push'](_0x4da4ec['shift']());}catch(_0x77b7d6){_0x4da4ec['push'](_0x4da4ec['shift']());}}}(_0x27b4,0x56fdf));const _0x5a601e=(function(){let _0x17356b=!![];return function(_0x25eaec,_0x411505){const _0x211671=_0x17356b?function(){const _0x15d12e=_0x2b13;if(_0x411505){const _0x267f74=_0x411505[_0x15d12e(0x333)](_0x25eaec,arguments);return _0x411505=null,_0x267f74;}}:function(){};return _0x17356b=![],_0x211671;};}()),_0x23caec=_0x5a601e(this,function(){const _0x355082=_0x2b13;return _0x23caec[_0x355082(0x17d)]()['search']('(((.+)+)+)+$')[_0x355082(0x17d)]()[_0x355082(0x279)](_0x23caec)[_0x355082(0x224)](_0x355082(0x1b1));});_0x23caec();let imagePreviewCanvas=document[_0x46983b(0x321)]('image-preview-canvas'),imagePreviewCtx=imagePreviewCanvas?imagePreviewCanvas[_0x46983b(0x1b3)]('2d'):null,originalPreviewCanvas=document['getElementById'](_0x46983b(0x23c)),originalPreviewCtx=originalPreviewCanvas?originalPreviewCanvas['getContext']('2d'):null,flipHorizontalPreviewCanvas=document[_0x46983b(0x321)]('flip-horizontal-preview'),flipHorizontalPreviewCtx=flipHorizontalPreviewCanvas?flipHorizontalPreviewCanvas['getContext']('2d'):null,flipVerticalPreviewCanvas=document['getElementById']('flip-vertical-preview'),flipVerticalPreviewCtx=flipVerticalPreviewCanvas?flipVerticalPreviewCanvas[_0x46983b(0x1b3)]('2d'):null,flipBothPreviewCanvas=document[_0x46983b(0x321)](_0x46983b(0x1e2)),flipBothPreviewCtx=flipBothPreviewCanvas?flipBothPreviewCanvas[_0x46983b(0x1b3)]('2d'):null,moduleInfo=document[_0x46983b(0x321)]('module-info'),isImageModuleRangeMoving=![],cropStartX=0x0,cropStartY=0x0,isCropping=![],cropLeft=0x0,cropTop=0x0,cropWidth=0x0,cropHeight=0x0,currentImage=null,currentImageId=null,previewImage=null,previewImageId=null,imageManager=null,zoomLevel=0x1,zoomCenterX=0x0,zoomCenterY=0x0,previewZoomLevel=0x1,showPreviewWithMouse=![],selectedTransformation=_0x46983b(0x2eb),mouseXOnCanvas=0x0,mouseYOnCanvas=0x0,resizeMode=null,initialLeft=0x0,initialTop=0x0,initialWidth=0x0,initialHeight=0x0,currentProject=null,currentSprite=null,currentAnim=null,currentFrame=null,currentFrameIndex=0x0,selectedModuleIndex=-0x1,selectedModuleIndices=[],isDragging=![],dragStartX=0x0,dragStartY=0x0,isMarqueeSelecting=![],marqueeStartX=0x0,marqueeStartY=0x0,marqueeEndX=0x0,marqueeEndY=0x0,editMode='crop',selectedImageModule=-0x1,isCtrlPressed=![],isPlaying=![],animationSpeed=0x64,lastFrameTime=0x0,animationFrameId=null,selectedImageModules=[],dragStartModuleStates=[],currentTab=_0x46983b(0x2db),isMultiDragging=![],copiedModuleInfo=null,copiedModuleInfos=null,showGrid=!![];const gridSize=0x14,gridColor='#e0e0e0';let m_imageOriginPos={'x':0x0,'y':0x0};CommandManager['instance']=new CommandManager();function resizeCanvas(){const _0x5612c1=_0x46983b,_0x461efd=canvas[_0x5612c1(0x1c0)],_0x302de6=_0x461efd[_0x5612c1(0x213)],_0x339ef6=_0x461efd[_0x5612c1(0x16e)];canvas[_0x5612c1(0x2d1)]=_0x302de6,canvas[_0x5612c1(0x22f)]=_0x339ef6;}let imageModuleOriginPos={'x':0x0,'y':0x0};function debugCanvasState(){const _0x3b745b=_0x46983b;console[_0x3b745b(0x326)](_0x3b745b(0x201)),console[_0x3b745b(0x326)](_0x3b745b(0x2dc),currentSprite?'存在':_0x3b745b(0x24b)),console['log'](_0x3b745b(0x340),currentImageId),console['log'](_0x3b745b(0x285),currentImage?currentImage['src']||_0x3b745b(0x2df):_0x3b745b(0x24b)),console[_0x3b745b(0x326)](_0x3b745b(0x1b7),imagePreviewCanvas?'存在':_0x3b745b(0x24b)),console[_0x3b745b(0x326)](_0x3b745b(0x20e),imagePreviewCtx?'存在':_0x3b745b(0x24b));const _0x27fdcb=document[_0x3b745b(0x321)](_0x3b745b(0x283));console[_0x3b745b(0x326)](_0x3b745b(0x2e3),_0x27fdcb?'存在':'不存在');const _0x37f437=document[_0x3b745b(0x321)](_0x3b745b(0x212));console[_0x3b745b(0x326)](_0x3b745b(0x1b5),_0x37f437?'存在':_0x3b745b(0x24b)),_0x37f437&&console[_0x3b745b(0x326)](_0x3b745b(0x2e9),_0x37f437[_0x3b745b(0x2d1)]+'x'+_0x37f437[_0x3b745b(0x22f)]),currentSprite&&currentSprite[_0x3b745b(0x233)]&&(console[_0x3b745b(0x326)](_0x3b745b(0x1f4),currentSprite[_0x3b745b(0x233)][_0x3b745b(0x31f)]),currentSprite[_0x3b745b(0x233)]['length']>0x0&&console[_0x3b745b(0x326)]('第一张图片信息:',currentSprite[_0x3b745b(0x233)][0x0][_0x3b745b(0x1db)]+_0x3b745b(0x20f)+currentSprite[_0x3b745b(0x233)][0x0]['id']+')')),console[_0x3b745b(0x326)](_0x3b745b(0x2b0));}function clearClickPreviewTransform(){const _0x30552a=_0x46983b,_0x455a10=document[_0x30552a(0x26d)](_0x30552a(0x1dc));_0x455a10[_0x30552a(0x294)](_0x3a7303=>_0x3a7303['style'][_0x30552a(0x2ad)]='none');}function renderImagePreview(_0x37daa2=-0x1){const _0x6aa631=_0x46983b;_0x37daa2!==-0x1&&console['log'](_0x6aa631(0x31b),_0x37daa2);if(!previewImage||!imagePreviewCanvas||!imagePreviewCtx){console[_0x6aa631(0x15d)](_0x6aa631(0x2de));return;}const _0x121b88=imagePreviewCanvas[_0x6aa631(0x1c0)];!imagePreviewCanvas[_0x6aa631(0x32a)][_0x6aa631(0x1ad)]&&(imagePreviewCanvas[_0x6aa631(0x2d1)]=_0x121b88[_0x6aa631(0x213)]-0x14,imagePreviewCanvas[_0x6aa631(0x22f)]=0x12c,imagePreviewCanvas['dataset'][_0x6aa631(0x1ad)]='true');imagePreviewCtx[_0x6aa631(0x1f9)](0x0,0x0,imagePreviewCanvas['width'],imagePreviewCanvas[_0x6aa631(0x22f)]),imagePreviewCanvas[_0x6aa631(0x21b)][_0x6aa631(0x2ad)]=_0x6aa631(0x2e7),imagePreviewCanvas[_0x6aa631(0x21b)][_0x6aa631(0x2a7)]=_0x6aa631(0x1cc),imagePreviewCanvas[_0x6aa631(0x21b)]['backgroundColor']=_0x6aa631(0x328),imagePreviewCanvas[_0x6aa631(0x21b)][_0x6aa631(0x25c)]=_0x6aa631(0x2b4),imagePreviewCanvas['style'][_0x6aa631(0x31a)]=_0x6aa631(0x1b0),imagePreviewCanvas[_0x6aa631(0x21b)][_0x6aa631(0x2fe)]='1';const _0x5ed948=(imagePreviewCanvas[_0x6aa631(0x2d1)]-previewImage[_0x6aa631(0x2d1)]*previewZoomLevel)/0x2,_0x2a7942=0x14,_0x270a12=previewImage[_0x6aa631(0x2d1)]*previewZoomLevel,_0x287135=previewImage[_0x6aa631(0x22f)]*previewZoomLevel;imagePreviewCtx[_0x6aa631(0x1ff)](previewImage,0x0,0x0,previewImage[_0x6aa631(0x2d1)],previewImage[_0x6aa631(0x22f)],_0x5ed948,_0x2a7942,_0x270a12,_0x287135);if(currentSprite&&previewImageId){const _0x29148f=currentSprite[_0x6aa631(0x274)](previewImageId);if(_0x29148f){if(_0x29148f[_0x6aa631(0x2b2)])_0x29148f[_0x6aa631(0x2b2)][_0x6aa631(0x294)]((_0x1b65b6,_0x523c5c)=>{const _0x2c8034=_0x6aa631;imagePreviewCtx[_0x2c8034(0x235)]=_0x523c5c===selectedImageModule?_0x2c8034(0x2d8):_0x2c8034(0x32b),imagePreviewCtx['lineWidth']=_0x523c5c===selectedImageModule?0x3:0x2,imagePreviewCtx[_0x2c8034(0x2cd)](_0x5ed948+_0x1b65b6['x']*previewZoomLevel,_0x2a7942+_0x1b65b6['y']*previewZoomLevel,_0x1b65b6[_0x2c8034(0x2d1)]*previewZoomLevel,_0x1b65b6[_0x2c8034(0x22f)]*previewZoomLevel),imagePreviewCtx[_0x2c8034(0x234)]=_0x2c8034(0x15e),imagePreviewCtx[_0x2c8034(0x166)](_0x5ed948+_0x1b65b6['x']*previewZoomLevel,_0x2a7942+_0x1b65b6['y']*previewZoomLevel,0x14,0x14),imagePreviewCtx[_0x2c8034(0x234)]='rgba(0,\x200,\x200,\x200.9)',imagePreviewCtx['font']='14px\x20Arial',imagePreviewCtx[_0x2c8034(0x2c1)](''+(_0x523c5c+0x1),_0x5ed948+_0x1b65b6['x']*previewZoomLevel+0x5,_0x2a7942+_0x1b65b6['y']*previewZoomLevel+0x10);});else{}}else{}}else{}notification(_0x6aa631(0x26c));}function notification(_0x5a867c){const _0x3d7b23=_0x46983b,_0x56dae1=document['createElement'](_0x3d7b23(0x2d4));_0x56dae1[_0x3d7b23(0x2f0)]=_0x5a867c,_0x56dae1[_0x3d7b23(0x21b)]['cssText']=_0x3d7b23(0x2bd),document[_0x3d7b23(0x1b4)][_0x3d7b23(0x1d0)](_0x56dae1),setTimeout(()=>{const _0x277124=_0x3d7b23;_0x56dae1[_0x277124(0x2b1)]();},0xbb8);}function handlePreviewCanvasClick(_0x183ef0){const _0x542f9f=_0x46983b;if(!currentSprite||!previewImage)return;const _0x531103=imagePreviewCanvas[_0x542f9f(0x346)](),_0x3a70d5=_0x183ef0['clientX']-_0x531103[_0x542f9f(0x250)],_0x468b0b=_0x183ef0[_0x542f9f(0x23f)]-_0x531103[_0x542f9f(0x22b)],_0x249259=currentSprite[_0x542f9f(0x274)](previewImageId);if(!_0x249259||!_0x249259[_0x542f9f(0x2b2)])return;const _0x5288d9=(imagePreviewCanvas[_0x542f9f(0x2d1)]-previewImage['width']*previewZoomLevel)/0x2,_0x3fc0f9=0x14;let _0x1b3e02=-0x1;for(let _0x20fb6d=_0x249259[_0x542f9f(0x2b2)][_0x542f9f(0x31f)]-0x1;_0x20fb6d>=0x0;_0x20fb6d--){const _0x515dc7=_0x249259[_0x542f9f(0x2b2)][_0x20fb6d],_0x45be27=_0x5288d9+_0x515dc7['x']*previewZoomLevel,_0xcb1e65=_0x3fc0f9+_0x515dc7['y']*previewZoomLevel,_0x5a0943=_0x515dc7[_0x542f9f(0x2d1)]*previewZoomLevel,_0x25dd11=_0x515dc7[_0x542f9f(0x22f)]*previewZoomLevel;if(_0x3a70d5>=_0x45be27&&_0x3a70d5<=_0x45be27+_0x5a0943&&_0x468b0b>=_0xcb1e65&&_0x468b0b<=_0xcb1e65+_0x25dd11){_0x1b3e02=_0x20fb6d;break;}}_0x1b3e02!==-0x1?(selectedImageModule=_0x1b3e02,showPreviewWithMouse=!![],document[_0x542f9f(0x321)]('transformation-preview')[_0x542f9f(0x21b)][_0x542f9f(0x2a7)]=_0x542f9f(0x226),renderTransformationPreviews(_0x249259,_0x1b3e02)):(selectedImageModule=-0x1,showPreviewWithMouse=![],document[_0x542f9f(0x321)]('transformation-preview')[_0x542f9f(0x21b)]['display']='none'),renderImagePreview();}function updateMousePosition(_0x45f4d2){const _0x271bd7=_0x46983b,_0x2a805d=imagePreviewCanvas[_0x271bd7(0x346)](),_0x14a128=imagePreviewCanvas[_0x271bd7(0x2d1)]/_0x2a805d['width'];mouseXOnCanvas=(_0x45f4d2[_0x271bd7(0x1a4)]-_0x2a805d[_0x271bd7(0x250)])*_0x14a128,mouseYOnCanvas=(_0x45f4d2['clientY']-_0x2a805d[_0x271bd7(0x22b)])*_0x14a128;}function renderTransformationPreviews(_0x3ec25a,_0x5efcee){const _0x315963=_0x46983b;if(!_0x3ec25a||!_0x3ec25a[_0x315963(0x2ac)]||_0x5efcee<0x0||_0x5efcee>=_0x3ec25a[_0x315963(0x2b2)][_0x315963(0x31f)])return;const _0x5ca030=_0x3ec25a[_0x315963(0x2b2)][_0x5efcee],_0x447e53=Math['min'](0x3c/_0x5ca030[_0x315963(0x2d1)],0x3c/_0x5ca030[_0x315963(0x22f)]),_0x10fd91=_0x5ca030[_0x315963(0x2d1)]*_0x447e53,_0x24df67=_0x5ca030[_0x315963(0x22f)]*_0x447e53;originalPreviewCtx&&originalPreviewCtx[_0x315963(0x1f9)](0x0,0x0,0x3c,0x3c);flipHorizontalPreviewCtx&&flipHorizontalPreviewCtx['clearRect'](0x0,0x0,0x3c,0x3c);flipVerticalPreviewCtx&&flipVerticalPreviewCtx[_0x315963(0x1f9)](0x0,0x0,0x3c,0x3c);flipBothPreviewCtx&&flipBothPreviewCtx['clearRect'](0x0,0x0,0x3c,0x3c);const _0x47c037=(0x3c-_0x10fd91)/0x2,_0x199f00=(0x3c-_0x24df67)/0x2;originalPreviewCtx&&originalPreviewCtx[_0x315963(0x1ff)](_0x3ec25a[_0x315963(0x2ac)],_0x5ca030['x'],_0x5ca030['y'],_0x5ca030[_0x315963(0x2d1)],_0x5ca030['height'],_0x47c037,_0x199f00,_0x10fd91,_0x24df67),flipHorizontalPreviewCtx&&(flipHorizontalPreviewCtx[_0x315963(0x1bd)](),flipHorizontalPreviewCtx[_0x315963(0x32c)](0x3c,0x0),flipHorizontalPreviewCtx[_0x315963(0x2ae)](-0x1,0x1),flipHorizontalPreviewCtx[_0x315963(0x1ff)](_0x3ec25a[_0x315963(0x2ac)],_0x5ca030['x'],_0x5ca030['y'],_0x5ca030[_0x315963(0x2d1)],_0x5ca030[_0x315963(0x22f)],_0x47c037,_0x199f00,_0x10fd91,_0x24df67),flipHorizontalPreviewCtx[_0x315963(0x314)]()),flipVerticalPreviewCtx&&(flipVerticalPreviewCtx[_0x315963(0x1bd)](),flipVerticalPreviewCtx[_0x315963(0x32c)](0x0,0x3c),flipVerticalPreviewCtx['scale'](0x1,-0x1),flipVerticalPreviewCtx[_0x315963(0x1ff)](_0x3ec25a[_0x315963(0x2ac)],_0x5ca030['x'],_0x5ca030['y'],_0x5ca030['width'],_0x5ca030[_0x315963(0x22f)],_0x47c037,_0x199f00,_0x10fd91,_0x24df67),flipVerticalPreviewCtx['restore']()),flipBothPreviewCtx&&(flipBothPreviewCtx['save'](),flipBothPreviewCtx[_0x315963(0x32c)](0x3c,0x3c),flipBothPreviewCtx[_0x315963(0x2ae)](-0x1,-0x1),flipBothPreviewCtx['drawImage'](_0x3ec25a[_0x315963(0x2ac)],_0x5ca030['x'],_0x5ca030['y'],_0x5ca030['width'],_0x5ca030[_0x315963(0x22f)],_0x47c037,_0x199f00,_0x10fd91,_0x24df67),flipBothPreviewCtx[_0x315963(0x314)]());}function addModuleToFrame(_0x117b1f){const _0x75518b=_0x46983b;if(isEditingExpressionRect)return;console[_0x75518b(0x326)](_0x75518b(0x2f4),!currentFrame),console[_0x75518b(0x326)]('currentImageId:',previewImageId),console['log'](_0x75518b(0x259),selectedImageModule);if(!currentFrame||!currentSprite||!previewImageId||selectedImageModule===-0x1)return;const [_0xcef143,_0x4ccc38]=getCurrentXY(_0x117b1f);console[_0x75518b(0x326)](_0x75518b(0x1b2),_0xcef143,_0x4ccc38);const _0x1f4a8a=currentSprite[_0x75518b(0x274)](previewImageId);if(!_0x1f4a8a||!_0x1f4a8a[_0x75518b(0x2b2)]||selectedImageModule>=_0x1f4a8a[_0x75518b(0x2b2)][_0x75518b(0x31f)])return;const _0x1b3d45=new Module(previewImageId,selectedImageModule),_0x128da1=new FrameModule(_0x1b3d45,_0xcef143,_0x4ccc38);if(selectedTransformation===_0x75518b(0x2f8))_0x128da1[_0x75518b(0x2b3)]=0x1;else{if(selectedTransformation===_0x75518b(0x1dd))_0x128da1[_0x75518b(0x2b3)]=0x2;else selectedTransformation===_0x75518b(0x16f)&&(_0x128da1['flag']=0x3);}currentFrame[_0x75518b(0x2c3)](_0x128da1),showPreviewWithMouse=![],clearClickPreviewTransform(),renderCanvas();}function drawMouseFollowPreview(_0x1a9014){const _0x1d2c2b=_0x46983b;if(currentTab!==_0x1d2c2b(0x2db)||!showPreviewWithMouse||!currentSprite||!previewImageId||selectedImageModule===-0x1)return;const _0x1dd2c0=currentSprite['getImage'](previewImageId);if(!_0x1dd2c0||!_0x1dd2c0['image']||selectedImageModule>=_0x1dd2c0[_0x1d2c2b(0x2b2)][_0x1d2c2b(0x31f)]){console[_0x1d2c2b(0x326)](_0x1d2c2b(0x343));return;}const _0xcc397e=_0x1dd2c0[_0x1d2c2b(0x2b2)][selectedImageModule];_0x1a9014[_0x1d2c2b(0x1bd)](),_0x1a9014[_0x1d2c2b(0x32c)](mouseXOnCanvas,mouseYOnCanvas);if(selectedTransformation===_0x1d2c2b(0x2f8))_0x1a9014[_0x1d2c2b(0x2ae)](-0x1,0x1);else selectedTransformation===_0x1d2c2b(0x1dd)&&_0x1a9014[_0x1d2c2b(0x2ae)](0x1,-0x1);_0x1a9014[_0x1d2c2b(0x165)]=0.7,_0x1a9014[_0x1d2c2b(0x1ff)](_0x1dd2c0['image'],_0xcc397e['x'],_0xcc397e['y'],_0xcc397e[_0x1d2c2b(0x2d1)],_0xcc397e['height'],0x0,0x0,_0xcc397e[_0x1d2c2b(0x2d1)],_0xcc397e[_0x1d2c2b(0x22f)]),_0x1a9014[_0x1d2c2b(0x314)]();}function drawCurrentImage(){const _0x1f3ef5=_0x46983b;if(!currentImage)return;imageCtx[_0x1f3ef5(0x1f9)](0x0,0x0,imageCanvas[_0x1f3ef5(0x2d1)],imageCanvas['height']);const _0x5b491e=(imageCanvas[_0x1f3ef5(0x2d1)]-currentImage['width']*zoomLevel)/0x2,_0x26d907=(imageCanvas[_0x1f3ef5(0x22f)]-currentImage[_0x1f3ef5(0x22f)]*zoomLevel)/0x2,_0x2766db=currentImage[_0x1f3ef5(0x2d1)]*zoomLevel,_0x35002b=currentImage['height']*zoomLevel;zoomCenterX=imageCanvas[_0x1f3ef5(0x2d1)]/0x2,zoomCenterY=imageCanvas[_0x1f3ef5(0x22f)]/0x2,imageModuleOriginPos['x']=imageCanvas[_0x1f3ef5(0x2d1)]/0x2,imageModuleOriginPos['y']=imageCanvas[_0x1f3ef5(0x22f)]/0x2;if(showGrid){imageCtx[_0x1f3ef5(0x235)]=gridColor,imageCtx[_0x1f3ef5(0x2b9)]=0x1,imageCtx[_0x1f3ef5(0x16c)]();for(let _0xa81be9=0x0;_0xa81be9<=imageCanvas[_0x1f3ef5(0x2d1)];_0xa81be9+=gridSize){imageCtx['moveTo'](_0xa81be9,0x0),imageCtx[_0x1f3ef5(0x1da)](_0xa81be9,imageCanvas[_0x1f3ef5(0x22f)]);}imageCtx['stroke'](),imageCtx[_0x1f3ef5(0x16c)]();for(let _0x57746a=0x0;_0x57746a<=imageCanvas[_0x1f3ef5(0x22f)];_0x57746a+=gridSize){imageCtx[_0x1f3ef5(0x300)](0x0,_0x57746a),imageCtx[_0x1f3ef5(0x1da)](imageCanvas[_0x1f3ef5(0x2d1)],_0x57746a);}imageCtx[_0x1f3ef5(0x2ca)]();}imageCtx[_0x1f3ef5(0x235)]='#999',imageCtx['lineWidth']=0x1,imageCtx[_0x1f3ef5(0x1ae)]([0x5,0x5]),imageCtx['beginPath'](),imageCtx[_0x1f3ef5(0x300)](0x0,imageModuleOriginPos['y']),imageCtx['lineTo'](imageCanvas[_0x1f3ef5(0x2d1)],imageModuleOriginPos['y']),imageCtx['stroke'](),imageCtx[_0x1f3ef5(0x16c)](),imageCtx[_0x1f3ef5(0x300)](imageModuleOriginPos['x'],0x0),imageCtx[_0x1f3ef5(0x1da)](imageModuleOriginPos['x'],imageCanvas[_0x1f3ef5(0x22f)]),imageCtx['stroke'](),imageCtx[_0x1f3ef5(0x1ae)]([]),imageCtx[_0x1f3ef5(0x235)]=_0x1f3ef5(0x198),imageCtx[_0x1f3ef5(0x2b9)]=0x1,imageCtx[_0x1f3ef5(0x16c)](),imageCtx['moveTo'](imageModuleOriginPos['x']-0x8,imageModuleOriginPos['y']),imageCtx['lineTo'](imageModuleOriginPos['x']+0x8,imageModuleOriginPos['y']),imageCtx[_0x1f3ef5(0x300)](imageModuleOriginPos['x'],imageModuleOriginPos['y']-0x8),imageCtx[_0x1f3ef5(0x1da)](imageModuleOriginPos['x'],imageModuleOriginPos['y']+0x8),imageCtx[_0x1f3ef5(0x2ca)](),imageCtx[_0x1f3ef5(0x1ff)](currentImage,0x0,0x0,currentImage['width'],currentImage['height'],_0x5b491e,_0x26d907,_0x2766db,_0x35002b),drawSelectedModules();if(editMode==='crop'){if(isCropping&&cropWidth>0x0&&cropHeight>0x0){const _0x3b2477=_0x5b491e+cropLeft*zoomLevel,_0x29d1e1=_0x26d907+cropTop*zoomLevel,_0x34ffc1=cropWidth*zoomLevel,_0x3a0f74=cropHeight*zoomLevel;imageCtx['strokeStyle']=_0x1f3ef5(0x191),imageCtx['lineWidth']=0x2,imageCtx[_0x1f3ef5(0x2cd)](_0x3b2477,_0x29d1e1,_0x34ffc1,_0x3a0f74),imageCtx[_0x1f3ef5(0x234)]=_0x1f3ef5(0x310),imageCtx['fillRect'](_0x3b2477,_0x29d1e1,_0x34ffc1,_0x3a0f74),drawCropHandles(_0x3b2477,_0x29d1e1,_0x34ffc1,_0x3a0f74);}}else{if(editMode===_0x1f3ef5(0x1c7)){const _0x5635c0=currentSprite['getImage'](currentImageId);_0x5635c0&&_0x5635c0[_0x1f3ef5(0x2b2)]&&_0x5635c0[_0x1f3ef5(0x2b2)][_0x1f3ef5(0x294)]((_0x46a57c,_0x39f1ad)=>{const _0x378c30=_0x1f3ef5,_0x3074d5=_0x5b491e+_0x46a57c['x']*zoomLevel,_0x54bacc=_0x26d907+_0x46a57c['y']*zoomLevel,_0x525ec4=_0x46a57c[_0x378c30(0x2d1)]*zoomLevel,_0x5b2bf3=_0x46a57c[_0x378c30(0x22f)]*zoomLevel;_0x39f1ad===selectedImageModule?(imageCtx[_0x378c30(0x235)]=_0x378c30(0x159),imageCtx[_0x378c30(0x2b9)]=0x2,imageCtx['strokeRect'](_0x3074d5,_0x54bacc,_0x525ec4,_0x5b2bf3),imageCtx['fillStyle']='rgba(0,\x20255,\x200,\x200.1)',imageCtx[_0x378c30(0x166)](_0x3074d5,_0x54bacc,_0x525ec4,_0x5b2bf3),drawCropHandles(_0x3074d5,_0x54bacc,_0x525ec4,_0x5b2bf3)):(imageCtx['strokeStyle']='gray',imageCtx[_0x378c30(0x2b9)]=0x1,imageCtx[_0x378c30(0x2cd)](_0x3074d5,_0x54bacc,_0x525ec4,_0x5b2bf3));});}}drawMouseFollowPreview(imageCtx);}function drawCropHandles(_0x538f01,_0x42c6b4,_0x525d5b,_0xf919cb){const _0x1cf136=_0x46983b,_0x55b451=0x6,_0x463186=_0x1cf136(0x176);imageCtx[_0x1cf136(0x234)]=_0x463186,imageCtx[_0x1cf136(0x166)](_0x538f01-_0x55b451/0x2,_0x42c6b4-_0x55b451/0x2,_0x55b451,_0x55b451),imageCtx[_0x1cf136(0x166)](_0x538f01+_0x525d5b-_0x55b451/0x2,_0x42c6b4-_0x55b451/0x2,_0x55b451,_0x55b451),imageCtx[_0x1cf136(0x166)](_0x538f01-_0x55b451/0x2,_0x42c6b4+_0xf919cb-_0x55b451/0x2,_0x55b451,_0x55b451),imageCtx[_0x1cf136(0x166)](_0x538f01+_0x525d5b-_0x55b451/0x2,_0x42c6b4+_0xf919cb-_0x55b451/0x2,_0x55b451,_0x55b451),imageCtx['fillRect'](_0x538f01-_0x55b451/0x2,_0x42c6b4+_0xf919cb/0x2-_0x55b451/0x2,_0x55b451,_0x55b451),imageCtx[_0x1cf136(0x166)](_0x538f01+_0x525d5b-_0x55b451/0x2,_0x42c6b4+_0xf919cb/0x2-_0x55b451/0x2,_0x55b451,_0x55b451),imageCtx[_0x1cf136(0x166)](_0x538f01+_0x525d5b/0x2-_0x55b451/0x2,_0x42c6b4-_0x55b451/0x2,_0x55b451,_0x55b451),imageCtx['fillRect'](_0x538f01+_0x525d5b/0x2-_0x55b451/0x2,_0x42c6b4+_0xf919cb-_0x55b451/0x2,_0x55b451,_0x55b451);}function handleZoomIn(){const _0x460106=_0x46983b;zoomLevel=Math[_0x460106(0x32d)](zoomLevel+0.1,0x5),updateZoomLevel(),currentTab===_0x460106(0x2db)?renderCanvas():drawCurrentImage();}function handleZoomOut(){const _0x1457a2=_0x46983b;zoomLevel=Math[_0x1457a2(0x2f1)](zoomLevel-0.1,0.1),updateZoomLevel(),currentTab===_0x1457a2(0x2db)?renderCanvas():drawCurrentImage();}function handleZoomReset(){const _0x113183=_0x46983b;zoomLevel=0x1,updateZoomLevel(),!isDraggingOrigin&&updateImageOriginPos(),currentTab===_0x113183(0x2db)?renderCanvas():drawCurrentImage();}function updateImageOriginPos(){const _0x39c45a=_0x46983b;m_imageOriginPos['x']=canvas[_0x39c45a(0x2d1)]/0x2,m_imageOriginPos['y']=canvas[_0x39c45a(0x22f)]/0x2;}let isSpacePressed=![],isDraggingOrigin=![],originDragStartX=0x0,originDragStartY=0x0,originDragScreenX=0x0,originDragScreenY=0x0,originDragStartPosX=0x0,originDragStartPosY=0x0,moduleDragStartX=0x0,moduleDragStartY=0x0;function showMousePosition(_0x2d64db){const _0x160482=_0x46983b,_0x3ab080=canvas[_0x160482(0x346)](),_0x238db6=canvas[_0x160482(0x2d1)]/_0x3ab080[_0x160482(0x2d1)],_0x421115=(_0x2d64db[_0x160482(0x1a4)]-_0x3ab080[_0x160482(0x250)])*_0x238db6,_0x296c83=(_0x2d64db[_0x160482(0x23f)]-_0x3ab080[_0x160482(0x22b)])*_0x238db6,_0x524f5e=Math[_0x160482(0x21d)]((_0x421115-m_imageOriginPos['x'])/zoomLevel),_0x48d5d6=Math[_0x160482(0x21d)]((m_imageOriginPos['y']-_0x296c83)/zoomLevel);document[_0x160482(0x321)](_0x160482(0x216))[_0x160482(0x2f0)]=_0x160482(0x331)+Math['round'](_0x421115)+',\x20'+Math[_0x160482(0x21d)](_0x296c83)+')\x20相对('+_0x524f5e+',\x20'+_0x48d5d6+')';}function updateZoomLevel(){const _0x3ac0bb=_0x46983b;document[_0x3ac0bb(0x321)]('zoom-level')[_0x3ac0bb(0x2f0)]=Math[_0x3ac0bb(0x21d)](zoomLevel*0x64)+'%',document[_0x3ac0bb(0x321)]('animation-zoom-level')[_0x3ac0bb(0x2f0)]=Math['round'](zoomLevel*0x64)+'%';}function handleMouseWheel(_0x44d23d){const _0x23115f=_0x46983b;_0x44d23d['preventDefault'](),_0x44d23d[_0x23115f(0x1e6)]<0x0?zoomLevel=Math[_0x23115f(0x32d)](zoomLevel+0.05,0x5):zoomLevel=Math[_0x23115f(0x2f1)](zoomLevel-0.05,0.1),updateZoomLevel(),console[_0x23115f(0x326)](_0x23115f(0x1ea),currentTab),currentTab===_0x23115f(0x2db)?renderCanvas():drawCurrentImage();}function drawSelectedModules(){const _0x459eb6=_0x46983b;if(!currentImage||!currentSprite||!currentImageId)return;const _0x1cf429=currentSprite[_0x459eb6(0x274)](currentImageId);if(!_0x1cf429)return;const _0x2364c2=document[_0x459eb6(0x321)](_0x459eb6(0x2af))['checked'],_0x263bdc=(imageCanvas[_0x459eb6(0x2d1)]-currentImage[_0x459eb6(0x2d1)]*zoomLevel)/0x2,_0x54a527=(imageCanvas[_0x459eb6(0x22f)]-currentImage[_0x459eb6(0x22f)]*zoomLevel)/0x2;_0x2364c2&&_0x1cf429['modulesList'][_0x459eb6(0x294)]((_0x3cbce7,_0x34cadf)=>{const _0x21bf3c=_0x459eb6;_0x34cadf>=0x0&&_0x34cadf<_0x1cf429[_0x21bf3c(0x2b2)]['length']&&(imageCtx['strokeStyle']=_0x21bf3c(0x32b),imageCtx[_0x21bf3c(0x2b9)]=0x2,imageCtx[_0x21bf3c(0x2cd)](_0x263bdc+_0x3cbce7['x']*zoomLevel,_0x54a527+_0x3cbce7['y']*zoomLevel,_0x3cbce7[_0x21bf3c(0x2d1)]*zoomLevel,_0x3cbce7[_0x21bf3c(0x22f)]*zoomLevel),imageCtx[_0x21bf3c(0x234)]='rgba(255,\x200,\x200,\x200.8)',imageCtx['font']='12px\x20Arial',imageCtx['fillText'](''+(_0x34cadf+0x1),_0x263bdc+_0x3cbce7['x']*zoomLevel+0x2,_0x54a527+_0x3cbce7['y']*zoomLevel+0xe));});const _0x4cf29b=selectedImageModule!==-0x1?[selectedImageModule]:selectedImageModules;_0x1cf429[_0x459eb6(0x2b2)][_0x459eb6(0x294)]((_0xd8471f,_0x775589)=>{const _0x30c7d8=_0x459eb6;_0x775589>=0x0&&_0x775589<_0x1cf429['modulesList'][_0x30c7d8(0x31f)]&&_0x4cf29b[_0x30c7d8(0x228)](_0x775589)&&(imageCtx[_0x30c7d8(0x235)]=_0x30c7d8(0x2d8),imageCtx[_0x30c7d8(0x2b9)]=0x2,imageCtx['strokeRect'](_0x263bdc+_0xd8471f['x']*zoomLevel,_0x54a527+_0xd8471f['y']*zoomLevel,_0xd8471f[_0x30c7d8(0x2d1)]*zoomLevel,_0xd8471f['height']*zoomLevel),imageCtx['fillStyle']=_0x30c7d8(0x2d8),imageCtx['font']='12px\x20Arial',imageCtx[_0x30c7d8(0x2c1)](''+(_0x775589+0x1),_0x263bdc+_0xd8471f['x']*zoomLevel+0x2,_0x54a527+_0xd8471f['y']*zoomLevel+0xe));});}function switchTab(_0x4fae69){const _0x2042b0=_0x46983b;document[_0x2042b0(0x321)](_0x2042b0(0x175))[_0x2042b0(0x27c)]['remove']('active'),document[_0x2042b0(0x321)](_0x2042b0(0x1fd))[_0x2042b0(0x27c)]['remove'](_0x2042b0(0x23d)),document[_0x2042b0(0x321)](_0x2042b0(0x2c4))[_0x2042b0(0x27c)][_0x2042b0(0x2b1)]('active'),document[_0x2042b0(0x321)](_0x2042b0(0x28f))['classList'][_0x2042b0(0x2b1)](_0x2042b0(0x23d)),document['getElementById'](_0x2042b0(0x1d3)+_0x4fae69)[_0x2042b0(0x27c)][_0x2042b0(0x2b6)]('active'),document[_0x2042b0(0x321)](_0x2042b0(0x1c6)+_0x4fae69)['classList'][_0x2042b0(0x2b6)](_0x2042b0(0x23d)),currentTab=_0x4fae69;if(_0x4fae69==='animation'){selectedImageModule=-0x1,selectedImageModules=[],expressionResizeControlPoint=-0x1;const _0x5d5ba4=document[_0x2042b0(0x321)](_0x2042b0(0x1d2));_0x5d5ba4&&_0x5d5ba4[_0x2042b0(0x27c)][_0x2042b0(0x2b1)](_0x2042b0(0x23d));const _0x13be9a=document[_0x2042b0(0x321)](_0x2042b0(0x22d));_0x13be9a&&_0x13be9a[_0x2042b0(0x27c)]['remove'](_0x2042b0(0x23d)),editMode=_0x2042b0(0x1c2),isCropping=![],renderCanvas(0x1),updateExpressionCheckboxState(),document[_0x2042b0(0x321)](_0x2042b0(0x1e3))[_0x2042b0(0x21b)][_0x2042b0(0x2a7)]=_0x2042b0(0x226),document[_0x2042b0(0x321)](_0x2042b0(0x2d5))[_0x2042b0(0x21b)][_0x2042b0(0x2a7)]=_0x2042b0(0x243),document[_0x2042b0(0x321)]('image-control-section')[_0x2042b0(0x21b)]['display']=_0x2042b0(0x243),console[_0x2042b0(0x326)](_0x2042b0(0x1f0)),!imagePreviewCanvas&&(console[_0x2042b0(0x326)]('Looking\x20for\x20image-preview-canvas\x20element'),imagePreviewCanvas=document['getElementById'](_0x2042b0(0x212)),imagePreviewCanvas?(imagePreviewCtx=imagePreviewCanvas[_0x2042b0(0x1b3)]('2d'),console[_0x2042b0(0x326)](_0x2042b0(0x177))):console[_0x2042b0(0x15d)](_0x2042b0(0x1e9))),populateImageDropdown(),console['log'](_0x2042b0(0x1ca)),console[_0x2042b0(0x326)]({'hasCurrentImage':!!currentImage,'hasCanvas':!!imagePreviewCanvas}),currentImage&&imagePreviewCanvas?(console[_0x2042b0(0x326)](_0x2042b0(0x251)),renderImagePreview()):console[_0x2042b0(0x326)](_0x2042b0(0x318));}else{if(_0x4fae69===_0x2042b0(0x2ac)){updateExpressionCheckboxState();if(!currentImage&&currentSprite&&currentSprite[_0x2042b0(0x233)][_0x2042b0(0x31f)]>0x0){const _0x3991e0=currentSprite['m_imageList'][0x0];currentImage=_0x3991e0['image'],currentImageId=_0x3991e0['id'],imageCanvas[_0x2042b0(0x2d1)]=currentImage[_0x2042b0(0x2d1)],imageCanvas['height']=currentImage[_0x2042b0(0x22f)],zoomLevel=0x1,updateZoomLevel();}renderModulesList(),drawCurrentImage(),renderImagesList(),document[_0x2042b0(0x321)](_0x2042b0(0x1e3))[_0x2042b0(0x21b)]['display']=_0x2042b0(0x243),document[_0x2042b0(0x321)]('image-control-section')['style'][_0x2042b0(0x2a7)]='flex';}}}function populateImageDropdown(){const _0x16ba76=_0x46983b;console[_0x16ba76(0x326)](_0x16ba76(0x2c8));const _0x2cec51=document[_0x16ba76(0x321)](_0x16ba76(0x283));if(!_0x2cec51){console['warn'](_0x16ba76(0x282));return;}_0x2cec51[_0x16ba76(0x196)]=_0x16ba76(0x325);if(!currentSprite){console['warn']('Cannot\x20populate\x20dropdown:\x20currentSprite\x20is\x20null');return;}if(currentSprite[_0x16ba76(0x233)][_0x16ba76(0x31f)]===0x0){console['log']('No\x20images\x20available\x20in\x20currentSprite');return;}console[_0x16ba76(0x326)]('Adding',currentSprite[_0x16ba76(0x233)][_0x16ba76(0x31f)],_0x16ba76(0x289)),currentSprite[_0x16ba76(0x233)][_0x16ba76(0x294)](_0x3fb01a=>{const _0x4e8af9=_0x16ba76,_0x1b6303=document[_0x4e8af9(0x161)](_0x4e8af9(0x1e4));_0x1b6303['value']=_0x3fb01a['id'],_0x1b6303[_0x4e8af9(0x2f0)]=_0x3fb01a[_0x4e8af9(0x1db)],_0x2cec51[_0x4e8af9(0x1d0)](_0x1b6303);});if(currentImageId){console['log'](_0x16ba76(0x18f),currentImageId),_0x2cec51[_0x16ba76(0x2f6)]=currentImageId;if(!currentImage){console['log'](_0x16ba76(0x214));const _0x5f2607=currentSprite[_0x16ba76(0x274)](parseInt(currentImageId));_0x5f2607?(console[_0x16ba76(0x326)]('Found\x20image\x20item:',_0x5f2607['name']),currentImage=_0x5f2607[_0x16ba76(0x2ac)],previewImage=_0x5f2607[_0x16ba76(0x2ac)],console['log'](_0x16ba76(0x33f),currentImage?currentImage[_0x16ba76(0x273)]:'null')):console[_0x16ba76(0x15d)](_0x16ba76(0x302),currentImageId);}!imagePreviewCanvas&&(console['log'](_0x16ba76(0x164)),imagePreviewCanvas=document[_0x16ba76(0x321)](_0x16ba76(0x212)),imagePreviewCanvas?(imagePreviewCtx=imagePreviewCanvas['getContext']('2d'),console['log'](_0x16ba76(0x177))):console[_0x16ba76(0x15d)](_0x16ba76(0x1e9))),console[_0x16ba76(0x326)]('About\x20to\x20call\x20renderImagePreview\x20from\x20populateImageDropdown'),renderImagePreview();}}function renderImagesList(){const _0x1d6703=_0x46983b,_0x273ab8=document[_0x1d6703(0x321)]('images-list');_0x273ab8[_0x1d6703(0x196)]='';if(!currentSprite||currentSprite[_0x1d6703(0x233)]['length']===0x0){_0x273ab8[_0x1d6703(0x196)]=_0x1d6703(0x344);return;}currentSprite['m_imageList']['forEach'](_0x28832c=>{const _0x175539=_0x1d6703,_0x649cda=document['createElement']('div');_0x649cda['className']=_0x175539(0x24e)+(currentImageId===_0x28832c['id']?_0x175539(0x1cb):''),_0x649cda[_0x175539(0x21b)]['cssText']=_0x175539(0x33e)+(currentImageId===_0x28832c['id']?'#e0e0e0':_0x175539(0x328))+';\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x203px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';const _0x119758=document['createElement'](_0x175539(0x2d4));_0x119758[_0x175539(0x21b)][_0x175539(0x2a7)]='flex',_0x119758['style'][_0x175539(0x297)]=_0x175539(0x28e),_0x119758[_0x175539(0x21b)][_0x175539(0x1be)]='space-between',_0x649cda[_0x175539(0x1d0)](_0x119758);const _0x4d3a59=document[_0x175539(0x27e)](_0x28832c[_0x175539(0x1db)]);_0x119758[_0x175539(0x1d0)](_0x4d3a59);const _0x1a5b32=document[_0x175539(0x161)](_0x175539(0x2d4));_0x1a5b32['style'][_0x175539(0x2a7)]='flex',_0x1a5b32['style'][_0x175539(0x1d4)]='3px',_0x119758[_0x175539(0x1d0)](_0x1a5b32);const _0x323cc7=document[_0x175539(0x161)]('button');_0x323cc7[_0x175539(0x2f0)]='删除',_0x323cc7[_0x175539(0x21b)][_0x175539(0x182)]=_0x175539(0x345),_0x323cc7['style']['fontSize']=_0x175539(0x1b8),_0x323cc7[_0x175539(0x21b)][_0x175539(0x2a1)]=_0x175539(0x167),_0x323cc7[_0x175539(0x21b)][_0x175539(0x19f)]=_0x175539(0x320),_0x323cc7['style'][_0x175539(0x2ad)]=_0x175539(0x243),_0x323cc7[_0x175539(0x21b)]['borderRadius']='2px',_0x323cc7[_0x175539(0x21b)][_0x175539(0x252)]=_0x175539(0x336),_0x323cc7['addEventListener']('click',_0x571890=>{const _0x2b4a95=_0x175539;_0x571890[_0x2b4a95(0x292)](),deleteImage(_0x28832c);}),_0x1a5b32[_0x175539(0x1d0)](_0x323cc7);const _0x1ad618=document[_0x175539(0x161)](_0x175539(0x197));_0x1ad618[_0x175539(0x2f0)]='替换',_0x1ad618[_0x175539(0x21b)][_0x175539(0x182)]=_0x175539(0x345),_0x1ad618[_0x175539(0x21b)][_0x175539(0x2a6)]=_0x175539(0x1b8),_0x1ad618[_0x175539(0x21b)]['backgroundColor']=_0x175539(0x286),_0x1ad618[_0x175539(0x21b)]['color']=_0x175539(0x320),_0x1ad618['style'][_0x175539(0x2ad)]=_0x175539(0x243),_0x1ad618[_0x175539(0x21b)][_0x175539(0x1b9)]='2px',_0x1ad618[_0x175539(0x21b)]['cursor']=_0x175539(0x336),_0x1ad618['addEventListener'](_0x175539(0x295),_0x1aee2d=>{_0x1aee2d['stopPropagation'](),replaceImage(_0x28832c);}),_0x1a5b32[_0x175539(0x1d0)](_0x1ad618),_0x649cda[_0x175539(0x316)](_0x175539(0x295),()=>{const _0x8e140d=_0x175539;currentImage=_0x28832c[_0x8e140d(0x2ac)],currentImageId=_0x28832c['id'],imageCanvas['width']=currentImage[_0x8e140d(0x2d1)],imageCanvas['height']=currentImage['height'],zoomLevel=0x1,updateZoomLevel(),drawCurrentImage(),renderModulesList(),renderImagesList();}),_0x273ab8[_0x175539(0x1d0)](_0x649cda);});}function renderAnimationImagesList(){}function renderAnimationModulesList(_0x3f8227){const _0x25637b=_0x46983b,_0x563e4e=document[_0x25637b(0x321)](_0x25637b(0x33a));_0x563e4e[_0x25637b(0x196)]='',document[_0x25637b(0x321)]('selected-image-title')[_0x25637b(0x2f0)]=_0x3f8227[_0x25637b(0x1db)]+'\x20的模块';if(!_0x3f8227[_0x25637b(0x2b2)]||_0x3f8227[_0x25637b(0x2b2)][_0x25637b(0x31f)]===0x0){_0x563e4e['innerHTML']=_0x25637b(0x2cc);return;}_0x3f8227[_0x25637b(0x2b2)][_0x25637b(0x294)]((_0x3016df,_0x10b534)=>{const _0xabad41=_0x25637b,_0x268da1=document[_0xabad41(0x161)](_0xabad41(0x2d4));_0x268da1['className']=_0xabad41(0x2a9),_0x268da1[_0xabad41(0x21b)][_0xabad41(0x238)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20inline-block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20height:\x2080px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin:\x205px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x205px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20#ddd;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20cursor:\x20pointer;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20position:\x20relative;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';const _0x5d29b2=document[_0xabad41(0x161)]('canvas'),_0x231f84=_0x5d29b2[_0xabad41(0x1b3)]('2d'),_0x1cbbc3=Math[_0xabad41(0x32d)](0x46/_0x3016df[_0xabad41(0x2d1)],0x46/_0x3016df[_0xabad41(0x22f)]),_0x2c14f3=_0x3016df['width']*_0x1cbbc3,_0x236379=_0x3016df[_0xabad41(0x22f)]*_0x1cbbc3;_0x231f84[_0xabad41(0x1ff)](_0x3f8227[_0xabad41(0x2ac)],_0x3016df['x'],_0x3016df['y'],_0x3016df['width'],_0x3016df['height'],(0x46-_0x2c14f3)/0x2,(0x46-_0x236379)/0x2,_0x2c14f3,_0x236379),_0x268da1[_0xabad41(0x1d0)](_0x5d29b2);const _0x156181=document[_0xabad41(0x161)](_0xabad41(0x2d4));_0x156181[_0xabad41(0x21b)][_0xabad41(0x168)]=_0xabad41(0x220),_0x156181[_0xabad41(0x21b)]['bottom']=_0xabad41(0x184),_0x156181[_0xabad41(0x21b)][_0xabad41(0x18d)]=_0xabad41(0x184),_0x156181[_0xabad41(0x21b)][_0xabad41(0x2a6)]='12px',_0x156181[_0xabad41(0x21b)]['backgroundColor']=_0xabad41(0x1de),_0x156181[_0xabad41(0x21b)][_0xabad41(0x182)]='1px\x203px',_0x156181['style'][_0xabad41(0x1b9)]=_0xabad41(0x184),_0x156181[_0xabad41(0x2f0)]=''+(_0x10b534+0x1),_0x268da1[_0xabad41(0x1d0)](_0x156181),_0x268da1[_0xabad41(0x316)](_0xabad41(0x295),()=>{const _0x387f10=_0xabad41;if(!currentFrame){alert(_0x387f10(0x27b));return;}const _0x6182ea=new Module(_0x3f8227['id'],_0x10b534),_0x492852=new FrameModule(_0x6182ea,0x0,0x0,0x0);CommandManager[_0x387f10(0x19c)][_0x387f10(0x206)](new AddFmCommand(currentFrame,_0x492852)),renderCanvas(0x2);}),_0x563e4e[_0xabad41(0x1d0)](_0x268da1);});}function showNewSpriteModal(){const _0x3c1173=_0x46983b,_0x853e3b=document[_0x3c1173(0x321)](_0x3c1173(0x2ea));currentSprite?_0x853e3b[_0x3c1173(0x2f6)]=currentSprite[_0x3c1173(0x1db)]:_0x853e3b[_0x3c1173(0x2f6)]='',document[_0x3c1173(0x321)]('new-sprite-modal')[_0x3c1173(0x21b)]['display']=_0x3c1173(0x226),_0x853e3b[_0x3c1173(0x269)]();}function hideNewSpriteModal(){const _0x3e8e04=_0x46983b;document[_0x3e8e04(0x321)]('new-sprite-modal')['style']['display']='none',document[_0x3e8e04(0x321)](_0x3e8e04(0x2ea))[_0x3e8e04(0x2f6)]='';}function renameAnimation(){const _0x36ea69=_0x46983b;if(!currentAnim)return;const _0x4c0469=prompt('请输入新的动画名称:',currentAnim[_0x36ea69(0x1db)]);_0x4c0469&&_0x4c0469[_0x36ea69(0x312)]()&&(currentAnim['name']=_0x4c0469[_0x36ea69(0x312)](),renderAnimList(),document[_0x36ea69(0x321)](_0x36ea69(0x24d))[_0x36ea69(0x2f0)]=currentAnim[_0x36ea69(0x1db)]+_0x36ea69(0x303)+(currentFrameIndex+0x1),saveProject());}function copyAnimation(){const _0x5bbde6=_0x46983b;if(!currentAnim||!currentSprite)return;let _0x4c52e5=currentAnim[_0x5bbde6(0x1db)]+'-复制',_0x1ab02f=0x1;while(currentSprite[_0x5bbde6(0x2d3)][_0x5bbde6(0x2e2)](_0x380412=>_0x380412['name']===_0x4c52e5)){_0x1ab02f++,_0x4c52e5=currentAnim['name']+_0x5bbde6(0x171)+_0x1ab02f;}const _0x479d14=new Anim(_0x4c52e5);currentAnim[_0x5bbde6(0x25e)][_0x5bbde6(0x294)](_0x4c9cd8=>{const _0x2781f6=_0x5bbde6,_0x461ea6=_0x4c9cd8['frame'][_0x2781f6(0x237)](),_0x1eef00=new AnimFrame(_0x461ea6,_0x4c9cd8[_0x2781f6(0x174)]);_0x479d14[_0x2781f6(0x25e)][_0x2781f6(0x2d6)](_0x1eef00);}),currentSprite[_0x5bbde6(0x2d3)][_0x5bbde6(0x2d6)](_0x479d14),renderAnimList(),saveProject();}function moveAnimationUp(){const _0x248901=_0x46983b;if(!currentSprite||!currentAnim)return;const _0x3bc7f6=currentSprite[_0x248901(0x2d3)][_0x248901(0x2c0)](currentAnim);_0x3bc7f6>0x0&&([currentSprite[_0x248901(0x2d3)][_0x3bc7f6-0x1],currentSprite['mAnimList'][_0x3bc7f6]]=[currentSprite[_0x248901(0x2d3)][_0x3bc7f6],currentSprite[_0x248901(0x2d3)][_0x3bc7f6-0x1]],renderAnimList(),saveProject());}function moveAnimationDown(){const _0x4baeff=_0x46983b;if(!currentSprite||!currentAnim)return;const _0x522b7a=currentSprite[_0x4baeff(0x2d3)][_0x4baeff(0x2c0)](currentAnim);_0x522b7a<currentSprite[_0x4baeff(0x2d3)][_0x4baeff(0x31f)]-0x1&&([currentSprite[_0x4baeff(0x2d3)][_0x522b7a],currentSprite[_0x4baeff(0x2d3)][_0x522b7a+0x1]]=[currentSprite[_0x4baeff(0x2d3)][_0x522b7a+0x1],currentSprite[_0x4baeff(0x2d3)][_0x522b7a]],renderAnimList(),saveProject());}function moveAnimationToTop(){const _0x455603=_0x46983b;if(!currentSprite||!currentAnim)return;const _0x20913e=currentSprite[_0x455603(0x2d3)][_0x455603(0x2c0)](currentAnim);_0x20913e>0x0&&(currentSprite['mAnimList'][_0x455603(0x195)](_0x20913e,0x1),currentSprite[_0x455603(0x2d3)][_0x455603(0x2a3)](currentAnim),renderAnimList(),saveProject());}function moveAnimationToBottom(){const _0xa73d3e=_0x46983b;if(!currentSprite||!currentAnim)return;const _0x44decd=currentSprite[_0xa73d3e(0x2d3)]['indexOf'](currentAnim);_0x44decd<currentSprite['mAnimList'][_0xa73d3e(0x31f)]-0x1&&(currentSprite[_0xa73d3e(0x2d3)][_0xa73d3e(0x195)](_0x44decd,0x1),currentSprite['mAnimList'][_0xa73d3e(0x2d6)](currentAnim),renderAnimList(),saveProject());}function deleteAnimation(){const _0x46e9e5=_0x46983b;if(!currentAnim||!currentSprite)return;if(!confirm('确定要删除动画\x20\x22'+currentAnim['name']+'\x22\x20吗？此操作无法恢复！'))return;const _0x48bda6=currentSprite['mAnimList'][_0x46e9e5(0x2c0)](currentAnim);currentSprite[_0x46e9e5(0x2d3)][_0x46e9e5(0x195)](_0x48bda6,0x1),currentSprite[_0x46e9e5(0x2d3)]['length']>0x0?selectAnim(0x0):(currentAnim=null,currentFrame=null,currentFrameIndex=-0x1,renderCanvas(0x14),document[_0x46e9e5(0x321)](_0x46e9e5(0x24d))[_0x46e9e5(0x2f0)]=_0x46e9e5(0x1a3)),renderAnimList(),saveProject();}function createSprite(){const _0x365254=_0x46983b,_0x54a026=document[_0x365254(0x321)](_0x365254(0x2ea))['value']['trim']();if(!_0x54a026){alert('请输入角色名称');return;}currentSprite?currentSprite[_0x365254(0x1db)]=_0x54a026:(currentSprite=new Sprite(_0x54a026),currentProject[_0x365254(0x215)](currentSprite)),renderSpriteList(),hideNewSpriteModal();}function showNewAnimModal(){const _0x4dc0c1=_0x46983b;if(!currentSprite){alert(_0x4dc0c1(0x30c));return;}document['getElementById'](_0x4dc0c1(0x21c))[_0x4dc0c1(0x21b)][_0x4dc0c1(0x2a7)]=_0x4dc0c1(0x226),document[_0x4dc0c1(0x321)](_0x4dc0c1(0x19b))[_0x4dc0c1(0x269)]();}function hideNewAnimModal(){const _0x43b7dc=_0x46983b;document[_0x43b7dc(0x321)]('new-anim-modal')[_0x43b7dc(0x21b)][_0x43b7dc(0x2a7)]='none',document[_0x43b7dc(0x321)](_0x43b7dc(0x19b))[_0x43b7dc(0x2f6)]='';}function createAnim(){const _0x5ce0ca=_0x46983b;if(!currentSprite)return;const _0x6f2082=document[_0x5ce0ca(0x321)](_0x5ce0ca(0x19b))[_0x5ce0ca(0x2f6)][_0x5ce0ca(0x312)]();if(!_0x6f2082){alert(_0x5ce0ca(0x2c9));return;}const _0x5b5960=new Anim(_0x6f2082);currentSprite[_0x5ce0ca(0x2d3)][_0x5ce0ca(0x2d6)](_0x5b5960);const _0xac134c=new Frame(),_0x2c8b8b=new AnimFrame(_0xac134c,!![]);_0x5b5960[_0x5ce0ca(0x25e)][_0x5ce0ca(0x2d6)](_0x2c8b8b),renderAnimList(),hideNewAnimModal();}function showUploadImageModal(){const _0x1a888e=_0x46983b;document[_0x1a888e(0x321)](_0x1a888e(0x2ce))[_0x1a888e(0x21b)][_0x1a888e(0x2a7)]=_0x1a888e(0x226);}function hideUploadImageModal(){const _0x51e64f=_0x46983b;document[_0x51e64f(0x321)](_0x51e64f(0x2ce))[_0x51e64f(0x21b)]['display']='none',document['getElementById']('modal-image-upload')['value']='';}function toggleCropping(){const _0x129e96=_0x46983b;if(!currentImage){alert(_0x129e96(0x1fa));return;}editMode=_0x129e96(0x1c2),isCropping=!![],document[_0x129e96(0x321)]('crop-module')[_0x129e96(0x27c)]['add'](_0x129e96(0x23d)),document[_0x129e96(0x321)](_0x129e96(0x22d))[_0x129e96(0x27c)][_0x129e96(0x2b1)](_0x129e96(0x23d)),selectedImageModule=-0x1,drawCurrentImage();}function toggleEditModule(){const _0x31e159=_0x46983b;if(!currentImage||(!currentSprite||!currentSprite[_0x31e159(0x274)](currentImageId)||currentSprite[_0x31e159(0x274)](currentImageId)[_0x31e159(0x2b2)][_0x31e159(0x31f)]===0x0)){alert(_0x31e159(0x262));return;}editMode=_0x31e159(0x1c7),isCropping=![],document[_0x31e159(0x321)]('crop-module')[_0x31e159(0x27c)][_0x31e159(0x2b1)]('active'),document[_0x31e159(0x321)]('edit-module')['classList'][_0x31e159(0x2b6)](_0x31e159(0x23d)),cropLeft=0x0,cropTop=0x0,cropWidth=0x0,cropHeight=0x0,isImageModuleRangeMoving=![],resizeMode=null,moduleInfo&&(moduleInfo['style'][_0x31e159(0x2a7)]=_0x31e159(0x243)),drawCurrentImage();}function showImageMousePosition(_0x5f312e){const _0x562bba=_0x46983b,_0x442ab9=imageCanvas[_0x562bba(0x346)](),_0x5188cb=imageCanvas['width']/_0x442ab9['width'],_0x1b2408=(_0x5f312e[_0x562bba(0x1a4)]-_0x442ab9['left'])*_0x5188cb,_0x440c3a=(_0x5f312e['clientY']-_0x442ab9[_0x562bba(0x22b)])*_0x5188cb;let _0x21ebf9=0x0,_0x29a316=0x0,_0x5d8bb9=0x0,_0x3ff47e=0x0;console[_0x562bba(0x326)](_0x562bba(0x15c),_0x5188cb,_0x562bba(0x293),imageCanvas[_0x562bba(0x2d1)],_0x562bba(0x193),_0x442ab9[_0x562bba(0x2d1)],_0x562bba(0x160),currentImage[_0x562bba(0x2d1)],'zoomLevel:',zoomLevel),currentImage&&(_0x5d8bb9=Math[_0x562bba(0x21d)]((imageCanvas[_0x562bba(0x2d1)]-currentImage[_0x562bba(0x2d1)]*zoomLevel)/0x2),_0x3ff47e=Math[_0x562bba(0x21d)]((imageCanvas[_0x562bba(0x22f)]-currentImage[_0x562bba(0x22f)]*zoomLevel)/0x2),console[_0x562bba(0x291)]('imageOriX:',_0x5d8bb9,_0x562bba(0x1e5),_0x3ff47e),_0x21ebf9=Math[_0x562bba(0x21d)]((_0x1b2408-_0x5d8bb9)/zoomLevel),_0x29a316=Math[_0x562bba(0x21d)]((_0x440c3a-_0x3ff47e)/zoomLevel)),document[_0x562bba(0x321)]('image-mouse-position')[_0x562bba(0x2f0)]=_0x562bba(0x20c)+Math[_0x562bba(0x21d)](_0x1b2408)+',\x20'+Math[_0x562bba(0x21d)](_0x440c3a)+_0x562bba(0x341)+_0x5d8bb9+',\x20'+_0x3ff47e+_0x562bba(0x225)+_0x21ebf9+',\x20'+_0x29a316+')\x20全局('+_0x5f312e['clientX']+',\x20'+_0x5f312e[_0x562bba(0x23f)]+'))';}function getImageEditXY(_0x25a7ac){const _0x43b42d=_0x46983b,_0x4f4fec=imageCanvas[_0x43b42d(0x346)](),_0x4c2a2b=imageCanvas[_0x43b42d(0x2d1)]/_0x4f4fec['width'],_0xf54f14=(_0x25a7ac[_0x43b42d(0x1a4)]-_0x4f4fec['left'])*_0x4c2a2b,_0x254ae0=(_0x25a7ac[_0x43b42d(0x23f)]-_0x4f4fec['top'])*_0x4c2a2b;if(!currentImage)return{'clickX':_0xf54f14,'clickY':_0x254ae0,'imageOriX':0x0,'imageOriY':0x0,'imageX':0x0,'imageY':0x0};const _0xe5f412=Math[_0x43b42d(0x21d)]((imageCanvas[_0x43b42d(0x2d1)]-currentImage[_0x43b42d(0x2d1)]*zoomLevel)/0x2),_0x84c956=Math['round']((imageCanvas['height']-currentImage[_0x43b42d(0x22f)]*zoomLevel)/0x2);return imageX=Math['round']((_0xf54f14-_0xe5f412)/zoomLevel),imageY=Math[_0x43b42d(0x21d)]((_0x254ae0-_0x84c956)/zoomLevel),{'clickX':_0xf54f14,'clickY':_0x254ae0,'imageOriX':_0xe5f412,'imageOriY':_0x84c956,'imageX':imageX,'imageY':imageY};}function handleImageMouseDown(_0x58e689){const _0x27957e=_0x46983b;if(!currentImage)return;const {clickX:_0x15847f,clickY:_0x3d24b9,imageOriX:_0x230b5b,imageOriY:_0x2c9462,imageX:_0x42f6af,imageY:_0x2dfe49}=getImageEditXY(_0x58e689);console[_0x27957e(0x326)](_0x27957e(0x265),_0x230b5b,_0x2c9462);if(editMode===_0x27957e(0x1c2)){if(!isCropping)return;const _0x415a06=_0x230b5b+cropLeft*zoomLevel,_0x1c5649=_0x2c9462+cropTop*zoomLevel,_0x51ab48=cropWidth*zoomLevel,_0x3156cc=cropHeight*zoomLevel,_0x24c7a4=0x6;if(cropWidth>0x0&&cropHeight>0x0&&_0x15847f>=_0x415a06-_0x24c7a4/0x2&&_0x15847f<=_0x415a06+_0x51ab48+_0x24c7a4/0x2&&_0x3d24b9>=_0x1c5649-_0x24c7a4/0x2&&_0x3d24b9<=_0x1c5649+_0x3156cc+_0x24c7a4/0x2){isImageModuleRangeMoving=![],initialLeft=cropLeft,initialTop=cropTop,initialWidth=cropWidth,initialHeight=cropHeight,dragStartX=_0x15847f,dragStartY=_0x3d24b9;if(_0x15847f<=_0x415a06+_0x24c7a4){if(_0x3d24b9<=_0x1c5649+_0x24c7a4)resizeMode='top-left';else _0x3d24b9>=_0x1c5649+_0x3156cc-_0x24c7a4?resizeMode=_0x27957e(0x1d8):resizeMode=_0x27957e(0x250);}else{if(_0x15847f>=_0x415a06+_0x51ab48-_0x24c7a4){if(_0x3d24b9<=_0x1c5649+_0x24c7a4)resizeMode=_0x27957e(0x1d9);else _0x3d24b9>=_0x1c5649+_0x3156cc-_0x24c7a4?resizeMode=_0x27957e(0x1fb):resizeMode='right';}else{if(_0x3d24b9<=_0x1c5649+_0x24c7a4)resizeMode=_0x27957e(0x22b);else _0x3d24b9>=_0x1c5649+_0x3156cc-_0x24c7a4?resizeMode='bottom':resizeMode=_0x27957e(0x308);}}}else isImageModuleRangeMoving=!![],resizeMode=null,cropStartX=_0x42f6af,cropStartY=_0x2dfe49,cropLeft=cropStartX,cropTop=cropStartY,cropWidth=0x0,cropHeight=0x0,drawCurrentImage();}else{if(editMode===_0x27957e(0x1c7)){const _0x1c299f=currentSprite[_0x27957e(0x274)](currentImageId);if(!_0x1c299f||!_0x1c299f[_0x27957e(0x2b2)])return;let _0x37f963=-0x1;for(let _0x5dbdf8=0x0;_0x5dbdf8<_0x1c299f['modulesList'][_0x27957e(0x31f)];_0x5dbdf8++){const _0x5eca92=_0x1c299f[_0x27957e(0x2b2)][_0x5dbdf8],_0x21262=_0x5eca92['x'],_0x2f506e=_0x5eca92['y'],_0x27d314=_0x5eca92['x']+_0x5eca92['width'],_0x58bd1f=_0x5eca92['y']+_0x5eca92[_0x27957e(0x22f)];if(_0x42f6af>=_0x21262&&_0x42f6af<=_0x27d314&&_0x2dfe49>=_0x2f506e&&_0x2dfe49<=_0x58bd1f){_0x37f963=_0x5dbdf8;break;}}if(_0x37f963!==-0x1){selectedImageModule=_0x37f963;const _0x35ecc5=_0x1c299f['modulesList'][selectedImageModule];initialLeft=_0x35ecc5['x'],initialTop=_0x35ecc5['y'],initialWidth=_0x35ecc5[_0x27957e(0x2d1)],initialHeight=_0x35ecc5['height'],dragStartX=_0x15847f,dragStartY=_0x3d24b9;const _0x43f00d=_0x230b5b+_0x35ecc5['x']*zoomLevel,_0x57a505=_0x2c9462+_0x35ecc5['y']*zoomLevel,_0x2104a7=_0x43f00d+_0x35ecc5['width']*zoomLevel,_0x2382d6=_0x57a505+_0x35ecc5['height']*zoomLevel,_0x2a78db=0xf;if(_0x15847f<=_0x43f00d+_0x2a78db){if(_0x3d24b9<=_0x57a505+_0x2a78db)resizeMode='top-left';else _0x3d24b9>=_0x2382d6-_0x2a78db?resizeMode=_0x27957e(0x1d8):resizeMode='left';}else{if(_0x15847f>=_0x2104a7-_0x2a78db){if(_0x3d24b9<=_0x57a505+_0x2a78db)resizeMode=_0x27957e(0x1d9);else _0x3d24b9>=_0x2382d6-_0x2a78db?resizeMode=_0x27957e(0x1fb):resizeMode='right';}else{if(_0x3d24b9<=_0x57a505+_0x2a78db)resizeMode=_0x27957e(0x22b);else _0x3d24b9>=_0x2382d6-_0x2a78db?resizeMode='bottom':resizeMode='move';}}}else selectedImageModule=-0x1,resizeMode=null,drawCurrentImage();}}}function handleImageMouseMove(_0x117957){const _0x214d20=_0x46983b;if(!currentImage)return;const _0x4d4eb9=imageCanvas[_0x214d20(0x346)](),_0x13813b=imageCanvas[_0x214d20(0x2d1)]/_0x4d4eb9[_0x214d20(0x2d1)],_0xb14352=(_0x117957['clientX']-_0x4d4eb9[_0x214d20(0x250)])*_0x13813b,_0x8a864f=(_0x117957[_0x214d20(0x23f)]-_0x4d4eb9[_0x214d20(0x22b)])*_0x13813b;if(resizeMode){let _0x5e8616=initialLeft,_0x54c999=initialTop,_0x32ecb2=initialWidth,_0x346a97=initialHeight;switch(resizeMode){case _0x214d20(0x308):const _0x50c38a=(_0xb14352-dragStartX)/zoomLevel,_0x5d05a8=(_0x8a864f-dragStartY)/zoomLevel;_0x5e8616=initialLeft+_0x50c38a,_0x54c999=initialTop+_0x5d05a8;break;case _0x214d20(0x250):_0x5e8616=initialLeft+(_0xb14352-dragStartX)/zoomLevel,_0x32ecb2=initialWidth-(_0xb14352-dragStartX)/zoomLevel;break;case _0x214d20(0x18d):_0x32ecb2=initialWidth+(_0xb14352-dragStartX)/zoomLevel;break;case'top':_0x54c999=initialTop+(_0x8a864f-dragStartY)/zoomLevel,_0x346a97=initialHeight-(_0x8a864f-dragStartY)/zoomLevel;break;case _0x214d20(0x2bf):_0x346a97=initialHeight+(_0x8a864f-dragStartY)/zoomLevel;break;case _0x214d20(0x1c3):_0x5e8616=initialLeft+(_0xb14352-dragStartX)/zoomLevel,_0x54c999=initialTop+(_0x8a864f-dragStartY)/zoomLevel,_0x32ecb2=initialWidth-(_0xb14352-dragStartX)/zoomLevel,_0x346a97=initialHeight-(_0x8a864f-dragStartY)/zoomLevel;break;case _0x214d20(0x1d9):_0x54c999=initialTop+(_0x8a864f-dragStartY)/zoomLevel,_0x32ecb2=initialWidth+(_0xb14352-dragStartX)/zoomLevel,_0x346a97=initialHeight-(_0x8a864f-dragStartY)/zoomLevel;break;case _0x214d20(0x1d8):_0x5e8616=initialLeft+(_0xb14352-dragStartX)/zoomLevel,_0x32ecb2=initialWidth-(_0xb14352-dragStartX)/zoomLevel,_0x346a97=initialHeight+(_0x8a864f-dragStartY)/zoomLevel;break;case'bottom-right':_0x32ecb2=initialWidth+(_0xb14352-dragStartX)/zoomLevel,_0x346a97=initialHeight+(_0x8a864f-dragStartY)/zoomLevel;break;}if(_0x32ecb2<0x5)_0x32ecb2=0x5;if(_0x346a97<0x5)_0x346a97=0x5;const _0x11dc19=currentImage[_0x214d20(0x2d1)]-_0x32ecb2,_0x194f5d=currentImage[_0x214d20(0x22f)]-_0x346a97;_0x5e8616=Math['max'](0x0,Math[_0x214d20(0x32d)](_0x5e8616,_0x11dc19)),_0x54c999=Math[_0x214d20(0x2f1)](0x0,Math[_0x214d20(0x32d)](_0x54c999,_0x194f5d));if(editMode===_0x214d20(0x1c2)&&isCropping)cropLeft=_0x5e8616,cropTop=_0x54c999,cropWidth=_0x32ecb2,cropHeight=_0x346a97;else{if(editMode==='edit'&&selectedImageModule!==-0x1){const _0x38fcee=currentSprite[_0x214d20(0x274)](currentImageId);_0x38fcee&&_0x38fcee[_0x214d20(0x2b2)]&&_0x38fcee['modulesList'][selectedImageModule]&&(_0x38fcee[_0x214d20(0x2b2)][selectedImageModule]['x']=_0x5e8616,_0x38fcee[_0x214d20(0x2b2)][selectedImageModule]['y']=_0x54c999,_0x38fcee[_0x214d20(0x2b2)][selectedImageModule][_0x214d20(0x2d1)]=_0x32ecb2,_0x38fcee[_0x214d20(0x2b2)][selectedImageModule][_0x214d20(0x22f)]=_0x346a97);}}drawCurrentImage();}else{if(editMode===_0x214d20(0x1c2)&&isCropping&&isImageModuleRangeMoving){const _0xe7811e=(imageCanvas[_0x214d20(0x2d1)]-currentImage[_0x214d20(0x2d1)]*zoomLevel)/0x2,_0x257216=(imageCanvas[_0x214d20(0x22f)]-currentImage['height']*zoomLevel)/0x2,_0x1db221=(_0xb14352-_0xe7811e)/zoomLevel,_0x4b753f=(_0x8a864f-_0x257216)/zoomLevel,_0x5d0fa5=Math['min'](cropStartX,_0x1db221),_0x25c887=Math[_0x214d20(0x32d)](cropStartY,_0x4b753f),_0x2e2bd4=Math[_0x214d20(0x31d)](_0x1db221-cropStartX),_0x1e2d04=Math['abs'](_0x4b753f-cropStartY),_0x30c243=Math[_0x214d20(0x2f1)](0x0,_0x5d0fa5),_0x270b91=Math[_0x214d20(0x2f1)](0x0,_0x25c887),_0x5257b8=Math[_0x214d20(0x32d)](_0x2e2bd4,currentImage['width']-_0x30c243),_0x666233=Math[_0x214d20(0x32d)](_0x1e2d04,currentImage['height']-_0x270b91);cropLeft=_0x30c243,cropTop=_0x270b91,cropWidth=_0x5257b8,cropHeight=_0x666233,drawCurrentImage();}else{if(editMode===_0x214d20(0x1c7)){const _0x1d21ba=(imageCanvas[_0x214d20(0x2d1)]-currentImage[_0x214d20(0x2d1)]*zoomLevel)/0x2,_0x2a8242=(imageCanvas['height']-currentImage[_0x214d20(0x22f)]*zoomLevel)/0x2,_0x58b73d=currentSprite[_0x214d20(0x274)](currentImageId);if(!_0x58b73d||!_0x58b73d[_0x214d20(0x2b2)]){imageCanvas[_0x214d20(0x21b)][_0x214d20(0x252)]=_0x214d20(0x268);return;}const _0x347a64=(_0x117957['clientX']-_0x4d4eb9[_0x214d20(0x250)]-_0x1d21ba)/zoomLevel,_0x5b6ef3=(_0x117957[_0x214d20(0x23f)]-_0x4d4eb9['top']-_0x2a8242)/zoomLevel;for(let _0x5a4494=0x0;_0x5a4494<_0x58b73d[_0x214d20(0x2b2)]['length'];_0x5a4494++){const _0x1e7f08=_0x58b73d[_0x214d20(0x2b2)][_0x5a4494],_0x5c4404=_0x1d21ba+_0x1e7f08['x']*zoomLevel,_0x4eb003=_0x2a8242+_0x1e7f08['y']*zoomLevel,_0x2f0d99=_0x5c4404+_0x1e7f08[_0x214d20(0x2d1)]*zoomLevel,_0x341d77=_0x4eb003+_0x1e7f08[_0x214d20(0x22f)]*zoomLevel,_0x42d015=0xf;if(_0xb14352>=_0x5c4404-_0x42d015/0x2&&_0xb14352<=_0x2f0d99+_0x42d015/0x2&&_0x8a864f>=_0x4eb003-_0x42d015/0x2&&_0x8a864f<=_0x341d77+_0x42d015/0x2){if(_0xb14352<=_0x5c4404+_0x42d015){if(_0x8a864f<=_0x4eb003+_0x42d015)imageCanvas[_0x214d20(0x21b)][_0x214d20(0x252)]='nwse-resize';else _0x8a864f>=_0x341d77-_0x42d015?imageCanvas[_0x214d20(0x21b)]['cursor']=_0x214d20(0x1f3):imageCanvas[_0x214d20(0x21b)]['cursor']=_0x214d20(0x2fa);}else{if(_0xb14352>=_0x2f0d99-_0x42d015){if(_0x8a864f<=_0x4eb003+_0x42d015)imageCanvas[_0x214d20(0x21b)][_0x214d20(0x252)]='nesw-resize';else _0x8a864f>=_0x341d77-_0x42d015?imageCanvas[_0x214d20(0x21b)][_0x214d20(0x252)]=_0x214d20(0x2c5):imageCanvas[_0x214d20(0x21b)][_0x214d20(0x252)]=_0x214d20(0x2fa);}else{if(_0x8a864f<=_0x4eb003+_0x42d015)imageCanvas['style']['cursor']=_0x214d20(0x261);else _0x8a864f>=_0x341d77-_0x42d015?imageCanvas['style']['cursor']=_0x214d20(0x261):imageCanvas[_0x214d20(0x21b)][_0x214d20(0x252)]=_0x214d20(0x308);}}return;}}imageCanvas[_0x214d20(0x21b)][_0x214d20(0x252)]=_0x214d20(0x268);}}}}function handleImageMouseUp(){const _0x59a4e6=_0x46983b;if(!currentImage)return;isImageModuleRangeMoving=![],resizeMode=null;if(editMode===_0x59a4e6(0x1c2)&&isCropping){const _0x452eb7=cropWidth*zoomLevel,_0x42a8b7=cropHeight*zoomLevel;if(_0x452eb7>0xa&&_0x42a8b7>0xa){const _0x5d0f6c=document[_0x59a4e6(0x321)](_0x59a4e6(0x253));_0x5d0f6c&&(_0x5d0f6c[_0x59a4e6(0x2f0)]=_0x59a4e6(0x290)+Math[_0x59a4e6(0x21d)](_0x452eb7)+'x'+Math[_0x59a4e6(0x21d)](_0x42a8b7)+_0x59a4e6(0x257),_0x5d0f6c['style']['display']=_0x59a4e6(0x1cc));}else{if(_0x452eb7>0x0&&_0x42a8b7>0x0){cropLeft=0x0,cropTop=0x0,cropWidth=0x0,cropHeight=0x0,drawCurrentImage();const _0x22408d=document[_0x59a4e6(0x321)](_0x59a4e6(0x253));_0x22408d&&(_0x22408d[_0x59a4e6(0x21b)][_0x59a4e6(0x2a7)]='none');}}}else editMode===_0x59a4e6(0x1c7)&&drawCurrentImage();}function handleImageMouseDblClick(_0x52400a){const _0x586667=_0x46983b;console['log'](_0x586667(0x1e1));if(!isCropping||!currentImage)return;_0x52400a['stopPropagation'](),console[_0x586667(0x326)](_0x586667(0x1a0));const _0x194de2=(imageCanvas[_0x586667(0x2d1)]-currentImage[_0x586667(0x2d1)]*zoomLevel)/0x2,_0x13c936=(imageCanvas['height']-currentImage['height']*zoomLevel)/0x2;console[_0x586667(0x326)]('图片在画布上的绘制位置：',_0x194de2,_0x13c936);const _0x19086f=imageCanvas['getBoundingClientRect'](),_0x4ce1d5=imageCanvas['width']/_0x19086f[_0x586667(0x2d1)],_0x44a7a7=((_0x52400a[_0x586667(0x1a4)]-_0x19086f[_0x586667(0x250)])*_0x4ce1d5-_0x194de2)/zoomLevel,_0x324076=((_0x52400a[_0x586667(0x23f)]-_0x19086f[_0x586667(0x22b)])*_0x4ce1d5-_0x13c936)/zoomLevel;console['log']('imageX',_0x44a7a7,_0x586667(0x301),_0x324076,'cropRange:',cropLeft,cropTop,cropWidth,cropHeight),isCropping&&_0x44a7a7>=cropLeft&&_0x44a7a7<=cropLeft+cropWidth&&_0x324076>=cropTop&&_0x324076<=cropTop+cropHeight&&saveModule();}function saveModule(){const _0x52b4d5=_0x46983b;if(!currentImage||!isCropping){alert('请先框选一个模块');return;}const _0x3e38b2=cropLeft,_0x1b91ae=cropTop,_0x296efe=cropWidth,_0x50d751=cropHeight;if(_0x296efe<0xa||_0x50d751<0xa){alert('模块尺寸过小，请重新框选');return;}if(currentSprite&&currentImageId){const _0x578c3f=currentSprite[_0x52b4d5(0x274)](currentImageId);if(_0x578c3f){const _0x322fa6=_0x578c3f[_0x52b4d5(0x2b2)][_0x52b4d5(0x31f)];_0x578c3f[_0x52b4d5(0x2b2)][_0x52b4d5(0x2d6)]({'x':Math[_0x52b4d5(0x21d)](_0x3e38b2),'y':Math[_0x52b4d5(0x21d)](_0x1b91ae),'width':Math['round'](_0x296efe),'height':Math[_0x52b4d5(0x21d)](_0x50d751)}),cropLeft=0x0,cropTop=0x0,cropWidth=0x0,cropHeight=0x0,drawCurrentImage(),console[_0x52b4d5(0x326)](_0x52b4d5(0x33d)),renderModulesList();}}}function renderModulesList(){const _0x4b853f=_0x46983b,_0x372bd4=document[_0x4b853f(0x321)](_0x4b853f(0x2d0));_0x372bd4[_0x4b853f(0x196)]='';if(!currentSprite||!currentImageId)return;const _0x43690b=currentSprite['getImage'](currentImageId);if(!_0x43690b||_0x43690b['modulesList']['length']===0x0)return;_0x43690b[_0x4b853f(0x2b2)][_0x4b853f(0x294)]((_0x27089f,_0x308d74)=>{const _0x30b384=_0x4b853f,_0x2ca900=document[_0x30b384(0x161)](_0x30b384(0x2d4));_0x2ca900[_0x30b384(0x1c9)]=_0x30b384(0x280)+(selectedImageModule===_0x308d74||selectedImageModules[_0x30b384(0x228)](_0x308d74)?_0x30b384(0x1cb):'');const _0x5cebec=document['createElement']('canvas');_0x5cebec[_0x30b384(0x2d1)]=0x50,_0x5cebec[_0x30b384(0x22f)]=0x50;const _0x1a90f8=_0x5cebec[_0x30b384(0x1b3)]('2d'),_0x427d36=Math[_0x30b384(0x32d)](0x50/_0x27089f['width'],0x50/_0x27089f['height']),_0x24d9c5=_0x27089f[_0x30b384(0x2d1)]*_0x427d36,_0x28a22b=_0x27089f[_0x30b384(0x22f)]*_0x427d36;_0x1a90f8[_0x30b384(0x1ff)](currentImage,_0x27089f['x'],_0x27089f['y'],_0x27089f[_0x30b384(0x2d1)],_0x27089f['height'],(0x50-_0x24d9c5)/0x2,(0x50-_0x28a22b)/0x2,_0x24d9c5,_0x28a22b),_0x2ca900[_0x30b384(0x1d0)](_0x5cebec);const _0x5e40f0=document[_0x30b384(0x161)](_0x30b384(0x2d4));_0x5e40f0[_0x30b384(0x21b)][_0x30b384(0x168)]=_0x30b384(0x220),_0x5e40f0[_0x30b384(0x21b)][_0x30b384(0x2bf)]=_0x30b384(0x1fc),_0x5e40f0['style'][_0x30b384(0x18d)]=_0x30b384(0x25d),_0x5e40f0[_0x30b384(0x21b)][_0x30b384(0x2a1)]=_0x30b384(0x2f9),_0x5e40f0[_0x30b384(0x21b)][_0x30b384(0x19f)]=_0x30b384(0x320),_0x5e40f0[_0x30b384(0x21b)][_0x30b384(0x182)]=_0x30b384(0x345),_0x5e40f0[_0x30b384(0x21b)][_0x30b384(0x1b9)]=_0x30b384(0x298),_0x5e40f0[_0x30b384(0x21b)][_0x30b384(0x2a6)]=_0x30b384(0x1f6),_0x5e40f0[_0x30b384(0x2f0)]=_0x308d74+0x1,_0x2ca900[_0x30b384(0x1d0)](_0x5e40f0);const _0xf59c88=document[_0x30b384(0x161)]('button');_0xf59c88['style']['position']='absolute',_0xf59c88[_0x30b384(0x21b)][_0x30b384(0x22b)]=_0x30b384(0x1fc),_0xf59c88['style'][_0x30b384(0x18d)]=_0x30b384(0x1fc),_0xf59c88[_0x30b384(0x21b)][_0x30b384(0x2d1)]='16px',_0xf59c88[_0x30b384(0x21b)][_0x30b384(0x22f)]=_0x30b384(0x16a),_0xf59c88[_0x30b384(0x21b)][_0x30b384(0x2a1)]=_0x30b384(0x24f),_0xf59c88[_0x30b384(0x21b)][_0x30b384(0x19f)]=_0x30b384(0x320),_0xf59c88[_0x30b384(0x21b)][_0x30b384(0x2ad)]=_0x30b384(0x243),_0xf59c88[_0x30b384(0x21b)][_0x30b384(0x1b9)]=_0x30b384(0x298),_0xf59c88[_0x30b384(0x21b)]['fontSize']=_0x30b384(0x1b8),_0xf59c88['style']['lineHeight']='14px',_0xf59c88[_0x30b384(0x21b)][_0x30b384(0x21f)]='center',_0xf59c88['style']['cursor']=_0x30b384(0x336),_0xf59c88['style'][_0x30b384(0x2a7)]=_0x30b384(0x226),_0xf59c88[_0x30b384(0x21b)][_0x30b384(0x297)]=_0x30b384(0x28e),_0xf59c88[_0x30b384(0x21b)][_0x30b384(0x1be)]='center',_0xf59c88['textContent']='×',_0xf59c88['addEventListener'](_0x30b384(0x295),_0x405d20=>{const _0x5548ba=_0x30b384;_0x405d20[_0x5548ba(0x292)](),confirm(_0x5548ba(0x2f2))&&(_0x43690b['modulesList'][_0x5548ba(0x195)](_0x308d74,0x1),renderModulesList(),drawCurrentImage());}),_0x2ca900[_0x30b384(0x1d0)](_0xf59c88),_0x2ca900[_0x30b384(0x316)](_0x30b384(0x295),_0xd2f499=>{const _0x2a157a=_0x30b384;if(isCtrlPressed){const _0x400f8a=selectedImageModules['indexOf'](_0x308d74);_0x400f8a===-0x1?selectedImageModules[_0x2a157a(0x2d6)](_0x308d74):selectedImageModules[_0x2a157a(0x195)](_0x400f8a,0x1),selectedImageModule=-0x1;}else selectedImageModule=_0x308d74,selectedImageModules=[];renderModulesList(),drawCurrentImage();}),_0x372bd4['appendChild'](_0x2ca900);});}function showAddModuleModal(){const _0x6c2890=_0x46983b;if(isEditingExpressionRect)return;if(!currentFrame){alert(_0x6c2890(0x27b));return;}if(!hasAvailableModules()){alert(_0x6c2890(0x19e)),switchTab(_0x6c2890(0x2ac));return;}addRandomModule();}function hasAvailableModules(){const _0x5c19db=_0x46983b;if(!currentSprite)return![];for(const _0x2864b8 of currentSprite['m_imageList']){if(_0x2864b8['modulesList'][_0x5c19db(0x31f)]>0x0)return!![];}return![];}function addRandomModule(){const _0x1e0b5a=_0x46983b;if(isEditingExpressionRect)return;if(!currentSprite||!currentFrame)return;const _0x4bd8eb=[];currentSprite[_0x1e0b5a(0x233)]['forEach'](_0x1735df=>{const _0x1981e4=_0x1e0b5a;_0x1735df[_0x1981e4(0x2b2)][_0x1981e4(0x294)]((_0x56eb25,_0x290f59)=>{const _0xbf2e86=_0x1981e4;_0x4bd8eb[_0xbf2e86(0x2d6)]({'imageId':_0x1735df['id'],'moduleIndex':_0x290f59});});});if(_0x4bd8eb['length']===0x0)return;const _0x3f312e=_0x4bd8eb[Math[_0x1e0b5a(0x170)](Math[_0x1e0b5a(0x23b)]()*_0x4bd8eb[_0x1e0b5a(0x31f)])],_0x62f4fd=new Module(_0x3f312e[_0x1e0b5a(0x25f)],_0x3f312e[_0x1e0b5a(0x178)]),_0x2b1651=new FrameModule(_0x62f4fd,0x0,0x0,0x0);CommandManager[_0x1e0b5a(0x19c)]['addCommand'](new AddFmCommand(currentFrame,_0x2b1651)),renderCanvas(0x3);}function addFrame(){const _0x14f865=_0x46983b;if(!currentAnim){alert(_0x14f865(0x218));return;}const _0x1ee543=new Frame(),_0x12eb9f=new AnimFrame(_0x1ee543,!![]);currentAnim['aframeList']['splice'](currentFrameIndex+0x1,0x0,_0x12eb9f),renderTimeline(),selectFrame(currentFrameIndex+0x1);}function addFrameToEnd(){const _0x46311a=_0x46983b;if(!currentAnim){alert(_0x46311a(0x218));return;}const _0x20ab0d=new Frame(),_0x3f1790=new AnimFrame(_0x20ab0d,!![]);currentAnim['aframeList'][_0x46311a(0x2d6)](_0x3f1790),renderTimeline(),selectFrame(currentAnim['aframeList'][_0x46311a(0x31f)]-0x1);}function cloneFrame(){const _0x1193a8=_0x46983b;if(!currentAnim||!currentFrame){alert(_0x1193a8(0x27b));return;}const _0x120783=currentFrame[_0x1193a8(0x237)](),_0x52e322=currentAnim[_0x1193a8(0x25e)][currentFrameIndex],_0x4df0f0=_0x52e322[_0x1193a8(0x21e)],_0x3a65a4=new AnimFrame(_0x120783,_0x52e322[_0x1193a8(0x174)],_0x4df0f0?{..._0x4df0f0}:{'x':0x0,'y':0x0,'width':0x32,'height':0x3c});currentAnim[_0x1193a8(0x25e)][_0x1193a8(0x195)](currentFrameIndex+0x1,0x0,_0x3a65a4),selectFrame(currentFrameIndex+0x1),showNotification(_0x1193a8(0x17f)),selectFrame(currentFrameIndex+0x1);}function deleteFrame(){const _0x15753f=_0x46983b;if(!currentAnim||currentAnim[_0x15753f(0x25e)][_0x15753f(0x31f)]<=0x1){alert('至少需要保留一帧');return;}currentAnim[_0x15753f(0x25e)][_0x15753f(0x195)](currentFrameIndex,0x1),currentFrameIndex=Math[_0x15753f(0x32d)](currentFrameIndex,currentAnim['aframeList']['length']-0x1),currentFrame=currentAnim[_0x15753f(0x25e)][currentFrameIndex][_0x15753f(0x296)],selectedModuleIndex=-0x1,renderTimeline(),renderCanvas(0x4),document[_0x15753f(0x321)](_0x15753f(0x24d))[_0x15753f(0x2f0)]=currentAnim[_0x15753f(0x1db)]+_0x15753f(0x303)+(currentFrameIndex+0x1);}function undoAction(){const _0x27637a=_0x46983b;CommandManager[_0x27637a(0x19c)][_0x27637a(0x2e0)](),renderCanvas(0x7),renderModulesList(),renderTimeline();}function redoAction(){const _0x34f4d0=_0x46983b;CommandManager[_0x34f4d0(0x19c)][_0x34f4d0(0x2cb)](),renderCanvas(0x7),renderModulesList(),renderTimeline();}function deleteFrameModule(){const _0x96256c=_0x46983b;if(isEditingExpressionRect)return;if(!currentFrame||selectedModuleIndex<0x0)return;const _0x458200=currentFrame[_0x96256c(0x186)][selectedModuleIndex],_0x1a51b7={'execute':function(){},'undo':function(){const _0x36574c=_0x96256c;currentFrame['fmList'][_0x36574c(0x195)](selectedModuleIndex,0x0,_0x458200),selectedModuleIndex=selectedModuleIndex,renderCanvas(0x5),updateModuleProperties(_0x458200);}};CommandManager[_0x96256c(0x19c)][_0x96256c(0x206)](_0x1a51b7),console[_0x96256c(0x326)]('delete\x20fm:',selectedModuleIndex),currentFrame[_0x96256c(0x186)][_0x96256c(0x195)](selectedModuleIndex,0x1),selectedModuleIndex=-0x1,renderCanvas(0x6);}function copyModule(){const _0x33581e=_0x46983b;if(isEditingExpressionRect)return;if(!currentFrame||selectedModuleIndex<0x0&&selectedModuleIndices[_0x33581e(0x31f)]===0x0)return;if(selectedModuleIndices[_0x33581e(0x31f)]>0x1){copiedModuleInfos=[];for(const _0x2b2d44 of selectedModuleIndices){const _0x11e05e=currentFrame[_0x33581e(0x186)][_0x2b2d44];copiedModuleInfos[_0x33581e(0x2d6)](_0x11e05e[_0x33581e(0x237)]());}copiedModuleInfo=null,showNotification(_0x33581e(0x272)+selectedModuleIndices['length']+_0x33581e(0x27d));}else{if(selectedModuleIndex>=0x0){const _0x20f57c=currentFrame[_0x33581e(0x186)][selectedModuleIndex];copiedModuleInfo=_0x20f57c[_0x33581e(0x237)](),copiedModuleInfos=null,showNotification(_0x33581e(0x309));}}}function pasteModule(){const _0x1beefb=_0x46983b;if(isEditingExpressionRect)return;if(!copiedModuleInfo&&!copiedModuleInfos||!currentFrame)return;const _0x4328e5=new CompositeCommand(),_0x58cd25=[];if(copiedModuleInfos&&copiedModuleInfos[_0x1beefb(0x31f)]>0x0){for(const _0x35f13e of copiedModuleInfos){const _0x2a7680=new FrameModule(_0x35f13e[_0x1beefb(0x2ff)],_0x35f13e['x']+0xa,_0x35f13e['y']+0xa,_0x35f13e['flag'],_0x35f13e[_0x1beefb(0x2ae)]?_0x35f13e[_0x1beefb(0x2ae)]:0x1,_0x35f13e[_0x1beefb(0x254)]?_0x35f13e[_0x1beefb(0x254)]:0x0);_0x4328e5[_0x1beefb(0x206)](new AddFmCommand(currentFrame,_0x2a7680));}CommandManager[_0x1beefb(0x19c)][_0x1beefb(0x206)](_0x4328e5);const _0x10ac0a=currentFrame[_0x1beefb(0x186)]['length']-copiedModuleInfos[_0x1beefb(0x31f)];selectedModuleIndices=[];for(let _0x11d9e8=_0x10ac0a;_0x11d9e8<currentFrame[_0x1beefb(0x186)][_0x1beefb(0x31f)];_0x11d9e8++){selectedModuleIndices['push'](_0x11d9e8);}selectedModuleIndex=selectedModuleIndices[0x0],updateModuleProperties(currentFrame[_0x1beefb(0x186)][selectedModuleIndex]),renderCanvas(0x7),showNotification(_0x1beefb(0x2c2)+copiedModuleInfos[_0x1beefb(0x31f)]+_0x1beefb(0x1a5));}else{if(copiedModuleInfo){const _0x4bdf9d=new FrameModule(copiedModuleInfo[_0x1beefb(0x2ff)],copiedModuleInfo['x']+0xa,copiedModuleInfo['y']+0xa,copiedModuleInfo['flag'],copiedModuleInfo[_0x1beefb(0x2ae)]?copiedModuleInfo[_0x1beefb(0x2ae)]:0x1,copiedModuleInfo[_0x1beefb(0x254)]?copiedModuleInfo[_0x1beefb(0x254)]:0x0);CommandManager['instance'][_0x1beefb(0x206)](new AddFmCommand(currentFrame,_0x4bdf9d)),selectedModuleIndex=currentFrame[_0x1beefb(0x186)][_0x1beefb(0x31f)]-0x1,selectedModuleIndices=[selectedModuleIndex],updateModuleProperties(currentFrame['fmList'][selectedModuleIndex]),renderCanvas(0x7),showNotification('模块已粘贴');}}}function showNotification(_0x9c1380){const _0x4e202a=_0x46983b;let _0x5c88d7=document['getElementById']('notification');!_0x5c88d7&&(_0x5c88d7=document[_0x4e202a(0x161)](_0x4e202a(0x2d4)),_0x5c88d7['id']=_0x4e202a(0x264),document[_0x4e202a(0x1b4)][_0x4e202a(0x1d0)](_0x5c88d7)),_0x5c88d7[_0x4e202a(0x2f0)]=_0x9c1380,_0x5c88d7[_0x4e202a(0x21b)][_0x4e202a(0x168)]=_0x4e202a(0x2bb),_0x5c88d7[_0x4e202a(0x21b)]['bottom']=_0x4e202a(0x30d),_0x5c88d7[_0x4e202a(0x21b)][_0x4e202a(0x18d)]=_0x4e202a(0x30d),_0x5c88d7['style'][_0x4e202a(0x182)]=_0x4e202a(0x29e),_0x5c88d7[_0x4e202a(0x21b)][_0x4e202a(0x2a1)]=_0x4e202a(0x203),_0x5c88d7[_0x4e202a(0x21b)][_0x4e202a(0x19f)]='white',_0x5c88d7[_0x4e202a(0x21b)][_0x4e202a(0x1b9)]=_0x4e202a(0x266),_0x5c88d7['style']['zIndex']=_0x4e202a(0x1cf),_0x5c88d7['style'][_0x4e202a(0x2fe)]='0',_0x5c88d7[_0x4e202a(0x21b)][_0x4e202a(0x339)]=_0x4e202a(0x330),setTimeout(()=>{const _0x5bb9c7=_0x4e202a;_0x5c88d7[_0x5bb9c7(0x21b)]['opacity']='1';},0xa),setTimeout(()=>{const _0x41cf62=_0x4e202a;_0x5c88d7[_0x41cf62(0x21b)][_0x41cf62(0x2fe)]='0';},0xbb8);}function flipHorizontal(){const _0xb7f1ae=_0x46983b;if(isEditingExpressionRect)return;if(!currentFrame||selectedModuleIndex<0x0&&selectedModuleIndices[_0xb7f1ae(0x31f)]===0x0)return;const _0x54ba56=new CompositeCommand();if(selectedModuleIndices[_0xb7f1ae(0x31f)]>0x1)for(const _0x5a6127 of selectedModuleIndices){const _0x5e9a6b=currentFrame['fmList'][_0x5a6127];_0x54ba56[_0xb7f1ae(0x206)](new FlipHorizontalCommand(_0x5e9a6b));}else{if(selectedModuleIndex>=0x0){console['log']('水平翻转前:',currentFrame[_0xb7f1ae(0x186)][selectedModuleIndex][_0xb7f1ae(0x2b3)]);const _0x301e76=currentFrame[_0xb7f1ae(0x186)][selectedModuleIndex];_0x54ba56[_0xb7f1ae(0x206)](new FlipHorizontalCommand(_0x301e76)),console[_0xb7f1ae(0x326)]('水平翻转后:',_0x301e76['flag']);}}CommandManager[_0xb7f1ae(0x19c)][_0xb7f1ae(0x206)](_0x54ba56),renderCanvas(0x8);}function _0x27b4(){const _0x3900ac=['ksdLJP/LM74O','zMXLEa','ywrKlwfUAw0','Aw5JBhvKzxm','5RkH5PYj5y+V5PkT5Ps+55Qe5yQO55s7','ChGGqxjPywW','Dg9W','zMLSzxm','zwrPDc1TB2r1Bgu','yw5PBs1SAxn0','AgvPz2H0','Dgv4DejHC2vSAw5L','i2zMzG','zgLZywjSzwq','Bv9PBwfNzuXPC3q','zMLSBfn0EwXL','C3rYB2TLu3r5Bgu','ywrKlwzYyw1LlwvUza','y2XVBMu','y3nZvgv4Da','C3bYAxrLlwXPC3q','y29UzMLYBs11CgXVywq','CMfUzg9T','B3jPz2LUywWTChjLDMLLDW','ywn0AxzL','B25KCM9W','y2XPzw50wq','6lcd6k+v6z2I5P2/5BEY5yID5AEl5yYw','CMvZAxPL','6yEn5zg95zcn','BM9Uzq','Bw91C2vKB3DU','ywrKlwzYyw1L','z3jHyG','mta5nda3wMHcq2Pl','zM9UDa','Aw1Hz2vnB2r1Bgvjza','ywX0','5lIn5A2y5zYO','y3jLyxrLlxnWCML0zq','y3vYCMvUDc1HBMLTlw5HBwu','Aw1Hz2uTBMfTzs1PDgvT','i2zMndq0na','BgvMDa','q2fSBgLUzYbYzw5KzxjjBwfNzvbYzxzPzxCGzNjVBsbZD2L0y2Huywi','y3vYC29Y','Bw9KDwXLlwLUzM8','yw5NBgu','AM9PBG','ndbbrefkDLa','ic0G5y+m5yE75yY65z+F56gU6k6K','zMLUzeLUzgv4','C2vSzwn0zwrjBwfNzu1VzhvSztO','z3jVDxa','CMvUzgvYq2fUDMfZoG','BwfYz2LU','mJvWEa','ywzYyw1LtgLZDa','Aw1Hz2vjza','q3rYBa','BNmTCMvZAxPL','6k+35ywi5lIk5lYG5zU+54Mh5BM25yIB5BU66iEZ5Bcr5lIa5lIQ5QIH5z2x','DgfYz2v0','BM90AwzPy2f0Aw9U','zhjHD1G6','nhb4','Bw91C2vSzwf2zq','zgvMyxvSDa','zM9JDxm','Bw9KDwXLlwHLAwDODa','lMv4ChjLC3nPB24TAxrLBq','5zU+54Mh6ycj5OUP77Yb','CxvLCNLtzwXLy3rVCKfSBa','yw5PBwf0Aw9UlxPVB20TB3v0','C3bLzwqTCMfUz2u','5Qoa5P+Lq2fUDMfZ54Q25Ocb','Aw1Hz2vZ','5BEY5Asn5yI2ia','C3jJ','z2v0sw1Hz2u','DxbSB2fKlwLTywDL','mc41','ywrKlwv4ChjLC3nPB24TCMvJDa','mta2ntKZmeLTr0zjwq','y29UC3rYDwn0B3i','ksdLV4xPOBVKUi7LJP/LM77NIyFLSlRLR7GGka','6k+35ywi6ycj5OUP5lIa5lIQ5BIN','y2XHC3nmAxn0','ios4QUAOOEwDL++8JowpR+s7PEI3QoEYVUEbTEEYMoI0Ta','y3jLyxrLvgv4De5Vzgu','yxjJ','Bw9KDwXLlwL0zw0','lsdLIQJKVzWG','q2fUBM90ihbVChvSyxrLigrYB3bKB3DUoIbPBwfNzs1KCM9Wzg93BIbLBgvTzw50ig5VDcbMB3vUza','Aw1Hz2uTzhjVCgrVD24','yw5PBs1Hy3rPB25Z','y3vYCMvUDeLTywDLoG','iZrLy2rJna','BwfSzq','z2v0qxr0CMLIDxrL','Aw1Hz2vZihrVigrYB3bKB3DU','6zQq6jEp572r5Qc8','EM9VBs1PBG','Ag9YAxPVBNrHBc1TAxjYB3i','y29WEs1TB2r1Bgu','y2vUDgvY','y29UDgvUDc1PBwfNzq','5BEY6ycj5OUP5yY65z+FoIa','zgvIDwC','C3rVCfbYB3bHz2f0Aw9U','55YF5yop57sGAw1Hz2vdyw52yxmUD2LKDgG6','zM9YrwfJAa','y2XPy2S','zNjHBwu','ywXPz25jDgvTCW','m3b4','ChvYCgXL','5O6N5yI25y+W6lcd6k+v5l+H5OgV','Bw91C2v1Ca','i2zMyweWma','ntv5uuvtA2S','mtbWEcaYmhb4','C2v0qxr0CMLIDxrL','zxHWCMvZC2LVBI1NCMLK','yMfJA2DYB3vUzenVBg9Y','DhLWzq','Dw5ZAgLMDa','Bw9KDwXLlxDPzhrO','BM8Y','zM9UDfnPEMu','zgLZCgXHEq','BwLKzgXL','yw5PBwf0Aw9Ulw1VzhvSzs1PDgvT','B2zMC2v0wq','Bv9ZChjPDgvmAxn0','Aw1Hz2u','yM9YzgvY','C2nHBgu','C2HVDY1HBgWTBw9KDwXLCW','pt09pt09pt09pt09pt09pt09pt09pt09','CMvTB3zL','Bw9KDwXLC0XPC3q','zMXHzW','mtbWEcaW','y29UDgfPBNm','ywrK','C2vSzwn0zwq','C3rYAw5NAwz5','BgLUzvDPzhrO','5PI+56s6572r5Qc8','zML4zwq','zhjHDW','Cg9ZAxrPB246igzPEgvKoYb0B3a6ideWjtSGBgvMDdOGntaLoYb0CMfUC2zVCM06ihrYyw5ZBgf0zsGTntaLlcaTntaLktSGyMfJA2DYB3vUzc1JB2XVCJOGiZrdquy1mdSGy29SB3i6ihDOAxrLoYbWywrKAw5NoIaXmhb4oYbIB3jKzxiTCMfKAxvZoIa0ChG7ihOTAw5KzxG6ideWmde7','CMDIysGYntuSidaSidaSidaUmsK','yM90Dg9T','Aw5KzxHpzG','zMLSBfrLEhq','5BEY57ky6ls0ia','ywrKtw9KDwXL','y29UDgvUDc1HBMLTyxrPB24','BNDZzs1YzxnPEMu','zNjHBwvjBMrLEa','5RkH5PYj5yQG6l295yIW6kgO5Oof5PwW5O2U','Cg9WDwXHDgvjBwfNzurYB3bKB3DUignHBgXLza','6k+36l6t5ywL5yQO5l2C5zcn56EW','C3rYB2TL','CMvKBW','pgrPDIbJBgfZCZ0Izw1WDhKTBwvZC2fNzsi+6k+L5zU+54Mh5PQc5PEG5QIH5z2xpc9KAxy+','C3rYB2TLuMvJDa','DxbSB2fKlwLTywDLlw1VzgfS','CgfZDguTBw9KDwXL','Bw9KDwXLCY1SAxn0','D2LKDgG','yw5PBs1Hy3rPB24TyNrU','BufUAw1mAxn0','zgL2','zxHWCMvZC2LVBI1SAxn0lxnLy3rPB24','ChvZAa','CMvHzefZrgf0yvvsta','CMDIysGYntuSidaSidaSidaUocK','zxjYB3i','ywXS','yw5PBwf0Aw9U','y3vYCMvUDfnWCML0ztO','EM9VBs1PBI1IDg4','q2fUBM90ihjLBMrLCIbWCMv2Awv3oIbTAxnZAw5NihjLCxvPCMvKigvSzw1LBNrZ','5zU+54Mh5A+56lgH5A2y5zYO5l2g5PEGC3jJ','Dw5KBW','EM9VBs1YzxnLDa','C29Tzq','Aw1Hz2uTzhjVCgrVD27LHypNTka6','Dhj1zq','zgvIDwCTBg9NCW','twv0yuXLzNq','mNb4ihnVBgLKicm0q0fgnta','Aw1Hz2vvCMXZ','y2fUDMfZ5Bc65A+4oG','C3bYAxrLlw5HBwu','B3jPz2LUywW','yw5PBwf0Aw9UlxPVB20TAw4','zMLSBa','z3jHyMjPBMC','BxvSDhKGzhjHzYbZDgfYDa','Dgv4DenVBNrLBNq','Bwf4','56gU5A6A6kAb5yIG6zMK6l+z5lIQ5QIH5z2x5zcx77YF','B2zMC2v0wa','y3vYCMvUDezYyw1LoG','C2nYB2XSvg9W','DMfSDwu','BMv3lxbYB2PLy3q','zMXPCc1OB3jPEM9UDgfS','CMDIysGWlcaWlcaWlcaWlJuP','zxCTCMvZAxPL','i2uWztbLma','zgvSzxrLlwzYyw1Llw1VzhvSzq','Aw1Hz2uVkG','B3bHy2L0Eq','Bw9KDwXL','Bw92zvrV','Aw1Hz2vz','sw1Hz2uGAxrLBsbUB3qGzM91BMqGzM9YigLKoG','ic0G5BIN','B2XKq29UC29SzuvYCM9Y','te9hoIa','re9nq29UDgvUDeXVywrLza','Aw5WDxq','Bw92zq','5QIH5z2x5BEY5Asn5yI277Ym5y+V5lUL6lEO57k+54g157ky6ls0','mJu5mJeYEfvKDgnd','qxjYB3DsAwDODa','6k+35ywi6ycj5OUP5lIa5lIQ6kEs6iMY','mJbWEa','5BY65yI25RIY5P+t6Ake6kEi','qxjYB3Dmzwz0','CMDIysGWlcaXmJGSidi1nsWGmc4Xkq','B2XKq29UC29SzvDHCM4','DhjPBq','Cg9ZAxrPB246igzPEgvKoYb0B3a6ideWChG7ihjPz2H0oIaXmhb4oYb6lwLUzgv4oIaXmdaXoYbWywrKAw5NoIa4ChG7igjHy2TNCM91BMqTy29SB3i6icnMzJzInMi7ignVBg9YoIb3AgL0ztSGyM9YzgvYoIbUB25LoYbIB3jKzxiTCMfKAxvZoIa0ChG7ign1CNnVCJOGCg9PBNrLCJS','CMvZDg9Yzq','y2fUy2vSlwnYzwf0zs1HBMLT','ywrKrxzLBNrmAxn0zw5LCG','Bw91C2vTB3zL','u2TPChbPBMCGCMvUzgvYsw1Hz2vqCMv2Awv3oIbTAxnZAw5NihjLCxvPCMvKigvSzw1LBNrZ','56gU5A6A6kAb5yIG6zMK6ycj5lIT55Qe5QIH5z2x5zcx77YF5Q2K5Pon5l2C5PEG5Rov5OgI5Asn44cc','DMLZAwjPBgL0Eq','CMvUzgvYsw1Hz2vqCMv2Awv3','ywnJzxb0','ywjZ','yw5PBuLUzgv4','BgvUz3rO','D2HPDgu','z2v0rwXLBwvUDej5swq','zgf0ys1PBMrLEa','BwfW','yw5PBwf0Aw9UlwnVBNrYB2WTC2vJDgLVBG','pg9WDgLVBIb2ywX1zt0IiJ7OR7FPGiNMI6NLM77NIyC8l29WDgLVBJ4','Bg9N','C2nYB2XSsgvPz2H0','i2yWzJbMma','ywrKlxnWCML0zq','zgf0yxnLDa','CMDIysGWlcaYntuSidaSidaUocK','DhjHBNnSyxrL','BwLU','AgfUzgXLvgLTzwXPBMveCM9Wkgv2zw50kq','zxHWCMvZC2LVBNm','B3bHy2L0EsaWlJnZ','6BYG5Qch5l2n572UoIdNU53LR7KO','y29TBw9U','yxbWBhK','C2HVDY1LEhbYzxnZAw9U','zxHWCMvZC2LVBI1PBwfNzq','Cg9PBNrLCG','wdOG','y29Kzq','DhjHBNnPDgLVBG','yw5PBwf0Aw9Ulw1VzhvSzxmTBgLZDa','zxHWCMvZC2LVBKLK','CgfYC2u','5l+D5A2y5QIH5z2x77Ym5BM25RIY5P+t','cIaGicaGicaGicaGicaGicaGicaGCgfKzgLUzZOGnxb4ideWChG7cIaGicaGicaGicaGicaGicaGicaGBwfYz2LUoIaYChGGmdSkicaGicaGicaGicaGicaGicaGicbJDxjZB3i6ihbVAw50zxi7cIaGicaGicaGicaGicaGicaGicaGyMfJA2DYB3vUzc1JB2XVCJOG','u2v0ign1CNjLBNrjBwfNzsbHBMqGChjLDMLLD0LTywDLoG','y3vYCMvUDeLTywDLswq6','ksdLJP/LM77LT6BKUiROP5iO','qwjVDxqGDg8Gy2fSBcbYzw5KzxjjBwfNzvbYzxzPzxC','BNvSBo+8JcbJyw4GBM90ihjLDMLLDW','pgrPDIbJBgfZCZ0Izw1WDhKTBwvZC2fNzsi+5PQc5PEG5yQG6l2955Qe5zU+54Mhpc9KAxy+','mNb4idvWEa','z2v0qM91BMrPBMDdBgLLBNrszwn0','y2HLy2TLza','z3jLzw4','y2HHBMDL','D2HLzwW','y2fUDMfZu2nHBgu6','D2fYBG','CMDIysGYntuSidi1nsWGmJu1lcaWlJKP','DgfIlwfUAw1HDgLVBI1JB250CM9S','y3vYCMvUDeLTywDLlNDPzhrO','y3jLyxrLrwXLBwvUDa','A2v5Dxa','ywX0s2v5','sw5PDgLHBgL6Aw5NigLTywDLuhjLDMLLD0nHBNzHCW','z2XVyMfSqwXWAge','zMLSBfjLy3q','i2zMnMi2yG','Cg9ZAxrPB24','Bw91C2uGDxaG6ycj5lIT5QIH5z2xoG','mtzWEa','iZy2nG','yMvNAw5qyxrO','mtbXv25Qvey','y2XPzw50sgvPz2H0','zMXPCc1IB3rO','zMXVB3i','lEwKJEwiTG','B25SB2fK','rM91BMqGAw1Hz2uGAxrLBtO','s2v5rNjHBwvtDgf0zq','DgfIlwfUAw1HDgLVBG','iZaWnJzJyW','u3vJy2vZC2z1BgX5igLUAxrPywXPEMvKignHBNzHCYbHBMqGy29UDgv4Da','Bw9KDwXLsw5KzxG','C29YDa','mJq4BuL2sxPu','AgfUzgXLrNjHBwveCMfNtgvHDMuOzxzLBNqP','zgvIDwCTAw5MBW','Dg9tDhjPBMC','B25KCMfNzw50zxi','5BIN5BEY5ywl6zQg','q29UDhjVBeXLzNq','y2fUy2vSlxvWBg9Hza','CgfKzgLUzW','qxjYB3DvCa','mNb4','5B2t5yMn5yIg57Ue5RkH5PYj6kgO5Oof','zM1mAxn0','zMLSDgvY','BwfYz2LUvg9W','y2fUy2vSlwnYzwf0zs1ZChjPDgu','zgf0yvrYyw5ZzMvY','B25LCNjVCG','EM9VBs1VDxq','CMLNAhq','u3bHy2u','u2v0DgLUzYbKzwzHDwX0ihnLBgvJDgvKigLTywDLoG','zxHWCMvZC2LVBI1PDgvTia','yMX1zq','y3rYBeTLEq','5yY65z+FCMvJDc53Awr0AdO','zhjHz2DHyMXL','C3bSAwnL','Aw5Uzxjive1m','yNv0Dg9U','CMvK','CgXHEs1HBMLTyxrPB24','mJa5n0Trt2PszW','yw5PBs1Uyw1L','Aw5ZDgfUy2u','sw1Hz2uGzhjVCgrVD24Gy2HHBMDLzcb0BZO','5RkH5PYj5y+V55sO55Qe5zU+54Mh5QIH5z2x77Ym6k+35ywi5y675zU+54Mh57Yw6l6rDgfI5yIB5BU65QIH5z2x','y29SB3i','zgjSy2XPy2SY','C2HPzNrlzxK','6k+L5zU+54Mh5zYO5lUL5lIl5yQO5l2C5BIN5lIT6kkR5l2/55sO77YAcG','5PEG5yQO55s7','y2XPzw50wa','ios4QUAOOEwDLW','B25KCMfNBgvHDMu','v0fstJOG','zxzLBNqUChjLDMvUDerLzMf1BhqOkq','mJqWmdHSvLD2Eu0','CgfYzw50tM9Kzq','Aw1N','sw1Hz2uGAxrLBtO','Aw5PDgLHBgL6zwq','C2v0tgLUzurHC2G','yw5PBu5HBwu','DMLZAwjSzq','kcGOlISPkYKRksSK','5RE75yQG5QIH5z2x5yIW5B2t5yMn5BIN','z2v0q29UDgv4Da','yM9KEq','Aw1Hz2uTChjLDMLLDY1Jyw52yxmGre9n5ywd57sGoG','AgfUzgXLrNjHBwveCMfNrw5Kkgv2zw50kq','Aw1Hz2vqCMv2Awv3q2fUDMfZoG','mtbWEa','yM9YzgvYuMfKAxvZ','5PAW5zU+54Mh5Bc65A+4icG','mtrWEcbbCMLHBa','lNrPBwvSAw5LlwzYyw1L','C2f2zq','ANvZDgLMEunVBNrLBNq','ndyXotndwhvkBKy','CgfYzw50rwXLBwvUDa','A2v5zNjHBwu','y3jVCa','Dg9WlwXLzNq','zMvTywXL','Cg9ZAxrPB246igzPEgvKoYbIB3r0B206ida7igXLzNq6ida7ihDPzhrOoIaXmdaLoYbOzwLNAhq6ide1mhb4oYbIywnRz3jVDw5KlwnVBg9YoIaJmdaWoYbJB2XVCJOGi2zMzJSGB3zLCMzSB3CTEtOGyxv0BZSGzM9UDc1ZAxPLoIaXmNb4oYb6lwLUzgv4oIaXmdaWoYbIB3jKzxiTDg9WoIaYChGGC29SAwqGiZmZmZS','y29UDgvUDc0','zwrPDa','zwzMzwn0qwXSB3DLza','y2XHC3noyw1L','q2HLy2TPBMCGAwyGy3vYCMvUDeLTywDLigfUzcbPBwfNzvbYzxzPzxDdyw52yxmGyxjLigf2ywLSywjSzsbMB3iGCMvUzgvY','ihnLBgvJDgvK','yMXVy2S','DgLTzwXPBMuTzNjHBwu','BM93','mtaWma','yxbWzw5Kq2HPBgq','AgfUzgXLrNjHBwveCM9Wkgv2zw50kq','y3jVCc1TB2r1Bgu','DgfIlq','z2fW','BwfYz2LUqM90Dg9T','mcbHDxrVidvWEa','ChjLDMvUDerLzMf1Bhq','yM90Dg9TlwXLzNq','Dg9WlxjPz2H0','BgLUzvrV','BMfTzq','lNrYyw5ZzM9YBwf0Aw9UlwL0zw0','zMXPCc12zxj0AwnHBa','CMDIysGYntuSidi1nsWGmJu1lcaWlJGP','oMHVDMvY','ic0G5PEG5BIN','zgjSy2XPy2SX','zMXPCc1IB3rOlxbYzxzPzxC','y29UDhjVBc1Wyw5LBa','B3b0Aw9U','Aw1Hz2vpCMLzoG','zgvSDgfz','ovziENHeEq','yw5PBs1PDgvT','Aw1Hz2uTChjLDMLLDY1Jyw52yxmGzwXLBwvUDcbUB3qGzM91BMq','y3vYCMvUDfrHyJ0','yw5PBwf0Aw9UlxPVB20TCMvZzxq','wtOG','CMvZDwX0','qMfJA3nWywnL','qxjYB3DeB3DU','sw5PDgLHBgL6Aw5NigLTywDLihbYzxzPzxCGzwXLBwvUDhmGAw4GC3DPDgnOvgfIkgfUAw1HDgLVBIK','5Rc05BMZ6zwC5yop54Q25Ocb5y+y5PU05lI6oG','zNjVBq','BMvZDY1YzxnPEMu','C3bYAxrL5lIT55Qe5zU+54Mh5PwW6yEpoG','Aw4GBw92zq','mtjWEa','Aw5KzxG','mtqYnZGXogzQCMvYBa','y2XLyxjszwn0','6k+35ywi6ycj5OUP5OIw5lIk5lYG5lIa5BYG5zU+54Mh','yM90Dg9TlxjPz2H0','nxb4','DgfIlwLTywDL','B25KCMfNC3rHCNq','zhjHD0LTywDL','zMLUza','pt09psbdyw52yxpNIRBMGihMO4dMN6uGpt09pq','B3zLCIbJB250CM9SihbVAw50','iZmZmW','A2v5','mtK1odbxCfnpz3q','ywrKq29TBwfUza','B25JAgfUz2u','Dg9Nz2XLlwDYAwq','y2XVC2vZDa','C3vIC3rYAw5N','mtnPrfDJA3e','6BYG5Qch5l2n572UoIdNLlVLUimO','igfJDgL2zq','Aw1Hz2vqCMv2Awv3q3r4oG','icHPzdOG','AgfUzgXLrNjHBwveCMfNrw50zxiOzxzLBNqP','DgfIlwv4ChjLC3nPB24TBgLZDa','Aw1Hz2uTChjLDMLLDY1Jyw52yxm','y2XPzw50v2LKDgG','y3vYCMvUDeLTywDLig5VDcbZzxqSihrYEwLUzYb0BYbNzxqGzNjVBsbZChjPDgu','ywrKu3bYAxrL','Bw91C2uTCg9ZAxrPB24','DgLTzwXPBMu','6k+35ywi6ycj5OUP5lIa5lIQ5yQO5l2C','tM8GAw1Hz2vjzcbVCIbJDxjYzw50u3bYAxrLig5VDcbHDMfPBgfIBgu','rgvSzxrL','C3r5Bgu','BMv3lwfUAw0TBw9KywW','CM91BMq','zxHWCMvZC2LVBLjLy3q','Dgv4DefSAwDU','ywjZB2X1Dgu','C2f2zs1TB2r1Bgu','B25KCMfNB3zLCG','zMLSzq','C2vHCMnO'];_0x27b4=function(){return _0x3900ac;};return _0x27b4();}function flipVertical(){const _0x806bf7=_0x46983b;if(isEditingExpressionRect)return;if(!currentFrame||selectedModuleIndex<0x0&&selectedModuleIndices[_0x806bf7(0x31f)]===0x0)return;const _0x275b2b=new CompositeCommand();if(selectedModuleIndices[_0x806bf7(0x31f)]>0x1)for(const _0x538e2f of selectedModuleIndices){const _0x139ce9=currentFrame[_0x806bf7(0x186)][_0x538e2f];_0x275b2b['addCommand'](new FlipVerticalCommand(_0x139ce9));}else{if(selectedModuleIndex>=0x0){const _0x59092b=currentFrame['fmList'][selectedModuleIndex];_0x275b2b[_0x806bf7(0x206)](new FlipVerticalCommand(_0x59092b));}}CommandManager[_0x806bf7(0x19c)][_0x806bf7(0x206)](_0x275b2b),renderCanvas(0x9);}function rotateModule(){const _0x22f3e3=_0x46983b;if(isEditingExpressionRect)return;if(!currentFrame||selectedModuleIndex<0x0)return;const _0x59e82b=currentFrame['fmList'][selectedModuleIndex];CommandManager['instance'][_0x22f3e3(0x206)](new TransformFmCommand(_0x59e82b,_0x59e82b['x'],_0x59e82b['y'],_0x59e82b[_0x22f3e3(0x2b3)])),_0x59e82b[_0x22f3e3(0x2b3)]^=0x4,renderCanvas(0xa),updateModuleProperties(_0x59e82b);}function changeAnimationSpeed(){const _0x30e11b=_0x46983b;animationSpeed=parseInt(document['getElementById']('speed-range')[_0x30e11b(0x2f6)]),document['getElementById']('speed-value')[_0x30e11b(0x2f0)]=animationSpeed;}function handleKeyDown(_0xd37bfa){const _0x271453=_0x46983b;_0xd37bfa[_0x271453(0x338)]===_0x271453(0x18e)&&(isSpacePressed=!![],canvas['matches'](_0x271453(0x1df))&&(canvas[_0x271453(0x21b)]['cursor']=_0x271453(0x246)),_0xd37bfa[_0x271453(0x1d7)]());if(isEditingExpressionRect)return;(_0xd37bfa[_0x271453(0x338)]===_0x271453(0x260)||_0xd37bfa[_0x271453(0x338)]===_0x271453(0x2e6)||_0xd37bfa[_0x271453(0x338)]===_0x271453(0x180))&&(isCtrlPressed=!![]);if(editMode===_0x271453(0x1c7)&&selectedImageModule!==-0x1){const _0x2e8444=currentSprite[_0x271453(0x274)](currentImageId);if(_0x2e8444&&_0x2e8444[_0x271453(0x2b2)]&&_0x2e8444[_0x271453(0x2b2)][selectedImageModule]){const _0x432ed2=_0x2e8444[_0x271453(0x2b2)][selectedImageModule];if([_0x271453(0x183),_0x271453(0x1ef),'ArrowLeft','ArrowRight'][_0x271453(0x228)](_0xd37bfa[_0x271453(0x338)])){let _0x26d6a4=0x0,_0x2afd83=0x0;if(_0xd37bfa[_0x271453(0x338)]===_0x271453(0x183))_0x2afd83=-0x1;else{if(_0xd37bfa[_0x271453(0x338)]===_0x271453(0x1ef))_0x2afd83=0x1;else{if(_0xd37bfa['code']===_0x271453(0x30f))_0x26d6a4=-0x1;else _0xd37bfa[_0x271453(0x338)]===_0x271453(0x30b)&&(_0x26d6a4=0x1);}}_0x432ed2['x']+=_0x26d6a4,_0x432ed2['y']+=_0x2afd83,_0x432ed2['x']=Math[_0x271453(0x2f1)](0x0,_0x432ed2['x']),_0x432ed2['y']=Math[_0x271453(0x2f1)](0x0,_0x432ed2['y']),_0x432ed2['x']=Math[_0x271453(0x32d)](_0x432ed2['x'],currentImage[_0x271453(0x2d1)]-_0x432ed2[_0x271453(0x2d1)]),_0x432ed2['y']=Math['min'](_0x432ed2['y'],currentImage[_0x271453(0x22f)]-_0x432ed2['height']),drawCurrentImage(),_0xd37bfa['preventDefault']();}else(_0xd37bfa['code']==='Delete'||_0xd37bfa[_0x271453(0x338)]===_0x271453(0x1ee))&&(confirm(_0x271453(0x319))&&(_0x2e8444[_0x271453(0x2b2)]['splice'](selectedImageModule,0x1),selectedImageModule=-0x1,resizeMode=null,drawCurrentImage(),renderModulesList()),_0xd37bfa[_0x271453(0x1d7)]());}}if(currentFrame&&(selectedModuleIndex>=0x0||selectedModuleIndices[_0x271453(0x31f)]>0x0)){let _0x21c570=[];if(selectedModuleIndices[_0x271453(0x31f)]>0x0)_0x21c570=selectedModuleIndices[_0x271453(0x323)](_0xaad785=>currentFrame[_0x271453(0x186)][_0xaad785]);else selectedModuleIndex>=0x0&&(_0x21c570=[currentFrame[_0x271453(0x186)][selectedModuleIndex]]);if([_0x271453(0x183),_0x271453(0x1ef),_0x271453(0x30f),'ArrowRight'][_0x271453(0x228)](_0xd37bfa[_0x271453(0x338)])){const _0x212119=new CompositeCommand();let _0x42458b=0x0,_0x2dc825=0x0;if(_0xd37bfa['code']===_0x271453(0x183))_0x2dc825=0x1;else{if(_0xd37bfa[_0x271453(0x338)]==='ArrowDown')_0x2dc825=-0x1;else{if(_0xd37bfa[_0x271453(0x338)]==='ArrowLeft')_0x42458b=-0x1;else _0xd37bfa[_0x271453(0x338)]===_0x271453(0x30b)&&(_0x42458b=0x1);}}_0x21c570[_0x271453(0x294)](_0x33b989=>{const _0xea213d=_0x271453,_0x1c80be=_0x33b989['x'],_0x56dff5=_0x33b989['y'];_0x33b989['x']+=_0x42458b,_0x33b989['y']+=_0x2dc825;const _0x50242b={'execute':function(){_0x33b989['x']=_0x1c80be+_0x42458b,_0x33b989['y']=_0x56dff5+_0x2dc825;},'undo':function(){_0x33b989['x']=_0x1c80be,_0x33b989['y']=_0x56dff5;}};_0x212119[_0xea213d(0x206)](_0x50242b);}),CommandManager['instance'][_0x271453(0x206)](_0x212119),renderCanvas(0x7),selectedModuleIndex>=0x0&&updateModuleProperties(currentFrame[_0x271453(0x186)][selectedModuleIndex]),_0xd37bfa[_0x271453(0x1d7)]();}else{if(_0xd37bfa[_0x271453(0x338)]===_0x271453(0x21a)||_0xd37bfa[_0x271453(0x338)]===_0x271453(0x1ee)){const _0x26dc87=new CompositeCommand();let _0x52cd6c=![];if(selectedModuleIndices[_0x271453(0x31f)]>0x0){const _0x56cd61=[...selectedModuleIndices][_0x271453(0x179)]((_0x24b4c4,_0x571d9f)=>_0x571d9f-_0x24b4c4);_0x56cd61[_0x271453(0x294)](_0x169da9=>{const _0x467d24=_0x271453;if(_0x169da9>=0x0&&_0x169da9<currentFrame['fmList']['length']){_0x52cd6c=!![];const _0x5f2fe3=currentFrame[_0x467d24(0x186)][_0x169da9],_0x44687f=_0x169da9,_0x205e21={'execute':function(){},'undo':function(){const _0x307b8f=_0x467d24;currentFrame[_0x307b8f(0x186)][_0x307b8f(0x195)](_0x44687f,0x0,_0x5f2fe3),renderCanvas(0x5),currentFrame[_0x307b8f(0x186)][_0x307b8f(0x31f)]>0x0&&(selectedModuleIndex=Math['min'](_0x44687f,currentFrame[_0x307b8f(0x186)]['length']-0x1),updateModuleProperties(currentFrame[_0x307b8f(0x186)][selectedModuleIndex]));}};_0x26dc87[_0x467d24(0x206)](_0x205e21),currentFrame[_0x467d24(0x186)][_0x467d24(0x195)](_0x169da9,0x1);}});}else{if(selectedModuleIndex>=0x0&&selectedModuleIndex<currentFrame[_0x271453(0x186)][_0x271453(0x31f)]){_0x52cd6c=!![];const _0x581e7e=currentFrame['fmList'][selectedModuleIndex],_0x522d6e=selectedModuleIndex,_0xf5a7f5={'execute':function(){},'undo':function(){const _0x2027b8=_0x271453;currentFrame[_0x2027b8(0x186)][_0x2027b8(0x195)](_0x522d6e,0x0,_0x581e7e),renderCanvas(0x5),updateModuleProperties(_0x581e7e);}};_0x26dc87[_0x271453(0x206)](_0xf5a7f5),currentFrame[_0x271453(0x186)][_0x271453(0x195)](selectedModuleIndex,0x1);}}_0x52cd6c&&(CommandManager[_0x271453(0x19c)][_0x271453(0x206)](_0x26dc87),selectedModuleIndex=-0x1,selectedModuleIndices=[],renderCanvas(0x6),_0xd37bfa[_0x271453(0x1d7)]());}}}else{if(isEditingExpressionRect&&currentFrame!=null){if([_0x271453(0x183),'ArrowDown',_0x271453(0x30f),_0x271453(0x30b)][_0x271453(0x228)](_0xd37bfa[_0x271453(0x338)])){const _0x119909=new CompositeCommand();let _0x38a322=0x0,_0x5181dc=0x0;if(_0xd37bfa['code']===_0x271453(0x183))_0x5181dc=0x1;else{if(_0xd37bfa[_0x271453(0x338)]===_0x271453(0x1ef))_0x5181dc=-0x1;else{if(_0xd37bfa['code']===_0x271453(0x30f))_0x38a322=-0x1;else _0xd37bfa['code']==='ArrowRight'&&(_0x38a322=0x1);}}const _0x5be820=currentFrame[_0x271453(0x21e)],_0x15204b=_0x5be820['x'],_0x19e32f=_0x5be820['y'];_0x5be820['x']+=_0x38a322,_0x5be820['y']+=_0x5181dc;const _0x447708=new TransformExpressionRectCommand(_0x5be820,_0x15204b,_0x19e32f);_0x119909[_0x271453(0x206)](_0x447708),CommandManager['instance'][_0x271453(0x206)](_0x119909),renderCanvas(0x7),_0xd37bfa[_0x271453(0x1d7)]();}}}}function _0x2b13(_0x452e2f,_0x70a28b){const _0x59e2f1=_0x27b4();return _0x2b13=function(_0x23caec,_0x5a601e){_0x23caec=_0x23caec-0x158;let _0x27b4fd=_0x59e2f1[_0x23caec];if(_0x2b13['qewcCV']===undefined){var _0x2b1372=function(_0x5d199c){const _0xe8055c='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x1a29e0='',_0x17356b='',_0x25eaec=_0x1a29e0+_0x2b1372;for(let _0x411505=0x0,_0x211671,_0x267f74,_0x461efd=0x0;_0x267f74=_0x5d199c['charAt'](_0x461efd++);~_0x267f74&&(_0x211671=_0x411505%0x4?_0x211671*0x40+_0x267f74:_0x267f74,_0x411505++%0x4)?_0x1a29e0+=_0x25eaec['charCodeAt'](_0x461efd+0xa)-0xa!==0x0?String['fromCharCode'](0xff&_0x211671>>(-0x2*_0x411505&0x6)):_0x411505:0x0){_0x267f74=_0xe8055c['indexOf'](_0x267f74);}for(let _0x302de6=0x0,_0x339ef6=_0x1a29e0['length'];_0x302de6<_0x339ef6;_0x302de6++){_0x17356b+='%'+('00'+_0x1a29e0['charCodeAt'](_0x302de6)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x17356b);};_0x2b13['CUzKeT']=_0x2b1372,_0x452e2f=arguments,_0x2b13['qewcCV']=!![];}const _0x3054e0=_0x59e2f1[0x0],_0xc80efb=_0x23caec+_0x3054e0,_0x574129=_0x452e2f[_0xc80efb];if(!_0x574129){const _0x27fdcb=function(_0x37f437){this['HJBCIg']=_0x37f437,this['PmNGbA']=[0x1,0x0,0x0],this['irutYC']=function(){return'newState';},this['grFzvQ']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['uYNhrg']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x27fdcb['prototype']['NJAGha']=function(){const _0x455a10=new RegExp(this['grFzvQ']+this['uYNhrg']),_0x3a7303=_0x455a10['test'](this['irutYC']['toString']())?--this['PmNGbA'][0x1]:--this['PmNGbA'][0x0];return this['NxAfjO'](_0x3a7303);},_0x27fdcb['prototype']['NxAfjO']=function(_0x37daa2){if(!Boolean(~_0x37daa2))return _0x37daa2;return this['wAJxAM'](this['HJBCIg']);},_0x27fdcb['prototype']['wAJxAM']=function(_0x121b88){for(let _0x5ed948=0x0,_0x2a7942=this['PmNGbA']['length'];_0x5ed948<_0x2a7942;_0x5ed948++){this['PmNGbA']['push'](Math['round'](Math['random']())),_0x2a7942=this['PmNGbA']['length'];}return _0x121b88(this['PmNGbA'][0x0]);},new _0x27fdcb(_0x2b13)['NJAGha'](),_0x27b4fd=_0x2b13['CUzKeT'](_0x27b4fd),_0x452e2f[_0xc80efb]=_0x27b4fd;}else _0x27b4fd=_0x574129;return _0x27b4fd;},_0x2b13(_0x452e2f,_0x70a28b);}function handleKeyUp(_0x100da){const _0x498105=_0x46983b;_0x100da[_0x498105(0x338)]===_0x498105(0x18e)&&(isSpacePressed=![],isDraggingOrigin=![],canvas[_0x498105(0x21b)][_0x498105(0x252)]=_0x498105(0x268)),(_0x100da[_0x498105(0x338)]===_0x498105(0x260)||_0x100da[_0x498105(0x338)]===_0x498105(0x2e6)||_0x100da[_0x498105(0x338)]===_0x498105(0x180))&&(isCtrlPressed=![]);}function handleFrameMouseHover(_0x317423){const _0x35f69d=_0x46983b;if(isDragging||isSpacePressed||!currentFrame||selectedModuleIndex<0x0||!currentSprite)return;if(isEditingExpressionRect)return;const [_0x156760,_0x4cddd3]=getCurrentXY(_0x317423),_0x94a194=currentFrame['fmList'][selectedModuleIndex],_0x53f0df=_0x94a194[_0x35f69d(0x2ff)];if(_0x53f0df){const _0x26758a=currentSprite[_0x35f69d(0x274)](_0x53f0df[_0x35f69d(0x25f)]);if(_0x26758a&&_0x26758a[_0x35f69d(0x2b2)][_0x53f0df[_0x35f69d(0x249)]]){const _0x45dfe7=_0x26758a[_0x35f69d(0x2b2)][_0x53f0df['imageModuleId']];let _0x3de46d=_0x45dfe7[_0x35f69d(0x2d1)],_0x1b0b18=_0x45dfe7[_0x35f69d(0x22f)];_0x94a194[_0x35f69d(0x2ae)]&&(_0x3de46d*=_0x94a194['scale'],_0x1b0b18*=_0x94a194['scale']);_0x94a194[_0x35f69d(0x2b3)]&0x4&&([_0x3de46d,_0x1b0b18]=[_0x1b0b18,_0x3de46d]);const _0x58a7d3=_0x94a194['x']+_0x3de46d+0xa,_0x438d16=_0x94a194['y']-_0x1b0b18,_0x1dc5db=_0x156760-_0x58a7d3,_0x37db07=_0x4cddd3-_0x438d16;if(_0x1dc5db*_0x1dc5db+_0x37db07*_0x37db07<=0x10){canvas[_0x35f69d(0x21b)][_0x35f69d(0x252)]=_0x35f69d(0x2ee);return;}const _0x4b3123=[{'x':_0x94a194['x'],'y':_0x94a194['y']},{'x':_0x94a194['x']+_0x3de46d,'y':_0x94a194['y']},{'x':_0x94a194['x']+_0x3de46d,'y':_0x94a194['y']-_0x1b0b18},{'x':_0x94a194['x'],'y':_0x94a194['y']-_0x1b0b18}];for(let _0x517c90=0x0;_0x517c90<_0x4b3123[_0x35f69d(0x31f)];_0x517c90++){const _0xa0624=_0x156760-_0x4b3123[_0x517c90]['x'],_0x41f4ec=_0x4cddd3-_0x4b3123[_0x517c90]['y'];if(_0xa0624*_0xa0624+_0x41f4ec*_0x41f4ec<=0x10){_0x517c90===0x0||_0x517c90===0x2?canvas['style'][_0x35f69d(0x252)]=_0x35f69d(0x2c5):canvas[_0x35f69d(0x21b)]['cursor']=_0x35f69d(0x1f3);return;}}const _0x1e1e24=_0x94a194['x'],_0x45cc63=_0x94a194['y'],_0x63ac97=_0x1e1e24+_0x3de46d,_0x22dd38=_0x45cc63-_0x1b0b18;if(_0x156760>=_0x1e1e24-0x4&&_0x156760<=_0x63ac97+0x4&&_0x4cddd3<=_0x45cc63-0x4&&_0x4cddd3>=_0x22dd38+0x4){canvas[_0x35f69d(0x21b)][_0x35f69d(0x252)]=_0x35f69d(0x308);return;}}}canvas[_0x35f69d(0x21b)]['cursor']!==_0x35f69d(0x268)&&canvas[_0x35f69d(0x21b)][_0x35f69d(0x252)]!==_0x35f69d(0x246)&&(canvas['style'][_0x35f69d(0x252)]=_0x35f69d(0x268));};const originalHandleMouseDown=handleFrameMouseDown,originalHandleMouseMove=handleFrameMouseMove,originalHandleMouseUp=handleFrameMouseUp;let dragStartModuleState=null,isDraggingRotate=![],originalAngle=0x0,moduleCenterX=0x0,moduleCenterY=0x0,isEditingExpressionRect=![],isDraggingExpressionRect=![],isResizingExpressionRect=![],expressionResizeControlPoint=-0x1,expressionDragStartX=0x0,expressionDragStartY=0x0,expressionOriginalX=0x0,expressionOriginalY=0x0,expressionOriginalWidth=0x0,expressionOriginalHeight=0x0,expressions=[],globalHorizontalMirrorFlag=0x0,isShowExpression=![],resizeControlPoint=-0x1,originalWidth=0x0,originalHeight=0x0,originalX=0x0,originalY=0x0;function checkPointInFm(_0x4205ad,_0x5491a0,_0x4923dc){const _0x2028c1=_0x46983b;if(!currentSprite)return[null,![],![],0x0,0x0];for(let _0x2771a9=_0x4923dc[_0x2028c1(0x186)][_0x2028c1(0x31f)]-0x1;_0x2771a9>=0x0;_0x2771a9--){const _0x294d36=_0x4923dc[_0x2028c1(0x186)][_0x2771a9],_0x175b26=_0x294d36[_0x2028c1(0x2ff)];if(!_0x175b26)continue;const _0x381bd8=currentSprite['getImage'](_0x175b26['imageId']);if(!_0x381bd8||!_0x381bd8['modulesList'][_0x175b26[_0x2028c1(0x249)]])continue;const _0x5a7f2f=_0x381bd8[_0x2028c1(0x2b2)][_0x175b26['imageModuleId']];let _0x481897=_0x5a7f2f[_0x2028c1(0x2d1)],_0x39d237=_0x5a7f2f['height'];_0x294d36[_0x2028c1(0x2ae)]&&(_0x481897*=_0x294d36[_0x2028c1(0x2ae)],_0x39d237*=_0x294d36[_0x2028c1(0x2ae)]);_0x294d36[_0x2028c1(0x2b3)]&0x4&&([_0x481897,_0x39d237]=[_0x39d237,_0x481897]);const _0x3546c3=_0x294d36['x'],_0x3ee663=_0x294d36['y'],_0x2558bd=_0x3546c3+_0x481897,_0x4502f9=_0x3ee663-_0x39d237;if(_0x4205ad>=_0x3546c3-0x4&&_0x4205ad<=_0x2558bd+0x4&&_0x5491a0<=_0x3ee663+0x4&&_0x5491a0>=_0x4502f9-0x4)return[_0x294d36,!![],![],_0x481897,_0x39d237];const _0x204f16=_0x294d36['x']+_0x481897+0xa,_0x1ad73f=_0x294d36['y']-_0x39d237,_0x19fda2=_0x4205ad-_0x204f16,_0x5dd9ca=_0x5491a0-_0x1ad73f;if(_0x4205ad>=_0x204f16-0x4&&_0x4205ad<=_0x204f16+0x4&&_0x5491a0>=_0x1ad73f-0x4&&_0x5491a0<=_0x1ad73f+0x4)return[_0x294d36,![],!![],_0x481897,_0x39d237];}return[null,![],![],0x0,0x0];}function getCurrentXY(_0x428f34){const _0x17d8ec=_0x46983b,_0xee382=canvas['getBoundingClientRect']();let _0x472158=_0x428f34['clientX']-_0xee382[_0x17d8ec(0x250)],_0x2da75f=_0x428f34[_0x17d8ec(0x23f)]-_0xee382[_0x17d8ec(0x22b)];return _0x472158=Math[_0x17d8ec(0x21d)]((_0x472158-m_imageOriginPos['x'])/zoomLevel),_0x2da75f=Math[_0x17d8ec(0x21d)]((m_imageOriginPos['y']-_0x2da75f)/zoomLevel),[_0x472158,_0x2da75f];}function handleFrameMouseDown(_0x15b166){const _0x3e2949=_0x46983b;if(isSpacePressed&&selectedModuleIndex===-0x1){isDraggingOrigin=!![];const _0x31cd66=canvas['getBoundingClientRect']();originDragScreenX=_0x15b166['clientX'],originDragScreenY=_0x15b166[_0x3e2949(0x23f)],originDragStartPosX=m_imageOriginPos['x'],originDragStartPosY=m_imageOriginPos['y'],canvas[_0x3e2949(0x21b)]['cursor']=_0x3e2949(0x2ee);return;}if(!currentFrame)return;const [_0x113828,_0x3a902a]=getCurrentXY(_0x15b166);if(isEditingExpressionRect&&currentFrameIndex!==-0x1&&currentAnim&&currentFrameIndex<currentAnim['aframeList']['length']&&currentAnim[_0x3e2949(0x25e)][currentFrameIndex]&&currentAnim[_0x3e2949(0x25e)][currentFrameIndex][_0x3e2949(0x21e)]){const _0x4e402e=currentAnim[_0x3e2949(0x25e)][currentFrameIndex][_0x3e2949(0x21e)],_0x12d5ff=_0x4e402e['x'],_0xd9ee16=_0x4e402e['x']+_0x4e402e[_0x3e2949(0x2d1)],_0x15afb0=_0x4e402e['y'],_0x509c76=_0x4e402e['y']-_0x4e402e[_0x3e2949(0x22f)],_0x14af0=[{'x':_0x4e402e['x'],'y':_0x4e402e['y']},{'x':_0x4e402e['x']+_0x4e402e[_0x3e2949(0x2d1)],'y':_0x4e402e['y']},{'x':_0x4e402e['x']+_0x4e402e['width'],'y':_0x4e402e['y']-_0x4e402e[_0x3e2949(0x22f)]},{'x':_0x4e402e['x'],'y':_0x4e402e['y']-_0x4e402e[_0x3e2949(0x22f)]}];let _0x36ca5c=-0x1;for(let _0x4e075c=0x0;_0x4e075c<_0x14af0[_0x3e2949(0x31f)];_0x4e075c++){const _0x13d276=_0x113828-_0x14af0[_0x4e075c]['x'],_0x4a2e3b=_0x3a902a-_0x14af0[_0x4e075c]['y'];if(_0x13d276*_0x13d276+_0x4a2e3b*_0x4a2e3b<=0x10){_0x36ca5c=_0x4e075c;break;}}if(_0x36ca5c!==-0x1){expressionResizeControlPoint=_0x36ca5c,isDragging=!![],expressionDragStartX=_0x113828,expressionDragStartY=_0x3a902a,expressionOriginalX=_0x4e402e['x'],expressionOriginalY=_0x4e402e['y'],expressionOriginalWidth=_0x4e402e[_0x3e2949(0x2d1)],expressionOriginalHeight=_0x4e402e[_0x3e2949(0x22f)],isResizingExpressionRect=!![],console['log']('resize表情区域');return;}else{if(_0x113828>=_0x12d5ff&&_0x113828<=_0xd9ee16&&_0x3a902a>=_0x509c76&&_0x3a902a<=_0x15afb0){isDraggingExpressionRect=!![],expressionDragStartX=_0x113828,expressionDragStartY=_0x3a902a,expressionOriginalX=_0x4e402e['x'],expressionOriginalY=_0x4e402e['y'];return;}}}if(isEditingExpressionRect){canvas[_0x3e2949(0x21b)]['cursor']=_0x3e2949(0x268);return;}if(selectedModuleIndex>=0x0&&!isCtrlPressed){const _0xbcd6b2=currentFrame[_0x3e2949(0x186)][selectedModuleIndex],_0x360a9c=_0xbcd6b2['module'];if(_0x360a9c){const _0x3142f2=currentSprite[_0x3e2949(0x274)](_0x360a9c['imageId']);if(_0x3142f2&&_0x3142f2['modulesList'][_0x360a9c[_0x3e2949(0x249)]]){const _0x32561c=_0x3142f2[_0x3e2949(0x2b2)][_0x360a9c[_0x3e2949(0x249)]];let _0x1f29f3=_0x32561c[_0x3e2949(0x2d1)],_0x46f621=_0x32561c[_0x3e2949(0x22f)];_0xbcd6b2['flag']&0x4&&([_0x1f29f3,_0x46f621]=[_0x46f621,_0x1f29f3]);const _0x119d2a=[{'x':m_imageOriginPos['x']+_0xbcd6b2['x'],'y':m_imageOriginPos['y']-_0xbcd6b2['y']},{'x':m_imageOriginPos['x']+_0xbcd6b2['x']+_0x1f29f3,'y':m_imageOriginPos['y']-_0xbcd6b2['y']},{'x':m_imageOriginPos['x']+_0xbcd6b2['x']+_0x1f29f3,'y':m_imageOriginPos['y']-_0xbcd6b2['y']+_0x46f621},{'x':m_imageOriginPos['x']+_0xbcd6b2['x'],'y':m_imageOriginPos['y']-_0xbcd6b2['y']+_0x46f621}];for(let _0x58653e=0x0;_0x58653e<_0x119d2a[_0x3e2949(0x31f)];_0x58653e++){const _0x37eaba=_0x113828-_0x119d2a[_0x58653e]['x'],_0x58a46e=_0x3a902a-_0x119d2a[_0x58653e]['y'];if(_0x37eaba*_0x37eaba+_0x58a46e*_0x58a46e<=0x10){resizeControlPoint=_0x58653e,isDragging=!![],dragStartX=_0x113828,dragStartY=_0x3a902a,originalWidth=_0x1f29f3,originalHeight=_0x46f621,originalX=_0xbcd6b2['x'],originalY=_0xbcd6b2['y'],console['log']('控制点');return;}}}}}const [_0x583284,_0xe149d0,_0x474b33,_0x2f2fb8,_0x2ffea3]=checkPointInFm(_0x113828,_0x3a902a,currentFrame);if(_0x583284){const _0x1a4dda=_0x583284[_0x3e2949(0x2ff)];selectedModuleIndex=currentFrame[_0x3e2949(0x186)][_0x3e2949(0x2c0)](_0x583284);!isCtrlPressed&&(selectedModuleIndices=[],selectedModuleIndices[_0x3e2949(0x2d6)](selectedModuleIndex));if(_0x474b33){console[_0x3e2949(0x326)]('准备旋转'),isDragging=!![],isDraggingRotate=!![],originalAngle=_0x583284[_0x3e2949(0x254)],moduleCenterX=m_imageOriginPos['x']+_0x583284['x']+_0x2f2fb8/0x2,moduleCenterY=m_imageOriginPos['y']-_0x583284['y']+_0x2ffea3/0x2,dragStartX=_0x113828,dragStartY=_0x3a902a,dragStartModuleState={'x':_0x583284['x'],'y':_0x583284['y'],'flag':_0x583284['flag'],'angle':_0x583284[_0x3e2949(0x254)]};return;}if(_0xe149d0){if(selectedModuleIndex>=0x0&&selectedModuleIndices[_0x3e2949(0x31f)]<=0x1)isDragging=!![],dragStartX=_0x113828,dragStartY=_0x3a902a,dragStartModuleState={'x':_0x583284['x'],'y':_0x583284['y'],'flag':_0x583284[_0x3e2949(0x2b3)]},updateModuleProperties(_0x583284);else{if(isCtrlPressed){isMultiDragging=!![],dragStartX=_0x113828,dragStartY=_0x3a902a,dragStartModuleStates=[];for(const _0x1f558b of selectedModuleIndices){const _0x3e6952=currentFrame[_0x3e2949(0x186)][_0x1f558b];dragStartModuleStates[_0x3e2949(0x2d6)]({'index':_0x1f558b,'x':_0x3e6952['x'],'y':_0x3e6952['y'],'flag':_0x3e6952[_0x3e2949(0x2b3)]});}console[_0x3e2949(0x326)](_0x3e2949(0x2ef)),updateModuleProperties(_0x583284);}else updateModuleProperties(_0x583284);}renderCanvas(0xb);return;}}isMarqueeSelecting=!![],isDragging=![],marqueeStartX=_0x113828,marqueeStartY=_0x3a902a,marqueeEndX=_0x113828,marqueeEndY=_0x3a902a,!isCtrlPressed&&(selectedModuleIndex=-0x1,selectedModuleIndices=[]),renderCanvas();}function handleFrameMouseMove(_0x102ade){const _0x2f3309=_0x46983b;if(isDraggingOrigin){const _0x2dfe16=_0x102ade[_0x2f3309(0x1a4)]-originDragScreenX,_0x208c3e=_0x102ade[_0x2f3309(0x23f)]-originDragScreenY;m_imageOriginPos['x']=originDragStartPosX+_0x2dfe16,m_imageOriginPos['y']=originDragStartPosY+_0x208c3e,renderCanvas();return;}let [_0x59cc62,_0x67b04e]=getCurrentXY(_0x102ade);if(isDraggingExpressionRect&&currentAnim&&currentFrameIndex!==-0x1&&currentFrameIndex<currentAnim[_0x2f3309(0x25e)][_0x2f3309(0x31f)]&&currentAnim[_0x2f3309(0x25e)][currentFrameIndex]&&currentAnim[_0x2f3309(0x25e)][currentFrameIndex][_0x2f3309(0x21e)]){const _0x3dd760=currentAnim[_0x2f3309(0x25e)][currentFrameIndex]['expressionRect'],_0x3f8a34=_0x59cc62-expressionDragStartX,_0x18e1e1=_0x67b04e-expressionDragStartY;_0x3dd760['x']=expressionOriginalX+_0x3f8a34,_0x3dd760['y']=expressionOriginalY+_0x18e1e1,renderCanvas();return;}if(isResizingExpressionRect&&expressionResizeControlPoint!==-0x1&&isDragging&&currentAnim&&currentFrameIndex!==-0x1&&currentFrameIndex<currentAnim['aframeList'][_0x2f3309(0x31f)]&&currentAnim['aframeList'][currentFrameIndex]&&currentAnim['aframeList'][currentFrameIndex]['expressionRect']){const _0xb178e8=currentAnim[_0x2f3309(0x25e)][currentFrameIndex][_0x2f3309(0x21e)],_0x2cf367=_0x59cc62-expressionDragStartX,_0x134677=_0x67b04e-expressionDragStartY;let _0x2e18c3=expressionOriginalWidth,_0x120e44=expressionOriginalHeight,_0x54fc6c=expressionOriginalX,_0x47b5cc=expressionOriginalY;switch(expressionResizeControlPoint){case 0x0:_0x2e18c3=expressionOriginalWidth-_0x2cf367,_0x120e44=_0x2e18c3*1.2,_0x54fc6c=expressionOriginalX+_0x2cf367,_0x47b5cc=expressionOriginalY-(_0x120e44-expressionOriginalHeight);break;case 0x1:_0x2e18c3=expressionOriginalWidth+_0x2cf367,_0x120e44=_0x2e18c3*1.2,_0x47b5cc=expressionOriginalY-(_0x120e44-expressionOriginalHeight);break;case 0x2:_0x2e18c3=expressionOriginalWidth+_0x2cf367,_0x120e44=_0x2e18c3*1.2;break;case 0x3:_0x2e18c3=expressionOriginalWidth-_0x2cf367,_0x120e44=_0x2e18c3*1.2,_0x54fc6c=expressionOriginalX+_0x2cf367;break;}_0x2e18c3=Math[_0x2f3309(0x2f1)](0x1e,_0x2e18c3),_0x120e44=_0x2e18c3*1.2;_0x2e18c3>0x28&&(_0xb178e8['x']=_0x54fc6c,_0xb178e8['y']=_0x47b5cc);_0xb178e8[_0x2f3309(0x2d1)]=_0x2e18c3,_0xb178e8[_0x2f3309(0x22f)]=_0x120e44,renderCanvas();return;}if(isEditingExpressionRect){if(currentFrameIndex!==-0x1&&currentAnim&&currentFrameIndex<currentAnim[_0x2f3309(0x25e)][_0x2f3309(0x31f)]&&currentAnim['aframeList'][currentFrameIndex]&&currentAnim[_0x2f3309(0x25e)][currentFrameIndex][_0x2f3309(0x21e)]){const _0x39eae7=currentAnim['aframeList'][currentFrameIndex]['expressionRect'],_0x4aeba1=_0x39eae7['x'],_0x382a81=_0x39eae7['x']+_0x39eae7[_0x2f3309(0x2d1)],_0x566e4e=_0x39eae7['y'],_0x2b467b=_0x39eae7['y']-_0x39eae7[_0x2f3309(0x22f)],_0x20461d=[{'x':_0x39eae7['x'],'y':_0x39eae7['y']},{'x':_0x39eae7['x']+_0x39eae7[_0x2f3309(0x2d1)],'y':_0x39eae7['y']},{'x':_0x39eae7['x']+_0x39eae7[_0x2f3309(0x2d1)],'y':_0x39eae7['y']-_0x39eae7[_0x2f3309(0x22f)]},{'x':_0x39eae7['x'],'y':_0x39eae7['y']-_0x39eae7[_0x2f3309(0x22f)]}];let _0x1f180d=![],_0x207fdd=-0x1;for(let _0x5268e9=0x0;_0x5268e9<_0x20461d[_0x2f3309(0x31f)];_0x5268e9++){const _0x3d5e6d=_0x59cc62-_0x20461d[_0x5268e9]['x'],_0x1ab958=_0x67b04e-_0x20461d[_0x5268e9]['y'];if(_0x3d5e6d*_0x3d5e6d+_0x1ab958*_0x1ab958<=0x10){_0x1f180d=!![],_0x207fdd=_0x5268e9,console[_0x2f3309(0x326)](_0x2f3309(0x202),_0x5268e9);break;}}if(_0x1f180d)console[_0x2f3309(0x326)]('resize',_0x207fdd),_0x207fdd===0x0||_0x207fdd===0x2?canvas['style']['cursor']=_0x2f3309(0x2c5):canvas[_0x2f3309(0x21b)][_0x2f3309(0x252)]='nesw-resize';else _0x59cc62>=_0x4aeba1&&_0x59cc62<=_0x382a81&&_0x67b04e<=_0x566e4e&&_0x67b04e>=_0x2b467b?(canvas['style'][_0x2f3309(0x252)]=_0x2f3309(0x308),console[_0x2f3309(0x326)](_0x2f3309(0x1f5))):canvas[_0x2f3309(0x21b)][_0x2f3309(0x252)]='default';}else console[_0x2f3309(0x326)](_0x2f3309(0x2a5)),canvas['style'][_0x2f3309(0x252)]='default';return;}if(isMarqueeSelecting&&currentFrame){marqueeEndX=_0x59cc62,marqueeEndY=_0x67b04e,renderCanvas();return;}if(!isDragging&&!isMultiDragging||!currentFrame||selectedModuleIndex<0x0)return;const _0x2a3d63=currentFrame['fmList'][selectedModuleIndex];if(isDraggingRotate){const _0x3f1e22=canvas[_0x2f3309(0x346)](),_0xb5565b=_0x102ade[_0x2f3309(0x1a4)]-_0x3f1e22[_0x2f3309(0x250)],_0x5625e3=_0x102ade[_0x2f3309(0x23f)]-_0x3f1e22[_0x2f3309(0x22b)],_0x59a1ab=_0xb5565b-moduleCenterX,_0x591391=_0x5625e3-moduleCenterY,_0x3d0011=Math['atan2'](_0x591391,_0x59a1ab),_0x16dc7c=_0x3d0011*0xb4/Math['PI'];_0x2a3d63['angle']=originalAngle+_0x16dc7c,renderCanvas(),updateModuleProperties(_0x2a3d63);return;}if(resizeControlPoint!==-0x1){const _0x339f51=_0x59cc62-dragStartX,_0xb0d25a=_0x67b04e-dragStartY;let _0x41069c=originalWidth,_0x41eeee=originalHeight,_0x6cc203=originalX,_0x7d74ce=originalY;switch(resizeControlPoint){case 0x0:_0x41069c=originalWidth-_0x339f51,_0x41eeee=originalHeight+_0xb0d25a,_0x6cc203=originalX+_0x339f51/0x2,_0x7d74ce=originalY-_0xb0d25a/0x2;break;case 0x1:_0x41069c=originalWidth+_0x339f51,_0x41eeee=originalHeight+_0xb0d25a,_0x6cc203=originalX-_0x339f51/0x2,_0x7d74ce=originalY-_0xb0d25a/0x2;break;case 0x2:_0x41069c=originalWidth+_0x339f51,_0x41eeee=originalHeight-_0xb0d25a,_0x6cc203=originalX-_0x339f51/0x2,_0x7d74ce=originalY+_0xb0d25a/0x2;break;case 0x3:_0x41069c=originalWidth-_0x339f51,_0x41eeee=originalHeight-_0xb0d25a,_0x6cc203=originalX+_0x339f51/0x2,_0x7d74ce=originalY+_0xb0d25a/0x2;break;}_0x41069c=Math[_0x2f3309(0x2f1)](0x1,_0x41069c),_0x41eeee=Math['max'](0x1,_0x41eeee);const _0x283247=_0x2a3d63[_0x2f3309(0x2ff)];if(_0x283247){const _0x1eb288=currentSprite[_0x2f3309(0x274)](_0x283247[_0x2f3309(0x25f)]);if(_0x1eb288&&_0x1eb288[_0x2f3309(0x2b2)][_0x283247[_0x2f3309(0x249)]]){const _0x5d50ea=_0x1eb288[_0x2f3309(0x2b2)][_0x283247[_0x2f3309(0x249)]];let _0xeed042=_0x5d50ea[_0x2f3309(0x2d1)],_0x26eb4b=_0x5d50ea['height'];_0x2a3d63[_0x2f3309(0x2b3)]&0x4&&([_0xeed042,_0x26eb4b]=[_0x26eb4b,_0xeed042]);const _0x344b9d=_0x41069c/_0xeed042;_0x2a3d63['x']=_0x6cc203,_0x2a3d63['y']=_0x7d74ce;if(!_0x2a3d63[_0x2f3309(0x2ae)])_0x2a3d63['scale']=0x1;_0x2a3d63[_0x2f3309(0x2ae)]=_0x344b9d;}}}else{const _0x4c256b=_0x59cc62-dragStartX,_0x2ad0d7=_0x67b04e-dragStartY;if(isMultiDragging)for(const _0x3fce85 of selectedModuleIndices){const _0x545bc9=currentFrame[_0x2f3309(0x186)][_0x3fce85];_0x545bc9['x']=_0x545bc9['x']+_0x4c256b,_0x545bc9['y']=_0x545bc9['y']+_0x2ad0d7;}else isDragging&&(_0x2a3d63['x']=_0x2a3d63['x']+_0x4c256b,_0x2a3d63['y']=_0x2a3d63['y']+_0x2ad0d7);dragStartX=_0x59cc62,dragStartY=_0x67b04e;}renderCanvas(),updateModuleProperties(_0x2a3d63);}function handleFrameMouseUp(_0x4d0b26){const _0x1af838=_0x46983b;if(isDraggingOrigin){isDraggingOrigin=![];isSpacePressed?canvas[_0x1af838(0x21b)][_0x1af838(0x252)]=_0x1af838(0x246):canvas[_0x1af838(0x21b)][_0x1af838(0x252)]='default';return;}if(isEditingExpressionRect){if(isDraggingExpressionRect)isDraggingExpressionRect=![];if(isResizingExpressionRect)isResizingExpressionRect=![];return;}if(isMarqueeSelecting&&currentFrame&&currentSprite){isMarqueeSelecting=![];const _0x1c5d69=Math[_0x1af838(0x32d)](marqueeStartX,marqueeEndX),_0x2e281f=Math[_0x1af838(0x32d)](marqueeStartY,marqueeEndY),_0x311f29=Math[_0x1af838(0x2f1)](marqueeStartX,marqueeEndX),_0x350a4b=Math[_0x1af838(0x2f1)](marqueeStartY,marqueeEndY);for(let _0x13e2fc=0x0;_0x13e2fc<currentFrame[_0x1af838(0x186)]['length'];_0x13e2fc++){const _0x1a6ca2=currentFrame['fmList'][_0x13e2fc],_0x39a61d=_0x1a6ca2['module'];if(!_0x39a61d)continue;const _0x2ae895=currentSprite['getImage'](_0x39a61d[_0x1af838(0x25f)]);if(!_0x2ae895||!_0x2ae895['modulesList'][_0x39a61d['imageModuleId']])continue;const _0x5bbda3=_0x2ae895[_0x1af838(0x2b2)][_0x39a61d[_0x1af838(0x249)]];let _0x37fe84=_0x5bbda3[_0x1af838(0x2d1)],_0x580c29=_0x5bbda3['height'];_0x1a6ca2[_0x1af838(0x2ae)]&&(_0x37fe84*=_0x1a6ca2[_0x1af838(0x2ae)],_0x580c29*=_0x1a6ca2[_0x1af838(0x2ae)]);_0x1a6ca2[_0x1af838(0x2b3)]&0x4&&([_0x37fe84,_0x580c29]=[_0x580c29,_0x37fe84]);const _0xf38ee=_0x1a6ca2['x'],_0x2f26d3=_0xf38ee+_0x37fe84,_0x245aa5=_0x1a6ca2['y'],_0x6529c2=_0x245aa5-_0x580c29;_0xf38ee>=_0x1c5d69&&_0x2f26d3<=_0x311f29&&_0x6529c2>=_0x2e281f&&_0x245aa5<=_0x350a4b&&(!selectedModuleIndices[_0x1af838(0x228)](_0x13e2fc)&&selectedModuleIndices[_0x1af838(0x2d6)](_0x13e2fc));}selectedModuleIndices[_0x1af838(0x31f)]>0x0&&(selectedModuleIndex=selectedModuleIndices[0x0],updateModuleProperties(currentFrame[_0x1af838(0x186)][selectedModuleIndex]));renderCanvas();return;}else isMarqueeSelecting=![];if(isDragging&&currentFrame&&selectedModuleIndex>=0x0){if(selectedModuleIndices[_0x1af838(0x31f)]>0x1&&dragStartModuleStates[_0x1af838(0x31f)]>0x0){const _0x524030=new CompositeCommand();for(const _0x58bc9d of dragStartModuleStates){const _0x1b8bde=currentFrame[_0x1af838(0x186)][_0x58bc9d[_0x1af838(0x1f7)]],_0x183e08=new TransformFmCommand(_0x1b8bde,_0x58bc9d['x'],_0x58bc9d['y'],_0x58bc9d[_0x1af838(0x2b3)]);_0x524030[_0x1af838(0x206)](_0x183e08);}CommandManager[_0x1af838(0x19c)]['addCommand'](_0x524030);}else{if(dragStartModuleState){const _0x431de1=currentFrame[_0x1af838(0x186)][selectedModuleIndex],_0x1923b3=new TransformFmCommand(_0x431de1,dragStartModuleState['x'],dragStartModuleState['y'],dragStartModuleState[_0x1af838(0x2b3)]);CommandManager[_0x1af838(0x19c)][_0x1af838(0x206)](_0x1923b3);}}dragStartModuleState=null,dragStartModuleStates=[];}if(!currentFrame)return;let [_0x354738,_0x26bc7f]=getCurrentXY(_0x4d0b26);const [_0x456aca,_0x2eb157,_0x32992e]=checkPointInFm(_0x354738,_0x26bc7f,currentFrame);if(_0x456aca&&_0x2eb157&&isCtrlPressed){const _0x1bc043=selectedModuleIndices[_0x1af838(0x2c0)](selectedModuleIndex);console[_0x1af838(0x326)](_0x1af838(0x169),_0x1bc043),_0x1bc043===-0x1?(selectedModuleIndices[_0x1af838(0x2d6)](selectedModuleIndex),selectedModuleIndex=selectedModuleIndex):(selectedModuleIndices['splice'](_0x1bc043,selectedModuleIndex),selectedModuleIndex=selectedModuleIndices['length']>0x0?selectedModuleIndices[0x0]:-0x1),renderCanvas(0x15);}isDragging=![],isMultiDragging=![],resizeControlPoint=-0x1,isDraggingRotate=![],isDraggingExpressionRect=![],expressionResizeControlPoint=-0x1;}function updateModuleProperties(_0x3d3521){if(isEditingExpressionRect)return;if(!_0x3d3521)return;}function updateModulePosition(){const _0x318a44=_0x46983b;if(isEditingExpressionRect)return;if(!currentFrame||selectedModuleIndex<0x0)return;const _0x385430=currentFrame[_0x318a44(0x186)][selectedModuleIndex],_0x1cbbbd=new TransformFmCommand(_0x385430,_0x385430['x'],_0x385430['y'],_0x385430[_0x318a44(0x2b3)]);CommandManager[_0x318a44(0x19c)]['addCommand'](_0x1cbbbd),renderCanvas(0xe);}function updateModuleSize(){const _0x10023e=_0x46983b;if(isEditingExpressionRect)return;if(!currentFrame||selectedModuleIndex<0x0)return;const _0x1832aa=currentFrame[_0x10023e(0x186)][selectedModuleIndex],_0x3a14ae=_0x1832aa[_0x10023e(0x2ff)];if(_0x3a14ae){const _0xb746e1=currentSprite[_0x10023e(0x274)](_0x3a14ae[_0x10023e(0x25f)]);if(_0xb746e1&&_0xb746e1[_0x10023e(0x2b2)][_0x3a14ae['imageModuleId']]){const _0x3e6c3d=_0xb746e1[_0x10023e(0x2b2)][_0x3a14ae['imageModuleId']];let _0x7cb488=_0x3e6c3d[_0x10023e(0x2d1)],_0x3ae186=_0x3e6c3d['height'];_0x1832aa[_0x10023e(0x2b3)]&0x4&&([_0x7cb488,_0x3ae186]=[_0x3ae186,_0x7cb488]);const _0x1c0883=parseInt(document[_0x10023e(0x321)](_0x10023e(0x2a4))[_0x10023e(0x2f6)])||_0x7cb488,_0x203f18=parseInt(document[_0x10023e(0x321)](_0x10023e(0x26a))[_0x10023e(0x2f6)])||_0x3ae186,_0x2a0a6a=new TransformFmCommand(_0x1832aa,_0x1832aa['x'],_0x1832aa['y'],_0x1832aa[_0x10023e(0x2b3)]),_0x29e1ba=_0x1c0883/_0x7cb488;if(!_0x1832aa[_0x10023e(0x2ae)])_0x1832aa[_0x10023e(0x2ae)]=0x1;_0x1832aa['scale']=_0x29e1ba,CommandManager[_0x10023e(0x19c)][_0x10023e(0x206)](_0x2a0a6a),renderCanvas(0xf),updateModuleProperties(_0x1832aa);}}}function checkImageUsage(_0x52c5e1){const _0x436215=_0x46983b,_0x148bd2=[];if(!currentSprite)return _0x148bd2;return currentSprite[_0x436215(0x2d3)]['forEach']((_0x2be931,_0x4b9ee6)=>{const _0x3e051c=_0x436215;_0x2be931['aframeList'][_0x3e051c(0x294)]((_0x5f3cb4,_0x3bda26)=>{const _0x4fd6d1=_0x3e051c,_0x13ab25=_0x5f3cb4[_0x4fd6d1(0x296)],_0x157278=_0x13ab25[_0x4fd6d1(0x186)][_0x4fd6d1(0x2e2)](_0x58f71f=>_0x58f71f[_0x4fd6d1(0x2ff)]&&_0x58f71f['module'][_0x4fd6d1(0x25f)]===_0x52c5e1);_0x157278&&_0x148bd2[_0x4fd6d1(0x2d6)]({'animName':_0x2be931[_0x4fd6d1(0x1db)],'animIndex':_0x4b9ee6,'frameIndex':_0x3bda26});});}),_0x148bd2;}function deleteImage(_0x1e80e9){const _0x24d720=_0x46983b,_0x74f075=checkImageUsage(_0x1e80e9['id']);if(_0x74f075['length']>0x0){let _0x55491e=_0x24d720(0x1a2);_0x74f075[_0x24d720(0x294)](_0x37058d=>{const _0x595b10=_0x24d720;_0x55491e+=_0x595b10(0x281)+_0x37058d[_0x595b10(0x1af)]+'\x20(第\x20'+(_0x37058d[_0x595b10(0x2c6)]+0x1)+'\x20帧)\x0a';}),_0x55491e+='删除后，这些帧中使用该图片的模块也将被删除。\x0a确认要删除吗？';if(!confirm(_0x55491e))return;_0x74f075[_0x24d720(0x294)](_0xccbd0b=>{const _0x10b5d3=_0x24d720,_0x1aa255=currentSprite['mAnimList'][_0xccbd0b[_0x10b5d3(0x31e)]],_0x5143dc=_0x1aa255[_0x10b5d3(0x25e)][_0xccbd0b[_0x10b5d3(0x2c6)]],_0x540f8d=_0x5143dc[_0x10b5d3(0x296)];_0x540f8d[_0x10b5d3(0x186)]=_0x540f8d[_0x10b5d3(0x186)][_0x10b5d3(0x187)](_0x9d6b89=>!_0x9d6b89[_0x10b5d3(0x2ff)]||_0x9d6b89[_0x10b5d3(0x2ff)]['imageId']!==_0x1e80e9['id']);});}const _0x13c0ae=currentSprite['m_imageList'][_0x24d720(0x258)](_0x11ca11=>_0x11ca11['id']===_0x1e80e9['id']);_0x13c0ae!==-0x1&&currentSprite['m_imageList'][_0x24d720(0x195)](_0x13c0ae,0x1),imageManager['removeImage'](_0x1e80e9['id']),currentImageId===_0x1e80e9['id']&&(currentImageId=null,currentImage=null,imageCtx[_0x24d720(0x1f9)](0x0,0x0,imageCanvas[_0x24d720(0x2d1)],imageCanvas[_0x24d720(0x22f)]),renderModulesList()),renderImagesList(),currentTab===_0x24d720(0x2db)&&currentFrame&&renderCanvas();}function replaceImage(_0xca089){const _0x1d0b2c=_0x46983b,_0x3bbe43=document[_0x1d0b2c(0x161)](_0x1d0b2c(0x307));_0x3bbe43[_0x1d0b2c(0x2a2)]=_0x1d0b2c(0x223),_0x3bbe43[_0x1d0b2c(0x31c)]=_0x1d0b2c(0x2fd),_0x3bbe43[_0x1d0b2c(0x207)]=function(_0x15c4af){const _0x4a6b71=_0x1d0b2c,_0x3fd384=_0x15c4af[_0x4a6b71(0x263)][_0x4a6b71(0x22c)][0x0];if(!_0x3fd384)return;const _0x9a32cb=new FileReader();_0x9a32cb['onload']=function(_0x2d19cc){const _0x12bc2a=_0x4a6b71,_0x3ee8f0=new Image();_0x3ee8f0['onload']=function(){const _0x36ab49=_0x2b13;if(_0x3ee8f0[_0x36ab49(0x2d1)]!==_0xca089[_0x36ab49(0x2ac)][_0x36ab49(0x2d1)]||_0x3ee8f0[_0x36ab49(0x22f)]!==_0xca089[_0x36ab49(0x2ac)][_0x36ab49(0x22f)]){alert(_0x36ab49(0x1ba)+_0x3ee8f0['width']+'x'+_0x3ee8f0['height']+_0x36ab49(0x27a)+_0xca089['image']['width']+'x'+_0xca089[_0x36ab49(0x2ac)][_0x36ab49(0x22f)]+')\x20一致，否则会出现未知错误。');return;}_0xca089['image']=_0x3ee8f0,_0xca089[_0x36ab49(0x273)]=_0x2d19cc[_0x36ab49(0x263)][_0x36ab49(0x1ed)],currentImageId===_0xca089['id']&&(currentImage=_0x3ee8f0,drawCurrentImage()),renderImagesList(),currentTab==='animation'&&currentFrame&&renderCanvas();},_0x3ee8f0[_0x12bc2a(0x273)]=_0x2d19cc[_0x12bc2a(0x263)][_0x12bc2a(0x1ed)];},_0x9a32cb[_0x4a6b71(0x2d7)](_0x3fd384);},_0x3bbe43[_0x1d0b2c(0x295)]();}function renderSpriteList(){const _0x154f5e=_0x46983b,_0x4dc906=document['getElementById'](_0x154f5e(0x239));_0x4dc906[_0x154f5e(0x196)]='',currentProject[_0x154f5e(0x2ab)][_0x154f5e(0x294)]((_0xed7888,_0x5bc45f)=>{const _0x226b11=_0x154f5e,_0x36d42e=document[_0x226b11(0x161)]('li');_0x36d42e['textContent']=_0xed7888[_0x226b11(0x1db)],currentSprite===_0xed7888&&_0x36d42e['classList']['add']('active'),_0x36d42e[_0x226b11(0x316)]('click',()=>{selectSprite(_0x5bc45f);}),_0x4dc906[_0x226b11(0x1d0)](_0x36d42e);});}function renderAnimList(){const _0x1fae0b=_0x46983b,_0x3e31f8=document['getElementById'](_0x1fae0b(0x22e));_0x3e31f8[_0x1fae0b(0x196)]='';if(!currentSprite)return;currentSprite[_0x1fae0b(0x2d3)]['forEach']((_0x274694,_0x202f00)=>{const _0x14e849=_0x1fae0b,_0x56e3e5=document[_0x14e849(0x161)]('li');_0x56e3e5[_0x14e849(0x1c9)]=_0x14e849(0x1e8)+(currentAnim===_0x274694?_0x14e849(0x20d):'');const _0x282580=document[_0x14e849(0x161)]('span');_0x282580[_0x14e849(0x1c9)]=_0x14e849(0x19b),_0x282580['textContent']=_0x274694[_0x14e849(0x1db)],_0x282580[_0x14e849(0x316)](_0x14e849(0x295),_0x439068=>{const _0x2a492e=_0x14e849;_0x439068[_0x2a492e(0x292)](),selectAnim(_0x202f00);});const _0x59dc9a=document[_0x14e849(0x161)](_0x14e849(0x2d4));_0x59dc9a[_0x14e849(0x1c9)]=_0x14e849(0x284);const _0x349c39=document['createElement']('button');_0x349c39[_0x14e849(0x1c9)]=_0x14e849(0x2d2),_0x349c39[_0x14e849(0x2f0)]='复制',_0x349c39['addEventListener'](_0x14e849(0x295),_0x48f275=>{const _0x560df4=_0x14e849;_0x48f275[_0x560df4(0x292)](),currentAnim===_0x274694?copyAnimation():(selectAnim(_0x202f00),setTimeout(copyAnimation,0x64));}),_0x59dc9a[_0x14e849(0x1d0)](_0x349c39);const _0x16a3f4=document[_0x14e849(0x161)](_0x14e849(0x197));_0x16a3f4[_0x14e849(0x1c9)]=_0x14e849(0x2d2),_0x16a3f4['textContent']=_0x14e849(0x242),_0x16a3f4[_0x14e849(0x316)](_0x14e849(0x295),_0xfc63ae=>{const _0x2746d4=_0x14e849;_0xfc63ae[_0x2746d4(0x292)](),currentAnim===_0x274694?renameAnimation():(selectAnim(_0x202f00),setTimeout(renameAnimation,0x64));});const _0x5855de=document['createElement'](_0x14e849(0x197));_0x5855de['className']=_0x14e849(0x2d2),_0x5855de['textContent']='上移',_0x5855de[_0x14e849(0x232)]=_0x202f00===0x0,_0x5855de[_0x14e849(0x316)](_0x14e849(0x295),_0x2ebaa6=>{_0x2ebaa6['stopPropagation'](),currentAnim===_0x274694?moveAnimationUp():(selectAnim(_0x202f00),setTimeout(moveAnimationUp,0x64));});const _0x1fbc2e=document[_0x14e849(0x161)]('button');_0x1fbc2e[_0x14e849(0x1c9)]=_0x14e849(0x2d2),_0x1fbc2e['textContent']='下移',_0x1fbc2e[_0x14e849(0x232)]=_0x202f00===currentSprite[_0x14e849(0x2d3)][_0x14e849(0x31f)]-0x1,_0x1fbc2e[_0x14e849(0x316)](_0x14e849(0x295),_0xa09789=>{const _0x4f6643=_0x14e849;_0xa09789[_0x4f6643(0x292)](),currentAnim===_0x274694?moveAnimationDown():(selectAnim(_0x202f00),setTimeout(moveAnimationDown,0x64));});const _0x45a067=document['createElement']('button');_0x45a067[_0x14e849(0x1c9)]=_0x14e849(0x2d2),_0x45a067[_0x14e849(0x2f0)]='置顶',_0x45a067['disabled']=_0x202f00===0x0,_0x45a067['addEventListener'](_0x14e849(0x295),_0x1368c0=>{_0x1368c0['stopPropagation'](),currentAnim===_0x274694?moveAnimationToTop():(selectAnim(_0x202f00),setTimeout(moveAnimationToTop,0x64));});const _0x47d978=document[_0x14e849(0x161)]('button');_0x47d978['className']=_0x14e849(0x2d2),_0x47d978[_0x14e849(0x2f0)]='置底',_0x47d978[_0x14e849(0x232)]=_0x202f00===currentSprite[_0x14e849(0x2d3)][_0x14e849(0x31f)]-0x1,_0x47d978[_0x14e849(0x316)](_0x14e849(0x295),_0xa9d9fd=>{const _0x378b9b=_0x14e849;_0xa9d9fd[_0x378b9b(0x292)](),currentAnim===_0x274694?moveAnimationToBottom():(selectAnim(_0x202f00),setTimeout(moveAnimationToBottom,0x64));});const _0xdb3184=document[_0x14e849(0x161)](_0x14e849(0x197));_0xdb3184[_0x14e849(0x1c9)]=_0x14e849(0x2d2),_0xdb3184[_0x14e849(0x2f0)]='删除',_0xdb3184[_0x14e849(0x21b)][_0x14e849(0x2a1)]=_0x14e849(0x167),_0xdb3184[_0x14e849(0x21b)][_0x14e849(0x19f)]='white',_0xdb3184['addEventListener'](_0x14e849(0x295),_0x2ea4b4=>{const _0x18a855=_0x14e849;_0x2ea4b4[_0x18a855(0x292)](),currentAnim===_0x274694?deleteAnimation():(selectAnim(_0x202f00),setTimeout(deleteAnimation,0x64));}),_0x59dc9a['appendChild'](_0x16a3f4),_0x59dc9a[_0x14e849(0x1d0)](_0xdb3184),_0x56e3e5['appendChild'](_0x282580),_0x56e3e5[_0x14e849(0x1d0)](_0x59dc9a),_0x3e31f8[_0x14e849(0x1d0)](_0x56e3e5);});}function renderTimeline(){const _0x5c8665=_0x46983b,_0x3d3c6f=document[_0x5c8665(0x321)](_0x5c8665(0x217));_0x3d3c6f['innerHTML']='';if(!currentAnim)return;_0x3d3c6f[_0x5c8665(0x29f)](_0x5c8665(0x222),_0x5c8665(0x1a8)),_0x3d3c6f[_0x5c8665(0x29f)](_0x5c8665(0x23e),_0x5c8665(0x32e)),currentAnim[_0x5c8665(0x25e)][_0x5c8665(0x294)]((_0x484807,_0x582d07)=>{const _0x111e2b=_0x5c8665,_0x56a9a1=document[_0x111e2b(0x161)](_0x111e2b(0x2d4));_0x56a9a1[_0x111e2b(0x1c9)]=_0x111e2b(0x1cd)+(_0x582d07===currentFrameIndex?_0x111e2b(0x20d):''),_0x484807['KeyFrameState']&&_0x56a9a1['classList'][_0x111e2b(0x2b6)](_0x111e2b(0x1c1)),_0x56a9a1[_0x111e2b(0x2f0)]=_0x582d07+0x1,_0x56a9a1[_0x111e2b(0x29f)](_0x111e2b(0x194),_0x111e2b(0x2e4)),_0x56a9a1[_0x111e2b(0x29f)](_0x111e2b(0x322),_0x582d07),_0x56a9a1[_0x111e2b(0x29f)](_0x111e2b(0x1fe),'handleFrameDragStart(event)'),_0x56a9a1['setAttribute']('ondragend',_0x111e2b(0x1b6)),_0x56a9a1[_0x111e2b(0x29f)](_0x111e2b(0x222),'event.preventDefault()'),_0x56a9a1[_0x111e2b(0x29f)]('ondrop',_0x111e2b(0x1d1)),_0x56a9a1[_0x111e2b(0x29f)](_0x111e2b(0x17e),_0x111e2b(0x210)),_0x56a9a1['setAttribute'](_0x111e2b(0x1a6),_0x111e2b(0x17b)),_0x56a9a1[_0x111e2b(0x316)](_0x111e2b(0x295),()=>{selectFrame(_0x582d07);}),_0x3d3c6f[_0x111e2b(0x1d0)](_0x56a9a1);});}let draggedFrameIndex=-0x1;function handleFrameDragStart(_0x25553e){const _0x106629=_0x46983b;draggedFrameIndex=parseInt(_0x25553e[_0x106629(0x263)][_0x106629(0x288)](_0x106629(0x322))),_0x25553e[_0x106629(0x18a)][_0x106629(0x1c8)]=_0x106629(0x308),_0x25553e[_0x106629(0x263)]['style'][_0x106629(0x2fe)]=_0x106629(0x276);}function handleFrameDragEnd(_0x2f102a){const _0x17799b=_0x46983b;_0x2f102a[_0x17799b(0x263)][_0x17799b(0x21b)]['opacity']='1';const _0x37a7d2=document[_0x17799b(0x26d)](_0x17799b(0x1bc));_0x37a7d2[_0x17799b(0x294)](_0xdaeb24=>{const _0x661bef=_0x17799b;_0xdaeb24[_0x661bef(0x21b)][_0x661bef(0x2a1)]='';});}function handleFrameDragEnter(_0x317a67){const _0x12d5d0=_0x46983b;_0x317a67[_0x12d5d0(0x263)]['classList'][_0x12d5d0(0x2b5)](_0x12d5d0(0x1cd))&&(_0x317a67[_0x12d5d0(0x263)]['style'][_0x12d5d0(0x2a1)]=_0x12d5d0(0x2fb));}function handleFrameDragLeave(_0x424327){const _0x2768dd=_0x46983b;_0x424327[_0x2768dd(0x263)][_0x2768dd(0x27c)]['contains']('timeline-frame')&&(_0x424327[_0x2768dd(0x263)]['style'][_0x2768dd(0x2a1)]='');}function handleFrameDrop(_0x9c99a7){const _0x44d196=_0x46983b;_0x9c99a7['preventDefault']();if(!currentAnim||draggedFrameIndex===-0x1)return;const _0x2cf071=_0x9c99a7[_0x44d196(0x263)][_0x44d196(0x209)]('.timeline-frame');if(!_0x2cf071)return;const _0xf76c24=parseInt(_0x2cf071[_0x44d196(0x288)](_0x44d196(0x322)));if(draggedFrameIndex===_0xf76c24){draggedFrameIndex=-0x1;return;}const _0x56037a=currentAnim[_0x44d196(0x25e)][draggedFrameIndex];currentAnim['aframeList'][_0x44d196(0x195)](draggedFrameIndex,0x1);const _0x5440d5=_0xf76c24>draggedFrameIndex?_0xf76c24:_0xf76c24;currentAnim[_0x44d196(0x25e)][_0x44d196(0x195)](_0x5440d5,0x0,_0x56037a);if(currentFrameIndex===draggedFrameIndex)currentFrameIndex=_0x5440d5;else{if(currentFrameIndex>draggedFrameIndex&&currentFrameIndex<=_0x5440d5)currentFrameIndex--;else currentFrameIndex<draggedFrameIndex&&currentFrameIndex>=_0x5440d5&&currentFrameIndex++;}currentFrame=currentAnim[_0x44d196(0x25e)][currentFrameIndex][_0x44d196(0x296)],renderTimeline(),saveProject(),draggedFrameIndex=-0x1;}function handleTimelineDrop(_0x4d2304){_0x4d2304['preventDefault']();}function renderXY(){const _0x2d8be8=_0x46983b;if(showGrid){ctx[_0x2d8be8(0x235)]=gridColor,ctx[_0x2d8be8(0x2b9)]=0x1,ctx[_0x2d8be8(0x16c)]();for(let _0x22954a=0x0;_0x22954a<=canvas[_0x2d8be8(0x2d1)];_0x22954a+=gridSize){ctx[_0x2d8be8(0x300)](_0x22954a,0x0),ctx[_0x2d8be8(0x1da)](_0x22954a,canvas[_0x2d8be8(0x22f)]);}ctx['stroke'](),ctx[_0x2d8be8(0x16c)]();for(let _0x41b0d8=0x0;_0x41b0d8<=canvas[_0x2d8be8(0x22f)];_0x41b0d8+=gridSize){ctx['moveTo'](0x0,_0x41b0d8),ctx[_0x2d8be8(0x1da)](canvas[_0x2d8be8(0x2d1)],_0x41b0d8);}ctx[_0x2d8be8(0x2ca)]();}ctx[_0x2d8be8(0x235)]='#999',ctx['lineWidth']=0x1,ctx['setLineDash']([0x5,0x5]),ctx[_0x2d8be8(0x16c)](),ctx[_0x2d8be8(0x300)](0x0,m_imageOriginPos['y']),ctx[_0x2d8be8(0x1da)](canvas[_0x2d8be8(0x2d1)],m_imageOriginPos['y']),ctx[_0x2d8be8(0x2ca)](),ctx[_0x2d8be8(0x16c)](),ctx['moveTo'](m_imageOriginPos['x'],0x0),ctx[_0x2d8be8(0x1da)](m_imageOriginPos['x'],canvas['height']),ctx[_0x2d8be8(0x2ca)](),ctx[_0x2d8be8(0x1ae)]([]),ctx[_0x2d8be8(0x235)]=_0x2d8be8(0x198),ctx[_0x2d8be8(0x2b9)]=0x1,ctx[_0x2d8be8(0x16c)](),ctx[_0x2d8be8(0x300)](m_imageOriginPos['x']-0x8,m_imageOriginPos['y']),ctx[_0x2d8be8(0x1da)](m_imageOriginPos['x']+0x8,m_imageOriginPos['y']),ctx['moveTo'](m_imageOriginPos['x'],m_imageOriginPos['y']-0x8),ctx[_0x2d8be8(0x1da)](m_imageOriginPos['x'],m_imageOriginPos['y']+0x8),ctx[_0x2d8be8(0x2ca)]();}function renderCanvas(_0x48540d=-0x1){const _0x4c31f4=_0x46983b;_0x48540d!==-0x1&&console[_0x4c31f4(0x326)](_0x4c31f4(0x25b),_0x48540d);ctx[_0x4c31f4(0x1f9)](0x0,0x0,canvas['width'],canvas[_0x4c31f4(0x22f)]),renderXY();if(!currentFrame){showPreviewWithMouse&&drawMouseFollowPreview(ctx);ctx[_0x4c31f4(0x314)]();return;}ctx[_0x4c31f4(0x314)](),ctx['save'](),ctx[_0x4c31f4(0x2ae)](zoomLevel,zoomLevel);let _0x3a3d65=null;if(isShowExpression&&currentSelectedExpression&&currentFrameIndex>=0x0){const _0x442668=expressions[_0x4c31f4(0x200)](_0x3c43f3=>_0x3c43f3[_0x4c31f4(0x1db)]===currentSelectedExpression);_0x442668&&currentFrameIndex<_0x442668[_0x4c31f4(0x271)][_0x4c31f4(0x31f)]&&(_0x3a3d65=_0x442668[_0x4c31f4(0x271)][currentFrameIndex]);}if(currentAnim&&currentFrameIndex>=0x0&&currentFrameIndex<currentAnim['aframeList'][_0x4c31f4(0x31f)]&&currentAnim[_0x4c31f4(0x25e)][currentFrameIndex]){const _0x18c36f=currentAnim[_0x4c31f4(0x25e)][currentFrameIndex];_0x18c36f[_0x4c31f4(0x2bc)](ctx,currentSprite,m_imageOriginPos['x']/zoomLevel,m_imageOriginPos['y']/zoomLevel,_0x3a3d65,globalHorizontalMirrorFlag,0x1,0x0);}if(!isPlaying&&isEditingExpressionRect&&currentAnim&&currentFrameIndex>=0x0&&currentAnim[_0x4c31f4(0x25e)][currentFrameIndex]){const _0x245fe9=currentAnim['aframeList'][currentFrameIndex];if(_0x245fe9[_0x4c31f4(0x21e)]){const _0x26cf2b=_0x245fe9['expressionRect'];ctx[_0x4c31f4(0x235)]=isEditingExpressionRect?_0x4c31f4(0x299):'blue',ctx[_0x4c31f4(0x2b9)]=0x2/zoomLevel,ctx['strokeRect'](m_imageOriginPos['x']/zoomLevel+_0x26cf2b['x'],m_imageOriginPos['y']/zoomLevel-_0x26cf2b['y'],_0x26cf2b[_0x4c31f4(0x2d1)],_0x26cf2b[_0x4c31f4(0x22f)]);const _0x1a27df=[{'x':m_imageOriginPos['x']/zoomLevel+_0x26cf2b['x'],'y':m_imageOriginPos['y']/zoomLevel-_0x26cf2b['y']},{'x':m_imageOriginPos['x']/zoomLevel+_0x26cf2b['x']+_0x26cf2b['width'],'y':m_imageOriginPos['y']/zoomLevel-_0x26cf2b['y']},{'x':m_imageOriginPos['x']/zoomLevel+_0x26cf2b['x']+_0x26cf2b[_0x4c31f4(0x2d1)],'y':m_imageOriginPos['y']/zoomLevel-_0x26cf2b['y']+_0x26cf2b[_0x4c31f4(0x22f)]},{'x':m_imageOriginPos['x']/zoomLevel+_0x26cf2b['x'],'y':m_imageOriginPos['y']/zoomLevel-_0x26cf2b['y']+_0x26cf2b[_0x4c31f4(0x22f)]}];ctx['fillStyle']=_0x4c31f4(0x299),_0x1a27df[_0x4c31f4(0x294)](_0x4fdc72=>{ctx['beginPath'](),ctx['arc'](_0x4fdc72['x'],_0x4fdc72['y'],0x4/zoomLevel,0x0,0x2*Math['PI']),ctx['fill']();});}}if(selectedModuleIndices[_0x4c31f4(0x31f)]>0x0&&currentFrame)for(const _0x5c6ce4 of selectedModuleIndices){const _0x3152ae=currentFrame[_0x4c31f4(0x186)][_0x5c6ce4];if(!_0x3152ae)continue;const _0x67ed9d=_0x3152ae[_0x4c31f4(0x2ff)];if(!_0x67ed9d)continue;const _0x3a57e9=currentSprite[_0x4c31f4(0x274)](_0x67ed9d[_0x4c31f4(0x25f)]);if(!_0x3a57e9||!_0x3a57e9[_0x4c31f4(0x2b2)][_0x67ed9d['imageModuleId']])continue;const _0x8601a4=_0x3a57e9['modulesList'][_0x67ed9d[_0x4c31f4(0x249)]];let _0x43820d=_0x8601a4[_0x4c31f4(0x2d1)],_0x4d4507=_0x8601a4[_0x4c31f4(0x22f)];_0x3152ae['scale']&&(_0x43820d*=_0x3152ae[_0x4c31f4(0x2ae)],_0x4d4507*=_0x3152ae[_0x4c31f4(0x2ae)]);_0x3152ae[_0x4c31f4(0x2b3)]&0x4&&([_0x43820d,_0x4d4507]=[_0x4d4507,_0x43820d]);const _0x1d53cd=_0x5c6ce4===selectedModuleIndex,_0x53831d=_0x1d53cd?_0x4c31f4(0x191):_0x4c31f4(0x16b),_0x230f78=_0x1d53cd?0x2/zoomLevel:0x1/zoomLevel;ctx[_0x4c31f4(0x235)]=_0x53831d,ctx[_0x4c31f4(0x2b9)]=_0x230f78,ctx[_0x4c31f4(0x2cd)](m_imageOriginPos['x']/zoomLevel+_0x3152ae['x']-0x2/zoomLevel,m_imageOriginPos['y']/zoomLevel-_0x3152ae['y']-0x2/zoomLevel,_0x43820d+0x4/zoomLevel,_0x4d4507+0x4/zoomLevel);if(_0x1d53cd){const _0x534c62=[{'x':m_imageOriginPos['x']/zoomLevel+_0x3152ae['x'],'y':m_imageOriginPos['y']/zoomLevel-_0x3152ae['y']},{'x':m_imageOriginPos['x']/zoomLevel+_0x3152ae['x']+_0x43820d,'y':m_imageOriginPos['y']/zoomLevel-_0x3152ae['y']},{'x':m_imageOriginPos['x']/zoomLevel+_0x3152ae['x']+_0x43820d,'y':m_imageOriginPos['y']/zoomLevel-_0x3152ae['y']+_0x4d4507},{'x':m_imageOriginPos['x']/zoomLevel+_0x3152ae['x'],'y':m_imageOriginPos['y']/zoomLevel-_0x3152ae['y']+_0x4d4507}];ctx[_0x4c31f4(0x234)]=_0x4c31f4(0x191),_0x534c62[_0x4c31f4(0x294)](_0x4bb04a=>{const _0x1c25b0=_0x4c31f4;ctx[_0x1c25b0(0x16c)](),ctx['arc'](_0x4bb04a['x'],_0x4bb04a['y'],0x4/zoomLevel,0x0,0x2*Math['PI']),ctx['fill']();});const _0x4d995c=m_imageOriginPos['x']/zoomLevel+_0x3152ae['x']+_0x43820d+0xa/zoomLevel,_0x1c8a8d=m_imageOriginPos['y']/zoomLevel-_0x3152ae['y']+_0x4d4507;ctx['strokeStyle']='blue',ctx[_0x4c31f4(0x2b9)]=0x1/zoomLevel,ctx['beginPath'](),ctx['moveTo'](_0x534c62[0x2]['x'],_0x534c62[0x2]['y']),ctx[_0x4c31f4(0x1da)](_0x4d995c,_0x1c8a8d),ctx[_0x4c31f4(0x2ca)](),ctx[_0x4c31f4(0x234)]=_0x4c31f4(0x191),ctx[_0x4c31f4(0x16c)](),ctx[_0x4c31f4(0x27f)](_0x4d995c,_0x1c8a8d,0x4/zoomLevel,0x0,0x2*Math['PI']),ctx[_0x4c31f4(0x2ed)](),ctx[_0x4c31f4(0x234)]='black',ctx[_0x4c31f4(0x248)]=0xc/zoomLevel+_0x4c31f4(0x22a),ctx[_0x4c31f4(0x2c1)](_0x4c31f4(0x337)+Math[_0x4c31f4(0x21d)](_0x3152ae['x']),m_imageOriginPos['x']/zoomLevel+_0x3152ae['x']+_0x43820d/0x2+0xa/zoomLevel,m_imageOriginPos['y']/zoomLevel-_0x3152ae['y']-_0x4d4507/0x2-0xa/zoomLevel),ctx[_0x4c31f4(0x2c1)](_0x4c31f4(0x1ec)+Math[_0x4c31f4(0x21d)](_0x3152ae['y']),m_imageOriginPos['x']/zoomLevel+_0x3152ae['x']+_0x43820d/0x2+0xa/zoomLevel,m_imageOriginPos['y']/zoomLevel-_0x3152ae['y']-_0x4d4507/0x2);}}else{if(selectedModuleIndex!==-0x1){}}if(isMarqueeSelecting&&currentFrame){const _0x2cf255=Math[_0x4c31f4(0x32d)](marqueeStartX,marqueeEndX),_0x2bf560=Math[_0x4c31f4(0x32d)](marqueeStartY,marqueeEndY),_0x2dbe48=Math[_0x4c31f4(0x2f1)](marqueeStartX,marqueeEndX),_0x20711=Math[_0x4c31f4(0x2f1)](marqueeStartY,marqueeEndY),_0x45e00b=m_imageOriginPos['x']/zoomLevel+_0x2cf255,_0x1d775b=m_imageOriginPos['y']/zoomLevel-_0x2bf560,_0x4b45be=_0x2dbe48-_0x2cf255,_0x11e6a7=_0x2bf560-_0x20711;ctx[_0x4c31f4(0x1ae)]([0x5/zoomLevel,0x5/zoomLevel]),ctx['strokeStyle']=_0x4c31f4(0x198),ctx[_0x4c31f4(0x2b9)]=0x1/zoomLevel,ctx[_0x4c31f4(0x2cd)](_0x45e00b,_0x1d775b,_0x4b45be,_0x11e6a7),ctx[_0x4c31f4(0x234)]=_0x4c31f4(0x2be),ctx[_0x4c31f4(0x166)](_0x45e00b,_0x1d775b,_0x4b45be,_0x11e6a7),ctx[_0x4c31f4(0x1ae)]([]);}ctx[_0x4c31f4(0x314)](),showPreviewWithMouse&&drawMouseFollowPreview(ctx);}function selectSprite(_0x26e32b){const _0x190a74=_0x46983b;if(_0x26e32b<0x0||_0x26e32b>=currentProject[_0x190a74(0x2ab)][_0x190a74(0x31f)])return;currentSprite=currentProject[_0x190a74(0x2ab)][_0x26e32b],currentAnim=null,currentFrame=null,currentFrameIndex=0x0,selectedModuleIndex=-0x1,selectedModuleIndices=[],renderSpriteList(),renderAnimList(),renderTimeline(),renderCanvas(0x10),renderImagesList(),document['getElementById'](_0x190a74(0x24d))[_0x190a74(0x2f0)]='选择一个动作开始编辑';}function selectAnim(_0x3c8b0e){const _0x15f0b4=_0x46983b;if(!currentSprite||_0x3c8b0e<0x0||_0x3c8b0e>=currentSprite['mAnimList'][_0x15f0b4(0x31f)])return;currentAnim=currentSprite[_0x15f0b4(0x2d3)][_0x3c8b0e],currentFrame=currentAnim[_0x15f0b4(0x25e)][_0x15f0b4(0x31f)]>0x0?currentAnim[_0x15f0b4(0x25e)][0x0][_0x15f0b4(0x296)]:null,currentFrameIndex=0x0,selectedModuleIndex=-0x1,selectedModuleIndices=[],renderAnimList(),renderTimeline(),renderCanvas(0x11),document[_0x15f0b4(0x321)]('current-anim-name')[_0x15f0b4(0x2f0)]=currentAnim['name']+(currentFrame?'\x20-\x20帧'+(currentFrameIndex+0x1):_0x15f0b4(0x1e0));}function selectFrame(_0xd83407){const _0x30e3e2=_0x46983b;if(!currentAnim||_0xd83407<0x0||_0xd83407>=currentAnim[_0x30e3e2(0x25e)][_0x30e3e2(0x31f)])return;currentFrameIndex=_0xd83407,currentFrame=currentAnim[_0x30e3e2(0x25e)][_0xd83407][_0x30e3e2(0x296)],selectedModuleIndex=-0x1,selectedModuleIndices=[],renderTimeline(),renderCanvas(0x12),document['getElementById'](_0x30e3e2(0x24d))[_0x30e3e2(0x2f0)]=currentAnim[_0x30e3e2(0x1db)]+'\x20-\x20帧'+(currentFrameIndex+0x1);}function togglePlayAnimation(){const _0xb1b833=_0x46983b;if(!currentAnim||currentAnim[_0xb1b833(0x25e)][_0xb1b833(0x31f)]===0x0){alert(_0xb1b833(0x229));return;}isPlaying=!isPlaying;const _0x19ae06=document[_0xb1b833(0x321)]('play-animation');_0x19ae06[_0xb1b833(0x2f0)]=isPlaying?'暂停':'播放';if(isPlaying)lastFrameTime=performance[_0xb1b833(0x1ce)](),playAnimation();else animationFrameId&&cancelAnimationFrame(animationFrameId);}function playAnimation(_0x559add){const _0x428576=_0x46983b;if(!isPlaying)return;if(!_0x559add)_0x559add=performance[_0x428576(0x1ce)]();const _0x3f4bd0=_0x559add-lastFrameTime;_0x3f4bd0>=animationSpeed&&(lastFrameTime=_0x559add,currentFrameIndex=(currentFrameIndex+0x1)%currentAnim[_0x428576(0x25e)][_0x428576(0x31f)],currentFrame=currentAnim[_0x428576(0x25e)][currentFrameIndex][_0x428576(0x296)],renderTimeline(),renderCanvas(0x13),document[_0x428576(0x321)](_0x428576(0x24d))[_0x428576(0x2f0)]=currentAnim['name']+_0x428576(0x303)+(currentFrameIndex+0x1)),animationFrameId=requestAnimationFrame(playAnimation);}let hidDebug=![];function showDebugInfo(){const _0x2ab5d8=_0x46983b;let _0x596386=document[_0x2ab5d8(0x321)](_0x2ab5d8(0x17c));if(_0x596386){_0x596386['hidden']=hidDebug,hidDebug=!hidDebug;return;}_0x596386=document[_0x2ab5d8(0x161)](_0x2ab5d8(0x2d4)),_0x596386['id']=_0x2ab5d8(0x17c),_0x596386['style']['cssText']=_0x2ab5d8(0x1c5);const _0x5a88d1=document[_0x2ab5d8(0x161)](_0x2ab5d8(0x2d4));_0x5a88d1[_0x2ab5d8(0x21b)]['padding']=_0x2ab5d8(0x1b8);const _0x34b28b=document[_0x2ab5d8(0x161)]('h4');_0x34b28b[_0x2ab5d8(0x21b)][_0x2ab5d8(0x188)]='0',_0x34b28b[_0x2ab5d8(0x21b)][_0x2ab5d8(0x19f)]='#fff',_0x34b28b['textContent']=_0x2ab5d8(0x29a);const _0x386b3b=document['createElement'](_0x2ab5d8(0x2d4));_0x386b3b['id']=_0x2ab5d8(0x2e5),_0x5a88d1[_0x2ab5d8(0x1d0)](_0x34b28b),_0x5a88d1['appendChild'](_0x386b3b),_0x596386[_0x2ab5d8(0x1d0)](_0x5a88d1),document[_0x2ab5d8(0x1b4)][_0x2ab5d8(0x1d0)](_0x596386),window['oldConsoleLog']=console[_0x2ab5d8(0x326)],window[_0x2ab5d8(0x311)]=console['warn'],window[_0x2ab5d8(0x304)]=console[_0x2ab5d8(0x2d9)],console['log']=function(){const _0xd06208=_0x2ab5d8;oldConsoleLog[_0xd06208(0x333)](console,arguments);const _0x4003d4=document[_0xd06208(0x161)](_0xd06208(0x2d4));_0x4003d4[_0xd06208(0x2f0)]='LOG:\x20'+Array[_0xd06208(0x1f2)](arguments)[_0xd06208(0x255)]('\x20'),_0x4003d4[_0xd06208(0x21b)][_0xd06208(0x19f)]=_0xd06208(0x231),_0x4003d4['style']['marginBottom']='2px';if(_0x4003d4['textContent'][_0xd06208(0x228)]('{')||_0x4003d4[_0xd06208(0x2f0)][_0xd06208(0x228)]('['))try{const _0x323127=JSON[_0xd06208(0x33c)](_0x4003d4[_0xd06208(0x2f0)][_0xd06208(0x20a)](0x4));_0x4003d4[_0xd06208(0x2f0)]=_0xd06208(0x305)+JSON[_0xd06208(0x2b8)](_0x323127,null,0x2);}catch(_0x23dbb3){}document['getElementById'](_0xd06208(0x2e5))[_0xd06208(0x1d0)](_0x4003d4),document[_0xd06208(0x321)](_0xd06208(0x17c))[_0xd06208(0x2f5)]=document[_0xd06208(0x321)](_0xd06208(0x17c))[_0xd06208(0x327)];},console[_0x2ab5d8(0x15d)]=function(){const _0x578cf9=_0x2ab5d8;oldConsoleWarn['apply'](console,arguments);const _0x38c7f9=document[_0x578cf9(0x161)]('div');_0x38c7f9[_0x578cf9(0x2f0)]=_0x578cf9(0x1a7)+Array[_0x578cf9(0x1f2)](arguments)[_0x578cf9(0x255)]('\x20'),_0x38c7f9[_0x578cf9(0x21b)][_0x578cf9(0x19f)]=_0x578cf9(0x29c),_0x38c7f9['style'][_0x578cf9(0x1d5)]=_0x578cf9(0x184),document[_0x578cf9(0x321)](_0x578cf9(0x2e5))['appendChild'](_0x38c7f9),document[_0x578cf9(0x321)]('debug-info')['scrollTop']=document['getElementById'](_0x578cf9(0x17c))[_0x578cf9(0x327)];},console['error']=function(){const _0x13c716=_0x2ab5d8;oldConsoleError[_0x13c716(0x333)](console,arguments);const _0x49aef2=document['createElement'](_0x13c716(0x2d4));_0x49aef2[_0x13c716(0x2f0)]='ERROR:\x20'+Array[_0x13c716(0x1f2)](arguments)[_0x13c716(0x255)]('\x20'),_0x49aef2[_0x13c716(0x21b)]['color']='#ff4444',_0x49aef2[_0x13c716(0x21b)][_0x13c716(0x1d5)]=_0x13c716(0x184),document[_0x13c716(0x321)](_0x13c716(0x2e5))['appendChild'](_0x49aef2),document['getElementById']('debug-info')[_0x13c716(0x2f5)]=document[_0x13c716(0x321)](_0x13c716(0x17c))[_0x13c716(0x327)];},console['log'](_0x2ab5d8(0x240));}function handleShowExpressionRectChange(){const _0x359459=_0x46983b;if(!currentAnim||!currentFrame||currentFrameIndex<0x0){this[_0x359459(0x158)]=![],alert(_0x359459(0x27b));return;}this[_0x359459(0x158)]?(!currentAnim[_0x359459(0x25e)][currentFrameIndex][_0x359459(0x21e)]&&(currentAnim['aframeList'][currentFrameIndex]['expressionRect']={'x':0x0,'y':0x0,'width':0x32,'height':0x3c}),isEditingExpressionRect=!![],selectedModuleIndex=-0x1,selectedModuleIndices=[]):isEditingExpressionRect=![],renderCanvas();}function handleHorizontalMirrorChange(){const _0x349969=_0x46983b;globalHorizontalMirrorFlag=this[_0x349969(0x158)]?0x1:0x0,console[_0x349969(0x326)](_0x349969(0x1f1),globalHorizontalMirrorFlag),renderCanvas();}function updateExpressionCheckboxState(){const _0x3040ea=_0x46983b,_0x4950cd=document[_0x3040ea(0x321)](_0x3040ea(0x277));if(_0x4950cd&&currentFrameIndex>=0x0)_0x4950cd[_0x3040ea(0x158)]=isEditingExpressionRect;else _0x4950cd&&(_0x4950cd[_0x3040ea(0x158)]=![]);}const originalSelectFrame=selectFrame;selectFrame=function(_0x244b62){const _0x2f8f34=_0x46983b;originalSelectFrame(_0x244b62),currentAnim&&currentFrameIndex>=0x0&&currentAnim['aframeList'][currentFrameIndex]&&(!currentAnim[_0x2f8f34(0x25e)][currentFrameIndex][_0x2f8f34(0x21e)]&&(currentAnim[_0x2f8f34(0x25e)][currentFrameIndex][_0x2f8f34(0x21e)]={'x':0x0,'y':0x0,'width':0x32,'height':0x3c}));},document[_0x46983b(0x316)](_0x46983b(0x306),function(){const _0x4f93a7=_0x46983b,_0x229153=document[_0x4f93a7(0x321)](_0x4f93a7(0x15f)),_0x7c79ee=document['getElementById'](_0x4f93a7(0x211)),_0x135a6f=document[_0x4f93a7(0x321)](_0x4f93a7(0x324)),_0x5186da=document[_0x4f93a7(0x321)](_0x4f93a7(0x2d5));_0x229153&&_0x7c79ee&&_0x135a6f&&_0x5186da&&(_0x229153[_0x4f93a7(0x316)](_0x4f93a7(0x295),function(){const _0x4d148b=_0x4f93a7;_0x229153[_0x4d148b(0x27c)][_0x4d148b(0x2b6)](_0x4d148b(0x23d)),_0x7c79ee['classList'][_0x4d148b(0x2b1)](_0x4d148b(0x23d)),_0x135a6f['style'][_0x4d148b(0x2a7)]=_0x4d148b(0x226),_0x5186da[_0x4d148b(0x21b)][_0x4d148b(0x2a7)]=_0x4d148b(0x243),isMultiDragging&&(isMultiDragging=![]),dragStartModuleStates[_0x4d148b(0x31f)]>0x0&&(dragStartModuleStates=[]);}),_0x7c79ee['addEventListener'](_0x4f93a7(0x295),function(){const _0x53051a=_0x4f93a7;_0x7c79ee[_0x53051a(0x27c)]['add'](_0x53051a(0x23d)),_0x229153[_0x53051a(0x27c)]['remove']('active'),_0x135a6f[_0x53051a(0x21b)]['display']=_0x53051a(0x243),_0x5186da[_0x53051a(0x21b)][_0x53051a(0x2a7)]=_0x53051a(0x226),initExpressionList(),initExpressionGroupButtons();}));});let currentSelectedExpression=null,currentExpressionGroup=_0x46983b(0x2da);function initExpressionGroupButtons(){const _0x4c2dfc=_0x46983b,_0x5e2179=document['querySelectorAll']('#expression-group-buttons\x20.tab-button');_0x5e2179[_0x4c2dfc(0x294)](_0x437f75=>{const _0x596d70=_0x4c2dfc;_0x437f75[_0x596d70(0x316)](_0x596d70(0x295),function(){const _0x4bd141=_0x596d70;_0x5e2179[_0x4bd141(0x294)](_0x32dd6e=>_0x32dd6e[_0x4bd141(0x27c)][_0x4bd141(0x2b1)](_0x4bd141(0x23d))),this['classList'][_0x4bd141(0x2b6)]('active'),currentExpressionGroup=this[_0x4bd141(0x32a)][_0x4bd141(0x25a)],initExpressionList();});});}function initExpressionList(){const _0x5ae4bb=_0x46983b,_0x3e27c0=document[_0x5ae4bb(0x321)]('expression-list-container');if(!_0x3e27c0)return;_0x3e27c0[_0x5ae4bb(0x196)]='';if(!expressions||expressions[_0x5ae4bb(0x31f)]===0x0){console[_0x5ae4bb(0x326)](_0x5ae4bb(0x2c7),window[_0x5ae4bb(0x32f)],expressions);return;}const _0x28393b=document['createElement']('div');_0x28393b['className']=_0x5ae4bb(0x2a0);let _0x39419b=[];switch(currentExpressionGroup){case _0x5ae4bb(0x2da):_0x39419b=expressions;break;case _0x5ae4bb(0x332):_0x39419b=expressions[_0x5ae4bb(0x187)](_0x553e92=>_0x553e92[_0x5ae4bb(0x2a2)]===0x0);break;case _0x5ae4bb(0x287):_0x39419b=expressions[_0x5ae4bb(0x187)](_0x3fe7cb=>_0x3fe7cb[_0x5ae4bb(0x2a2)]===0x1);break;case _0x5ae4bb(0x1c4):_0x39419b=expressions[_0x5ae4bb(0x187)](_0x149b6c=>_0x149b6c[_0x5ae4bb(0x2a2)]===0x2);break;}if(_0x39419b[_0x5ae4bb(0x31f)]===0x0){const _0x34c586=document['createElement']('div');_0x34c586[_0x5ae4bb(0x21b)][_0x5ae4bb(0x21f)]=_0x5ae4bb(0x28e),_0x34c586[_0x5ae4bb(0x21b)]['padding']=_0x5ae4bb(0x30d),_0x34c586['style']['color']='#666',_0x34c586['textContent']=_0x5ae4bb(0x185),_0x28393b[_0x5ae4bb(0x1d0)](_0x34c586);}else _0x39419b[_0x5ae4bb(0x294)](_0xe308ee=>{const _0x8ed2e5=_0x5ae4bb,_0x5ece38=document[_0x8ed2e5(0x161)](_0x8ed2e5(0x2d4));_0x5ece38[_0x8ed2e5(0x1c9)]=_0x8ed2e5(0x190)+(currentSelectedExpression===_0xe308ee[_0x8ed2e5(0x1db)]?_0x8ed2e5(0x2b7):''),_0x5ece38[_0x8ed2e5(0x32a)][_0x8ed2e5(0x33b)]=_0xe308ee[_0x8ed2e5(0x1db)];const _0x6eb3=document[_0x8ed2e5(0x161)](_0x8ed2e5(0x1ab));_0x6eb3[_0x8ed2e5(0x1c9)]=_0x8ed2e5(0x335),_0x6eb3[_0x8ed2e5(0x273)]=_0xe308ee[_0x8ed2e5(0x2e8)][0x0],_0x6eb3[_0x8ed2e5(0x24a)]=_0xe308ee[_0x8ed2e5(0x1db)],_0x6eb3[_0x8ed2e5(0x18b)]=function(){const _0x4cd099=_0x8ed2e5;this['style']['display']=_0x4cd099(0x243);const _0x693a7d=document['createElement'](_0x4cd099(0x2d4));_0x693a7d[_0x4cd099(0x21b)]['width']='60px',_0x693a7d['style']['height']='60px',_0x693a7d[_0x4cd099(0x21b)][_0x4cd099(0x2a1)]=_0x4cd099(0x328),_0x693a7d[_0x4cd099(0x21b)][_0x4cd099(0x25c)]=_0x4cd099(0x1d6),_0x693a7d[_0x4cd099(0x21b)][_0x4cd099(0x1b9)]=_0x4cd099(0x266),_0x693a7d['style'][_0x4cd099(0x2a7)]='flex',_0x693a7d[_0x4cd099(0x21b)][_0x4cd099(0x297)]=_0x4cd099(0x28e),_0x693a7d[_0x4cd099(0x21b)][_0x4cd099(0x1be)]='center',_0x693a7d['textContent']=_0xe308ee[_0x4cd099(0x1db)],this[_0x4cd099(0x1aa)][_0x4cd099(0x1d0)](_0x693a7d);};const _0x577633=document[_0x8ed2e5(0x161)](_0x8ed2e5(0x2d4));_0x577633['textContent']=_0xe308ee['name'],_0x577633['style']['fontSize']=_0x8ed2e5(0x1f6),_0x5ece38['appendChild'](_0x6eb3),_0x5ece38['appendChild'](_0x577633),_0x5ece38[_0x8ed2e5(0x316)](_0x8ed2e5(0x295),function(){const _0x560497=_0x8ed2e5;document[_0x560497(0x26d)](_0x560497(0x26b))[_0x560497(0x294)](_0x35ad78=>{const _0x5db365=_0x560497;_0x35ad78[_0x5db365(0x27c)][_0x5db365(0x2b1)](_0x5db365(0x2b7));}),this[_0x560497(0x27c)][_0x560497(0x2b6)](_0x560497(0x2b7)),currentSelectedExpression=_0xe308ee[_0x560497(0x1db)],console['log']('已选择表情:\x20'+_0xe308ee[_0x560497(0x1db)]),renderCanvas(0x14);}),_0x28393b['appendChild'](_0x5ece38);});_0x3e27c0[_0x5ae4bb(0x1d0)](_0x28393b);}function drawFrameExpression(){const _0x4ac20a=_0x46983b;if(!currentAnim||!currentFrameIndex||currentFrameIndex<0x0||!currentAnim[_0x4ac20a(0x25e)][currentFrameIndex])return;const _0x2f4f70=currentAnim[_0x4ac20a(0x25e)][currentFrameIndex],_0x4f2707=_0x2f4f70[_0x4ac20a(0x21e)];if(!_0x4f2707||!_0x4f2707['x']||!_0x4f2707['y']||!_0x4f2707['width']||!_0x4f2707[_0x4ac20a(0x22f)])return;if(!currentSelectedExpression||!expressions)return;const _0x1d875d=expressions[_0x4ac20a(0x200)](_0x4398ae=>_0x4398ae[_0x4ac20a(0x1db)]===currentSelectedExpression);if(!_0x1d875d||!_0x1d875d[_0x4ac20a(0x2e8)]||_0x1d875d[_0x4ac20a(0x2e8)][_0x4ac20a(0x31f)]===0x0){ctx[_0x4ac20a(0x234)]='#4CAF50',ctx[_0x4ac20a(0x166)](_0x4f2707['x'],_0x4f2707['y'],_0x4f2707[_0x4ac20a(0x2d1)],_0x4f2707[_0x4ac20a(0x22f)]),ctx[_0x4ac20a(0x234)]=_0x4ac20a(0x320),ctx[_0x4ac20a(0x248)]=_0x4ac20a(0x1bb),ctx[_0x4ac20a(0x21f)]='center',ctx[_0x4ac20a(0x230)]=_0x4ac20a(0x2a8),ctx[_0x4ac20a(0x2c1)](currentSelectedExpression,_0x4f2707['x']+_0x4f2707[_0x4ac20a(0x2d1)]/0x2,_0x4f2707['y']+_0x4f2707['height']/0x2);return;}const _0x2a385d=new Image();_0x2a385d[_0x4ac20a(0x273)]=_0x1d875d[_0x4ac20a(0x2e8)][0x0],_0x2a385d[_0x4ac20a(0x172)]=function(){const _0x2e2d51=_0x4ac20a,_0x4599eb=document[_0x2e2d51(0x161)]('canvas'),_0x54f945=_0x4599eb[_0x2e2d51(0x1b3)]('2d');_0x4599eb[_0x2e2d51(0x2d1)]=_0x4f2707[_0x2e2d51(0x2d1)],_0x4599eb['height']=_0x4f2707[_0x2e2d51(0x22f)],_0x54f945['drawImage'](_0x2a385d,0x0,0x0,_0x4f2707[_0x2e2d51(0x2d1)],_0x4f2707[_0x2e2d51(0x22f)]),ctx[_0x2e2d51(0x1ff)](_0x4599eb,_0x4f2707['x'],_0x4f2707['y']);},_0x2a385d[_0x4ac20a(0x18b)]=function(){const _0x15ec88=_0x4ac20a;ctx[_0x15ec88(0x234)]='#4CAF50',ctx[_0x15ec88(0x166)](_0x4f2707['x'],_0x4f2707['y'],_0x4f2707[_0x15ec88(0x2d1)],_0x4f2707[_0x15ec88(0x22f)]),ctx[_0x15ec88(0x234)]=_0x15ec88(0x320),ctx['font']=_0x15ec88(0x1bb),ctx[_0x15ec88(0x21f)]='center',ctx[_0x15ec88(0x230)]='middle',ctx[_0x15ec88(0x2c1)](currentSelectedExpression,_0x4f2707['x']+_0x4f2707[_0x15ec88(0x2d1)]/0x2,_0x4f2707['y']+_0x4f2707[_0x15ec88(0x22f)]/0x2);};}function init(){const _0x360507=_0x46983b;imageManager=new LWImageManager(),updateImageOriginPos();const _0x5c06d7=loadProject();switchTab('animation'),renderSpriteList(),renderAnimList(),renderTimeline(),renderImagesList(),resizeCanvas(),bindEvents();!imagePreviewCanvas&&(imagePreviewCanvas=document[_0x360507(0x321)](_0x360507(0x212)),imagePreviewCtx=imagePreviewCanvas[_0x360507(0x1b3)]('2d'));!originalPreviewCanvas&&(originalPreviewCanvas=document['getElementById'](_0x360507(0x23c)),originalPreviewCtx=originalPreviewCanvas['getContext']('2d'));!flipHorizontalPreviewCanvas&&(flipHorizontalPreviewCanvas=document[_0x360507(0x321)]('flip-horizontal-preview'),flipHorizontalPreviewCtx=flipHorizontalPreviewCanvas[_0x360507(0x1b3)]('2d'));!flipVerticalPreviewCanvas&&(flipVerticalPreviewCanvas=document[_0x360507(0x321)]('flip-vertical-preview'),flipVerticalPreviewCtx=flipVerticalPreviewCanvas[_0x360507(0x1b3)]('2d'));!flipBothPreviewCanvas&&(flipBothPreviewCanvas=document[_0x360507(0x321)](_0x360507(0x1e2)),flipBothPreviewCtx=flipBothPreviewCanvas[_0x360507(0x1b3)]('2d'));const _0x1a688d=document['createElement'](_0x360507(0x197));_0x1a688d[_0x360507(0x2f0)]=_0x360507(0x270),_0x1a688d[_0x360507(0x21b)][_0x360507(0x238)]=_0x360507(0x313),_0x1a688d['style'][_0x360507(0x2a7)]='none',_0x1a688d['addEventListener'](_0x360507(0x295),function(){const _0xe4e421=_0x360507;showDebugInfo(),debugCanvasState(),currentImage&&imagePreviewCanvas&&(console['log'](_0xe4e421(0x30e)),renderImagePreview());}),document[_0x360507(0x1b4)]['appendChild'](_0x1a688d);const _0x62f429=document[_0x360507(0x321)](_0x360507(0x283));_0x62f429&&_0x62f429['addEventListener'](_0x360507(0x15a),function(){const _0x31646d=_0x360507,_0x16e5ad=this[_0x31646d(0x2f6)];console[_0x31646d(0x326)](_0x31646d(0x19d),_0x16e5ad);if(_0x16e5ad&&currentSprite){console[_0x31646d(0x326)]('Current\x20sprite\x20exists,\x20getting\x20image\x20with\x20id:',_0x16e5ad);for(let _0x1898af of currentSprite[_0x31646d(0x233)]){console[_0x31646d(0x326)](_0x31646d(0x1ac),_0x1898af['id'],_0x1898af[_0x31646d(0x1db)]);}const _0x3195d3=currentSprite[_0x31646d(0x274)](_0x16e5ad);if(_0x3195d3){console[_0x31646d(0x326)](_0x31646d(0x173),_0x3195d3[_0x31646d(0x1db)]),previewImageId=_0x16e5ad,previewImage=_0x3195d3[_0x31646d(0x2ac)],console[_0x31646d(0x326)]('Set\x20currentImage\x20and\x20previewImageId:',previewImageId);!imagePreviewCanvas&&(imagePreviewCanvas=document[_0x31646d(0x321)](_0x31646d(0x212)),imagePreviewCanvas&&(imagePreviewCtx=imagePreviewCanvas[_0x31646d(0x1b3)]('2d')));if(imagePreviewCanvas&&previewImage){}console['log'](_0x31646d(0x342)),renderImagePreview(0x1);}else console[_0x31646d(0x15d)](_0x31646d(0x302),_0x16e5ad);}else console['warn'](_0x31646d(0x219));});document[_0x360507(0x321)](_0x360507(0x2dd))['addEventListener']('click',function(){const _0x445078=_0x360507;previewZoomLevel=Math[_0x445078(0x32d)](previewZoomLevel+0.1,0x5),renderImagePreview();}),document['getElementById']('zoom-out-btn')[_0x360507(0x316)](_0x360507(0x295),function(){previewZoomLevel=Math['max'](previewZoomLevel-0.1,0.1),renderImagePreview();}),document[_0x360507(0x321)]('reset-zoom-btn')[_0x360507(0x316)](_0x360507(0x295),function(){previewZoomLevel=0x1,renderImagePreview();});const _0x2fa8a2=document[_0x360507(0x26d)](_0x360507(0x1dc));_0x2fa8a2[_0x360507(0x294)](_0x2cd590=>{_0x2cd590['addEventListener']('click',function(){const _0x2a34e7=_0x2b13;selectedTransformation=this[_0x2a34e7(0x32a)][_0x2a34e7(0x2a2)],showPreviewWithMouse=!![],_0x2fa8a2[_0x2a34e7(0x294)](_0x3d3341=>_0x3d3341[_0x2a34e7(0x21b)][_0x2a34e7(0x2ad)]=_0x2a34e7(0x243)),this[_0x2a34e7(0x21b)]['border']=_0x2a34e7(0x2e7);});}),imagePreviewCanvas&&(imagePreviewCanvas['addEventListener']('click',handlePreviewCanvasClick),imagePreviewCanvas['addEventListener']('mousemove',updateMousePosition)),loadExpression();}function bindEvents(){const _0x3fd9c6=_0x46983b;document[_0x3fd9c6(0x321)](_0x3fd9c6(0x329))[_0x3fd9c6(0x316)](_0x3fd9c6(0x295),showNewSpriteModal),document['getElementById'](_0x3fd9c6(0x24c))[_0x3fd9c6(0x316)](_0x3fd9c6(0x295),createSprite),document['getElementById'](_0x3fd9c6(0x189))[_0x3fd9c6(0x316)](_0x3fd9c6(0x295),hideNewSpriteModal),document[_0x3fd9c6(0x321)](_0x3fd9c6(0x227))['addEventListener']('click',showNewAnimModal),document['getElementById']('create-anim')[_0x3fd9c6(0x316)](_0x3fd9c6(0x295),createAnim),document[_0x3fd9c6(0x321)](_0x3fd9c6(0x315))[_0x3fd9c6(0x316)](_0x3fd9c6(0x295),hideNewAnimModal),document[_0x3fd9c6(0x321)]('upload-image')[_0x3fd9c6(0x316)](_0x3fd9c6(0x295),showUploadImageModal),document[_0x3fd9c6(0x321)](_0x3fd9c6(0x23a))[_0x3fd9c6(0x316)](_0x3fd9c6(0x295),uploadImage),document['getElementById'](_0x3fd9c6(0x181))[_0x3fd9c6(0x316)](_0x3fd9c6(0x295),hideUploadImageModal),document['getElementById'](_0x3fd9c6(0x245))[_0x3fd9c6(0x316)](_0x3fd9c6(0x295),addFrame),document[_0x3fd9c6(0x321)](_0x3fd9c6(0x236))[_0x3fd9c6(0x316)]('click',addFrameToEnd),document[_0x3fd9c6(0x321)]('clone-frame')[_0x3fd9c6(0x316)](_0x3fd9c6(0x295),cloneFrame),document['getElementById']('delete-frame')[_0x3fd9c6(0x316)]('click',deleteFrame),document[_0x3fd9c6(0x321)](_0x3fd9c6(0x2fc))[_0x3fd9c6(0x316)](_0x3fd9c6(0x295),deleteFrameModule),document['getElementById'](_0x3fd9c6(0x28d))['addEventListener'](_0x3fd9c6(0x295),copyModule),document['getElementById'](_0x3fd9c6(0x2cf))[_0x3fd9c6(0x316)]('click',pasteModule),document[_0x3fd9c6(0x321)](_0x3fd9c6(0x2e0))[_0x3fd9c6(0x316)]('click',undoAction),document[_0x3fd9c6(0x321)]('redo')[_0x3fd9c6(0x316)](_0x3fd9c6(0x295),redoAction),document['addEventListener']('keydown',function(_0x10d0f8){const _0x10a25b=_0x3fd9c6,_0x146597=_0x10d0f8[_0x10a25b(0x192)]||_0x10d0f8['metaKey'];if(_0x146597&&!_0x10d0f8[_0x10a25b(0x1a1)]&&!_0x10d0f8[_0x10a25b(0x163)]){if(_0x10d0f8['key']==='c'||_0x10d0f8[_0x10a25b(0x204)]==='C')_0x10d0f8[_0x10a25b(0x1d7)](),copyModule();else{if(_0x10d0f8[_0x10a25b(0x204)]==='v'||_0x10d0f8[_0x10a25b(0x204)]==='V')_0x10d0f8['preventDefault'](),pasteModule();else{if(_0x10d0f8['key']==='d'||_0x10d0f8[_0x10a25b(0x204)]==='D')_0x10d0f8[_0x10a25b(0x1d7)](),deleteFrameModule();else{if(_0x10d0f8['key']==='z'||_0x10d0f8[_0x10a25b(0x204)]==='Z')_0x10d0f8[_0x10a25b(0x1d7)](),undoAction();else(_0x10d0f8['key']==='y'||_0x10d0f8[_0x10a25b(0x204)]==='Y')&&(_0x10d0f8['preventDefault'](),redoAction());}}}}}),document[_0x3fd9c6(0x321)]('flip-horizontal')['addEventListener'](_0x3fd9c6(0x295),flipHorizontal),document[_0x3fd9c6(0x321)]('flip-vertical')['addEventListener'](_0x3fd9c6(0x295),flipVertical),document[_0x3fd9c6(0x321)]('move-module-up')[_0x3fd9c6(0x316)](_0x3fd9c6(0x295),moveModuleUp),document[_0x3fd9c6(0x321)]('move-module-down')[_0x3fd9c6(0x316)](_0x3fd9c6(0x295),moveModuleDown),document[_0x3fd9c6(0x321)]('rotate')[_0x3fd9c6(0x316)](_0x3fd9c6(0x295),rotateModule),document['getElementById'](_0x3fd9c6(0x199))[_0x3fd9c6(0x316)](_0x3fd9c6(0x295),togglePlayAnimation),document[_0x3fd9c6(0x321)](_0x3fd9c6(0x26f))['addEventListener']('input',changeAnimationSpeed),document[_0x3fd9c6(0x321)](_0x3fd9c6(0x208))[_0x3fd9c6(0x316)](_0x3fd9c6(0x295),function(){const _0x529780=_0x3fd9c6;showGrid=!showGrid,this[_0x529780(0x2f0)]=showGrid?_0x529780(0x28a):_0x529780(0x2ba),renderCanvas(0x2);}),document[_0x3fd9c6(0x321)](_0x3fd9c6(0x275))[_0x3fd9c6(0x316)]('click',showUploadImageModal),document[_0x3fd9c6(0x321)]('confirm-upload')[_0x3fd9c6(0x316)](_0x3fd9c6(0x295),uploadImage),document[_0x3fd9c6(0x321)](_0x3fd9c6(0x181))[_0x3fd9c6(0x316)](_0x3fd9c6(0x295),hideUploadImageModal),document[_0x3fd9c6(0x321)](_0x3fd9c6(0x1d2))['addEventListener'](_0x3fd9c6(0x295),toggleCropping),document['getElementById'](_0x3fd9c6(0x22d))[_0x3fd9c6(0x316)](_0x3fd9c6(0x295),toggleEditModule),document[_0x3fd9c6(0x321)](_0x3fd9c6(0x221))[_0x3fd9c6(0x316)](_0x3fd9c6(0x295),saveModule),document['getElementById']('save-project')[_0x3fd9c6(0x316)](_0x3fd9c6(0x295),saveProject),document[_0x3fd9c6(0x321)](_0x3fd9c6(0x2f7))[_0x3fd9c6(0x316)]('click',newProject),canvas[_0x3fd9c6(0x316)]('mousedown',handleFrameMouseDown),canvas[_0x3fd9c6(0x316)](_0x3fd9c6(0x317),handleFrameMouseMove),canvas[_0x3fd9c6(0x316)](_0x3fd9c6(0x29b),handleFrameMouseUp),canvas[_0x3fd9c6(0x316)](_0x3fd9c6(0x267),handleFrameMouseUp),canvas[_0x3fd9c6(0x316)](_0x3fd9c6(0x15b),handleMouseWheel),canvas[_0x3fd9c6(0x316)](_0x3fd9c6(0x317),handleFrameMouseHover),document[_0x3fd9c6(0x321)](_0x3fd9c6(0x2ec))[_0x3fd9c6(0x316)](_0x3fd9c6(0x295),handleZoomIn),document[_0x3fd9c6(0x321)](_0x3fd9c6(0x26e))['addEventListener'](_0x3fd9c6(0x295),handleZoomOut),document[_0x3fd9c6(0x321)](_0x3fd9c6(0x1eb))['addEventListener'](_0x3fd9c6(0x295),handleZoomReset),document[_0x3fd9c6(0x316)]('keydown',handleKeyDown),document[_0x3fd9c6(0x316)](_0x3fd9c6(0x162),handleKeyUp),imageCanvas['addEventListener']('dblclick',handleImageMouseDblClick),imageCanvas[_0x3fd9c6(0x316)](_0x3fd9c6(0x244),handleImageMouseDown),imageCanvas[_0x3fd9c6(0x316)](_0x3fd9c6(0x317),handleImageMouseMove),document['addEventListener']('mouseup',handleImageMouseUp),document[_0x3fd9c6(0x321)](_0x3fd9c6(0x334))[_0x3fd9c6(0x316)]('change',function(){const _0x404b2=_0x3fd9c6;isShowExpression=this[_0x404b2(0x158)],renderCanvas();}),document['getElementById'](_0x3fd9c6(0x277))[_0x3fd9c6(0x316)](_0x3fd9c6(0x15a),handleShowExpressionRectChange),document[_0x3fd9c6(0x321)](_0x3fd9c6(0x28c))[_0x3fd9c6(0x316)](_0x3fd9c6(0x15a),handleHorizontalMirrorChange),document[_0x3fd9c6(0x321)](_0x3fd9c6(0x2af))['addEventListener'](_0x3fd9c6(0x15a),drawCurrentImage),window['addEventListener'](_0x3fd9c6(0x241),resizeCanvas),document[_0x3fd9c6(0x321)](_0x3fd9c6(0x28b))[_0x3fd9c6(0x316)](_0x3fd9c6(0x295),handleZoomIn),document[_0x3fd9c6(0x321)](_0x3fd9c6(0x18c))[_0x3fd9c6(0x316)](_0x3fd9c6(0x295),handleZoomOut),document['getElementById'](_0x3fd9c6(0x2e1))[_0x3fd9c6(0x316)]('click',handleZoomReset),imageCanvas[_0x3fd9c6(0x316)](_0x3fd9c6(0x15b),handleMouseWheel),imageCanvas[_0x3fd9c6(0x316)](_0x3fd9c6(0x317),showImageMousePosition),canvas[_0x3fd9c6(0x316)](_0x3fd9c6(0x317),showMousePosition),canvas[_0x3fd9c6(0x316)](_0x3fd9c6(0x295),function(_0x308822){showPreviewWithMouse&&selectedImageModule!==-0x1&&currentFrame&&addModuleToFrame(_0x308822);}),canvas[_0x3fd9c6(0x316)](_0x3fd9c6(0x317),function(_0x718ef2){const _0x569570=_0x3fd9c6;showPreviewWithMouse&&selectedImageModule!==-0x1&&(mouseXOnCanvas=_0x718ef2[_0x569570(0x2f3)],mouseYOnCanvas=_0x718ef2[_0x569570(0x2aa)],renderCanvas());}),canvas[_0x3fd9c6(0x316)](_0x3fd9c6(0x267),function(){showPreviewWithMouse&&(showPreviewWithMouse=![],renderCanvas());});}